(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/app/dist/index.cjs.js":[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _a,_a$1,tslib=require("tslib"),util=require("@firebase/util"),component=require("@firebase/component"),logger$1=require("@firebase/logger"),ERRORS=((_a={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",_a["bad-app-name"]="Illegal App name: '{$appName}",_a["duplicate-app"]="Firebase App named '{$appName}' already exists",_a["app-deleted"]="Firebase App named '{$appName}' already deleted",_a["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",_a),ERROR_FACTORY=new util.ErrorFactory("app","Firebase",ERRORS),name="@firebase/app",version="0.5.2",name$1="@firebase/analytics",name$2="@firebase/auth",name$3="@firebase/database",name$4="@firebase/functions",name$5="@firebase/installations",name$6="@firebase/messaging",name$7="@firebase/performance",name$8="@firebase/remote-config",name$9="@firebase/storage",name$a="@firebase/firestore",name$b="firebase-wrapper",DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING=((_a$1={})[name]="fire-core",_a$1[name$1]="fire-analytics",_a$1[name$2]="fire-auth",_a$1[name$3]="fire-rtdb",_a$1[name$4]="fire-fn",_a$1[name$5]="fire-iid",_a$1[name$6]="fire-fcm",_a$1[name$7]="fire-perf",_a$1[name$8]="fire-rc",_a$1[name$9]="fire-gcs",_a$1[name$a]="fire-fst",_a$1["fire-js"]="fire-js",_a$1[name$b]="fire-js-all",_a$1),logger=new logger$1.Logger("@firebase/app"),FirebaseAppImpl=function(){function e(e,r,n){var t,i,a=this;this.firebase_=n,this.isDeleted_=!1,this.name_=r.name,this.automaticDataCollectionEnabled_=r.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(e),this.container=new component.ComponentContainer(r.name),this._addComponent(new component.Component("app",function(){return a},"PUBLIC"));try{for(var o=tslib.__values(this.firebase_.INTERNAL.components.values()),s=o.next();!s.done;s=o.next()){var p=s.value;this._addComponent(p)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(r){e.checkDestroyed_(),r()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,r){return void 0===r&&(r=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:r})},e.prototype._removeServiceInstance=function(e,r){void 0===r&&(r=DEFAULT_ENTRY_NAME),this.container.getProvider(e).clearInstance(r)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(r){logger.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,r)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ERROR_FACTORY.create("app-deleted",{appName:this.name_})},e}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log("dc");var version$1="7.7.0";function createFirebaseNamespaceCore(e){var r={},n=new Map,t={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){var a=i;i={name:a}}var o=i;void 0===o.name&&(o.name=DEFAULT_ENTRY_NAME);var s=o.name;if("string"!=typeof s||!s)throw ERROR_FACTORY.create("bad-app-name",{appName:String(s)});if(util.contains(r,s))throw ERROR_FACTORY.create("duplicate-app",{appName:s});var p=new e(n,o,t);return r[s]=p,p},app:i,registerVersion:function(e,r,n){var t,i=null!==(t=PLATFORM_LOG_STRING[e])&&void 0!==t?t:e;n&&(i+="-"+n);var o=i.match(/\s|\//),s=r.match(/\s|\//);if(o||s){var p=['Unable to register library "'+i+'" with version "'+r+'":'];return o&&p.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&p.push("and"),s&&p.push('version name "'+r+'" contains illegal characters (whitespace or "/")'),void logger.warn(p.join(" "))}a(new component.Component(i+"-version",function(){return{library:i,version:r}},"VERSION"))},apps:null,SDK_VERSION:version$1,INTERNAL:{registerComponent:a,removeApp:function(e){delete r[e]},components:n,useAsService:function(e,r){if("serverAuth"===r)return null;return r}}};function i(e){if(e=e||DEFAULT_ENTRY_NAME,!util.contains(r,e))throw ERROR_FACTORY.create("no-app",{appName:e});return r[e]}function a(a){var o,s,p=a.name;if(n.has(p))return logger.debug("There were multiple attempts to register component "+p+"."),"PUBLIC"===a.type?t[p]:null;if(n.set(p,a),"PUBLIC"===a.type){var l=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[p])throw ERROR_FACTORY.create("invalid-app-argument",{appName:p});return e[p]()};void 0!==a.serviceProps&&util.deepExtend(l,a.serviceProps),t[p]=l,e.prototype[p]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._getService.bind(this,p).apply(this,a.multipleInstances?e:[])}}try{for(var c=tslib.__values(Object.keys(r)),u=c.next();!u.done;u=c.next()){var f=u.value;r[f]._addComponent(a)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}return"PUBLIC"===a.type?t[p]:null}return t.default=t,Object.defineProperty(t,"apps",{get:function(){return Object.keys(r).map(function(e){return r[e]})}}),i.App=e,t}function createFirebaseNamespace(){var e=createFirebaseNamespaceCore(FirebaseAppImpl);return e.INTERNAL=tslib.__assign(tslib.__assign({},e.INTERNAL),{createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function(r){util.deepExtend(e,r)},createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,deepExtend:util.deepExtend}),e}var firebase=createFirebaseNamespace(),PlatformLoggerService=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(isVersionServiceProvider(e)){var r=e.getImmediate();return r.library+"/"+r.version}return null}).filter(function(e){return e}).join(" ")},e}();function isVersionServiceProvider(e){var r;return"VERSION"===(null===(r=e.getComponent())||void 0===r?void 0:r.type)}function registerCoreComponents(e,r){e.INTERNAL.registerComponent(new component.Component("platform-logger",function(e){return new PlatformLoggerService(e)},"PRIVATE")),e.registerVersion(name,version,r),e.registerVersion("fire-js","")}if(util.isBrowser()&&void 0!==self.firebase){logger.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var sdkVersion=self.firebase.SDK_VERSION;sdkVersion&&sdkVersion.indexOf("LITE")>=0&&logger.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var initializeApp=firebase.initializeApp;firebase.initializeApp=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return util.isNode()&&logger.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),initializeApp.apply(void 0,e)};var firebase$1=firebase;registerCoreComponents(firebase$1),exports.default=firebase$1,exports.firebase=firebase$1;

},{"@firebase/component":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/component/dist/index.cjs.js","@firebase/logger":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/logger/dist/index.cjs.js","@firebase/util":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/util/dist/index.cjs.js","tslib":"/Users/rabbit/projects/buntimer2020-github/node_modules/tslib/tslib.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/auth/dist/auth.js":[function(require,module,exports){
(function (global){
(function(){var t,e=require("@firebase/app").default,n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,e){if(e){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(e=e(o=r[t=t[t.length-1]]))!=o&&null!=e&&n(r,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=i.setTimeout;n.prototype.c=function(t){a(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(t){o(t)}}:e}var r,o,a=new e(function(t,e){r=t,o=e});return this.La(i(t,r),i(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.La=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=o(t),a=i.next();!a.done;a=i.next())r(a.value).La(e,n)})},e.all=function(t){var n=o(t),i=n.next();return i.done?r([]):new e(function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).La(o(a.length-1),e),i=n.next()}while(!i.done)})},e});var a=a||{},s=this||self;function u(t){return"string"==typeof t}function c(t){return"boolean"==typeof t}var h=/^[\w+/_-]+[=]{0,2}$/,l=null;function f(){}function d(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){return null===t}function v(t){return"array"==d(t)}function m(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function g(t){return"function"==d(t)}function b(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var y="closure_uid_"+(1e9*Math.random()>>>0),w=0;function I(t,e,n){return t.call.apply(t.bind,arguments)}function T(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?I:T).apply(null,arguments)}function k(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var A=Date.now||function(){return+new Date};function S(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.gd=function(t,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return e.prototype[n].apply(t,r)}}function N(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function O(t){if(Error.captureStackTrace)Error.captureStackTrace(this,O);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function _(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");O.call(this,n+t[i])}function P(t,e){throw new _("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function R(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function C(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function D(){this.b=this.a=null}S(O,Error),O.prototype.name="CustomError",S(_,O),_.prototype.name="AssertionError",R.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new R(function(){return new M},function(t){t.reset()});function x(){var t=Ht,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function M(){this.next=this.b=this.a=null}function j(t,e){t:{try{var n=t&&t.ownerDocument,i=n&&(n.defaultView||n.parentWindow);if((i=i||s).Element&&i.Location){var r=i;break t}}catch(t){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(b(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;P("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}D.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},M.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},M.prototype.reset=function(){this.next=this.b=this.a=null};var U=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(u(t))return u(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},V=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=u(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};var F=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r=u(t)?t.split(""):t,o=0;o<n;o++)o in r&&(i[o]=e.call(void 0,r[o],o,t));return i},K=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=u(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function q(t,e){return 0<=U(t,e)}function H(t,e){var n;return(n=0<=(e=U(t,e)))&&Array.prototype.splice.call(t,e,1),n}function B(t,e){!function(t,e){for(var n=u(t)?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0})}function G(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function X(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function J(t){for(var e in t)return!1;return!0}function Y(t){var e,n={};for(e in t)n[e]=t[e];return n}var z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<z.length;o++)n=z[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Z(t,e){this.a=t===et&&e||"",this.b=tt}function Q(t){return t instanceof Z&&t.constructor===Z&&t.b===tt?t.a:(P("expected object of type Const, got '"+t+"'"),"type_error:Const")}Z.prototype.qa=!0,Z.prototype.pa=function(){return this.a},Z.prototype.toString=function(){return"Const{"+this.a+"}"};var tt={},et={},nt=new Z(et,"");function it(){this.a="",this.b=ut}function rt(t){return t instanceof it&&t.constructor===it&&t.b===ut?t.a:(P("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function ot(t,e){var n=Q(t);if(!st.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return ct(t=n.replace(at,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error('Found marker, "'+i+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[i])instanceof Z?Q(t):encodeURIComponent(String(t))}))}it.prototype.qa=!0,it.prototype.pa=function(){return this.a.toString()},it.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var at=/%{(\w+)}/g,st=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ut={};function ct(t){var e=new it;return e.a=t,e}var ht=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},lt=/&/g,ft=/</g,dt=/>/g,pt=/"/g,vt=/'/g,mt=/\x00/g,gt=/[\x00&<>"']/;function bt(t,e){return-1!=t.indexOf(e)}function yt(t,e){return t<e?-1:t>e?1:0}function wt(){this.a="",this.b=At}function It(t){return t instanceof wt&&t.constructor===wt&&t.b===At?t.a:(P("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}wt.prototype.qa=!0,wt.prototype.pa=function(){return this.a.toString()},wt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Tt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Et(t){return t instanceof wt?t:(t="object"==typeof t&&t.qa?t.pa():String(t),Tt.test(t)||(t="about:invalid#zClosurez"),St(t))}var kt,At={};function St(t){var e=new wt;return e.a=t,e}St("about:blank");t:{var Nt=s.navigator;if(Nt){var Ot=Nt.userAgent;if(Ot){kt=Ot;break t}}kt=""}function _t(t){return bt(kt,t)}function Pt(){this.a="",this.b=Ct}function Rt(t){return t instanceof Pt&&t.constructor===Pt&&t.b===Ct?t.a:(P("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}Pt.prototype.qa=!0,Pt.prototype.pa=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ct={};function Dt(t){var e=new Pt;return e.a=t,e}Dt("<!DOCTYPE html>");var Lt,xt,Mt=Dt("");function jt(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function Ut(t){return gt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(lt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(ft,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(dt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(pt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(vt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(mt,"&#0;"))),t}function Vt(t){s.setTimeout(function(){throw t},0)}function Ft(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!_t("Presto")&&(t=function(){var t,e,n=document.createElement("IFRAME");n.style.display="none",t=n,e=ct(Q(nt)),j(t,"HTMLIFrameElement"),t.src=rt(e).toString(),document.documentElement.appendChild(n);var i=n.contentWindow;(n=i.document).open(),n.write(Rt(Mt)),n.close();var r="callImmediate"+Math.random(),o="file:"==i.location.protocol?"*":i.location.protocol+"//"+i.location.host;n=E(function(t){"*"!=o&&t.origin!=o||t.data!=r||this.port1.onmessage()},this),i.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){i.postMessage(r,o)}}}),void 0!==t&&!_t("Trident")&&!_t("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){i.next={yb:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){s.setTimeout(t,0)}}function Kt(t,e){xt||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);xt=function(){t.then(Bt)}}else xt=function(){var t=Bt;!g(s.setImmediate)||s.Window&&s.Window.prototype&&!_t("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(Lt||(Lt=Ft()),Lt(t)):s.setImmediate(t)}}(),qt||(xt(),qt=!0),Ht.add(t,e)}Dt("<br>");var qt=!1,Ht=new D;function Bt(){for(var t;t=x();){try{t.a.call(t.b)}catch(t){Vt(t)}C(L,t)}qt=!1}function Gt(t,e){if(this.a=Wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,function(t){re(n,Xt,t)},function(t){if(!(t instanceof le))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}re(n,Jt,t)})}catch(t){re(this,Jt,t)}}var Wt=0,Xt=2,Jt=3;function Yt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Yt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var zt=new R(function(){return new Yt},function(t){t.reset()});function $t(t,e,n){var i=zt.get();return i.g=t,i.b=e,i.f=n,i}function Zt(t){if(t instanceof Gt)return t;var e=new Gt(f);return re(e,Xt,t),e}function Qt(t){return new Gt(function(e,n){n(t)})}function te(t,e,n){oe(t,e,n,null)||Kt(k(e,t))}function ee(t){return new Gt(function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Gb:!0,value:o}:{Gb:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)te(t[o],k(r,o,!0),k(r,o,!1));else e(i)})}function ne(t,e){t.b||t.a!=Xt&&t.a!=Jt||ae(t),t.f?t.f.next=e:t.b=e,t.f=e}function ie(t,e,n,i){var r=$t(null,null,null);return r.a=new Gt(function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(t){o(t)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof le?o(e):t(r)}catch(t){o(t)}}:o}),r.a.c=t,ne(t,r),r.a}function re(t,e,n){t.a==Wt&&(t===n&&(e=Jt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,oe(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,ae(t),e!=Jt||n instanceof le||function(t,e){t.g=!0,Kt(function(){t.g&&he.call(null,e)})}(t,n)))}function oe(t,e,n,i){if(t instanceof Gt)return ne(t,$t(e||f,n||null,i)),!0;if(N(t))return t.then(e,n,i),!0;if(b(t))try{var r=t.then;if(g(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(t){o(t)}}(t,r,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function ae(t){t.h||(t.h=!0,Kt(t.Zb,t))}function se(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ue(t,e,n,i){if(n==Jt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ce(e,n,i);else try{e.c?e.g.call(e.f):ce(e,n,i)}catch(t){he.call(null,t)}C(zt,e)}function ce(t,e,n){e==Xt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Gt.prototype.then=function(t,e,n){return ie(this,g(t)?t:null,g(e)?e:null,n)},Gt.prototype.$goog_Thenable=!0,(t=Gt.prototype).ka=function(t,e){return(t=$t(t,t,e)).c=!0,ne(this,t),this},t.s=function(t,e){return ie(this,null,t,e)},t.cancel=function(t){this.a==Wt&&Kt(function(){!function t(e,n){if(e.a==Wt)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==Wt&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):se(i),ue(i,o,Jt,n)))}e.c=null}else re(e,Jt,n)}(this,new le(t))},this)},t.Oc=function(t){this.a=Wt,re(this,Xt,t)},t.Pc=function(t){this.a=Wt,re(this,Jt,t)},t.Zb=function(){for(var t;t=se(this);)ue(this,t,this.a,this.i);this.h=!1};var he=Vt;function le(t){O.call(this,t)}function fe(){0!=de&&(pe[this[y]||(this[y]=++w)]=this),this.va=this.va,this.la=this.la}S(le,O),le.prototype.name="cancel";var de=0,pe={};function ve(t){if(!t.va&&(t.va=!0,t.za(),0!=de)){var e=t[y]||(t[y]=++w);if(0!=de&&t.la&&0<t.la.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pe[e]}}function me(t){return me[" "](t),t}fe.prototype.va=!1,fe.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},me[" "]=f;var ge,be,ye=_t("Opera"),we=_t("Trident")||_t("MSIE"),Ie=_t("Edge"),Te=Ie||we,Ee=_t("Gecko")&&!(bt(kt.toLowerCase(),"webkit")&&!_t("Edge"))&&!(_t("Trident")||_t("MSIE"))&&!_t("Edge"),ke=bt(kt.toLowerCase(),"webkit")&&!_t("Edge");function Ae(){var t=s.document;return t?t.documentMode:void 0}t:{var Se="",Ne=(be=kt,Ee?/rv:([^\);]+)(\)|;)/.exec(be):Ie?/Edge\/([\d\.]+)/.exec(be):we?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(be):ke?/WebKit\/(\S+)/.exec(be):ye?/(?:Version)[ \/]?(\S+)/.exec(be):void 0);if(Ne&&(Se=Ne?Ne[1]:""),we){var Oe=Ae();if(null!=Oe&&Oe>parseFloat(Se)){ge=String(Oe);break t}}ge=Se}var _e,Pe={};function Re(t){return function(t,e){var n=Pe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=ht(String(ge)).split("."),i=ht(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=yt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||yt(0==a[2].length,0==s[2].length)||yt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}_e=s.document&&we?Ae():void 0;var Ce=Object.freeze||function(t){return t},De=!we||9<=Number(_e),Le=we&&!Re("9"),xe=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",f,e),s.removeEventListener("test",f,e)}catch(t){}return t}();function Me(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function je(t,e){if(Me.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Ee){t:{try{me(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=u(t.pointerType)?t.pointerType:Ue[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Me.prototype.preventDefault=function(){this.Mb=!1},S(je,Me);var Ue=Ce({2:"touch",3:"pen",4:"mouse"});je.prototype.preventDefault=function(){je.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Le)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},je.prototype.f=function(){return this.a};var Ve="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Ke(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Pa=r,this.key=++Fe,this.ta=this.Ka=!1}function qe(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function He(t){this.src=t,this.a={},this.b=0}function Be(t,e){var n=e.type;n in t.a&&H(t.a[n],e)&&(qe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Ge(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==i)return r}return-1}He.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Ge(t,e,i,r);return-1<a?(e=t[a],n||(e.Ka=!1)):((e=new Ke(e,this.src,o,!!i,r)).Ka=n,t.push(e)),e};var We="closure_lm_"+(1e6*Math.random()|0),Xe={};function Je(t,e,n,i,r){if(i&&i.once)ze(t,e,n,i,r);else if(v(e))for(var o=0;o<e.length;o++)Je(t,e[o],n,i,r);else n=an(n),t&&t[Ve]?un(t,e,n,b(i)?!!i.capture:!!i,r):Ye(t,e,n,!1,i,r)}function Ye(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=b(r)?!!r.capture:!!r,s=rn(t);if(s||(t[We]=s=new He(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=nn,e=De?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)xe||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Qe(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function ze(t,e,n,i,r){if(v(e))for(var o=0;o<e.length;o++)ze(t,e[o],n,i,r);else n=an(n),t&&t[Ve]?cn(t,e,n,b(i)?!!i.capture:!!i,r):Ye(t,e,n,!0,i,r)}function $e(t,e,n,i,r){if(v(e))for(var o=0;o<e.length;o++)$e(t,e[o],n,i,r);else i=b(i)?!!i.capture:!!i,n=an(n),t&&t[Ve]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=Ge(o=t.a[e],n,i,r))&&(qe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=rn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ge(e,n,i,r)),(n=-1<t?e[t]:null)&&Ze(n))}function Ze(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[Ve])Be(e.u,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Qe(n),i):e.addListener&&e.removeListener&&e.removeListener(i),0,(n=rn(e))?(Be(n,t),0==n.b&&(n.src=null,e[We]=null)):qe(t)}}}function Qe(t){return t in Xe?Xe[t]:Xe[t]="on"+t}function tn(t,e,n,i){var r=!0;if((t=rn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=en(o,i),r=r&&!1!==o)}return r}function en(t,e){var n=t.listener,i=t.Pa||t.src;return t.Ka&&Ze(t),n.call(i,e)}function nn(t,e){if(t.ta)return!0;if(!De){if(!e)t:{e=["window","event"];for(var n=s,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new je(i=e,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(t){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var o=tn(i[r],t,!0,e);n=n&&o}for(r=0;r<i.length;r++)e.b=i[r],o=tn(i[r],t,!1,e),n=n&&o}return n}return en(t,new je(e,this))}function rn(t){return(t=t[We])instanceof He?t:null}var on="__closure_events_fn_"+(1e9*Math.random()>>>0);function an(t){return g(t)?t:(t[on]||(t[on]=function(e){return t.handleEvent(e)}),t[on])}function sn(){fe.call(this),this.u=new He(this),this.Sb=this,this.Xa=null}function un(t,e,n,i,r){t.u.add(String(e),n,!1,i,r)}function cn(t,e,n,i,r){t.u.add(String(e),n,!0,i,r)}function hn(t,e,n,i){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ta&&a.capture==n){var s=a.listener,u=a.Pa||a.src;a.Ka&&Be(t.u,a),r=!1!==s.call(u,i)&&r}}return r&&0!=i.Mb}function ln(t,e,n){if(g(t))n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function fn(t){var e=null;return new Gt(function(n,i){-1==(e=ln(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).s(function(t){throw s.clearTimeout(e),t})}function dn(t){if(t.U&&"function"==typeof t.U)return t.U();if(u(t))return t.split("");if(m(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function pn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(m(t)||u(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function vn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof vn)for(n=t.X(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function mn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];gn(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)gn(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function gn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(sn,fe),sn.prototype[Ve]=!0,sn.prototype.addEventListener=function(t,e,n,i){Je(this,t,e,n,i)},sn.prototype.removeEventListener=function(t,e,n,i){$e(this,t,e,n,i)},sn.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var i=t.type||t;if(u(t))t=new Me(t,n);else if(t instanceof Me)t.target=t.target||n;else{var r=t;$(t=new Me(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];r=hn(a,i,!0,t)&&r}if(r=hn(a=t.b=n,i,!0,t)&&r,r=hn(a,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=hn(a=t.b=e[o],i,!1,t)&&r;return r},sn.prototype.za=function(){if(sn.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)0,qe(n[i]);delete e.a[t],e.b--}}this.Xa=null},(t=vn.prototype).U=function(){mn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.X=function(){return mn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return gn(this.b,t)?this.b[t]:e},t.set=function(t,e){gn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.X(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var bn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function yn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof yn?(this.h=void 0!==e?e:t.h,wn(this,t.f),this.i=t.i,this.b=t.b,In(this,t.l),this.c=t.c,Tn(this,Kn(t.a)),this.g=t.g):t&&(n=String(t).match(bn))?(this.h=!!e,wn(this,n[1]||"",!0),this.i=Nn(n[2]||""),this.b=Nn(n[3]||"",!0),In(this,n[4]),this.c=Nn(n[5]||"",!0),Tn(this,n[6]||"",!0),this.g=Nn(n[7]||"")):(this.h=!!e,this.a=new xn(null,this.h))}function wn(t,e,n){t.f=n?Nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function In(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function Tn(t,e,n){e instanceof xn?(t.a=e,function(t,e){e&&!t.f&&(Mn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Un(this,e),Fn(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=On(e,Dn)),t.a=new xn(e,t.h))}function En(t,e,n){t.a.set(e,n)}function kn(t,e){return t.a.get(e)}function An(t){return t instanceof yn?new yn(t):new yn(t,void 0)}function Sn(t,e){var n=new yn(null,void 0);return wn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function Nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function On(t,e,n){return u(t)?(t=encodeURI(t).replace(e,_n),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function _n(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}yn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(On(e,Pn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(On(e,Pn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(On(n,"/"==n.charAt(0)?Cn:Rn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",On(n,Ln)),t.join("")},yn.prototype.resolve=function(t){var e=new yn(this),n=!!t.f;n?wn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var i=t.c;if(n)In(e,t.l);else if(n=!!t.c){if("/"!=i.charAt(0))if(this.b&&!this.c)i="/"+i;else{var r=e.c.lastIndexOf("/");-1!=r&&(i=e.c.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(bt(r,"./")||bt(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?e.c=i:n=""!==t.a.toString(),n?Tn(e,Kn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var Pn=/[#\/\?@]/g,Rn=/[#\?:]/g,Cn=/[#\?]/g,Dn=/[#\?@]/g,Ln=/#/g;function xn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Mn(t){t.a||(t.a=new vn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function jn(t){var e=pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new xn(null,void 0);t=dn(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];v(o)?Fn(n,r,o):n.add(r,o)}return n}function Un(t,e){Mn(t),e=qn(t,e),gn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,gn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&mn(t)))}function Vn(t,e){return Mn(t),e=qn(t,e),gn(t.a.b,e)}function Fn(t,e,n){Un(t,e),0<n.length&&(t.c=null,t.a.set(qn(t,e),W(n)),t.b+=n.length)}function Kn(t){var e=new xn;return e.c=t.c,t.a&&(e.a=new vn(t.a),e.b=t.b),e}function qn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=xn.prototype).add=function(t,e){Mn(this),this.c=null,t=qn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Mn(this),this.a.forEach(function(n,i){V(n,function(n){t.call(e,n,i,this)},this)},this)},t.X=function(){Mn(this);for(var t=this.a.U(),e=this.a.X(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.U=function(t){Mn(this);var e=[];if(u(t))Vn(this,t)&&(e=G(e,this.a.get(qn(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},t.set=function(t,e){return Mn(this),this.c=null,Vn(this,t=qn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.U(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.U(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var Hn=!we||9<=Number(_e);function Bn(t){var e=document;return u(t)?e.getElementById(t):t}function Gn(t,e){X(e,function(e,n){e&&"object"==typeof e&&e.qa&&(e=e.pa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Wn.hasOwnProperty(n)?t.setAttribute(Wn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var Wn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Xn(t,e,n){var i=arguments,r=document,o=String(i[0]),a=i[1];if(!Hn&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ut(a.name),'"'),a.type){o.push(' type="',Ut(a.type),'"');var s={};$(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=r.createElement(o),a&&(u(a)?o.className=a:v(a)?o.className=a.join(" "):Gn(o,a)),2<i.length&&function(t,e,n){function i(n){n&&e.appendChild(u(n)?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var o=n[r];!m(o)||b(o)&&0<o.nodeType?i(o):V(Jn(o)?W(o):o,i)}}(r,o,i),o}function Jn(t){if(t&&"number"==typeof t.length){if(b(t))return"function"==typeof t.item||"string"==typeof t.item;if(g(t))return"function"==typeof t.item}return!1}function Yn(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(v(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&("function"!=typeof(a=n[r])&&(i.push(o),Qn(r,i),i.push(":"),t(e,a,i),o=","));return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":Qn(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new zn,t,e),e.join("")}function zn(){}var $n={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Zn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Qn(t,e){e.push('"',t.replace(Zn,function(t){var e=$n[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),$n[t]=e),e}),'"')}function ti(){var t=yi();return we&&!!_e&&11==_e||/Edge\/\d+/.test(t)}function ei(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function ni(t,e){e=e||s.window;var n="about:blank";t&&(n=It(Et(t)).toString()),e.location.href=n}function ii(t){return!!((t=(t||yi()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ri(t){t=t||s.window;try{t.close()}catch(t){}}function oi(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=yi().toLowerCase(),i&&(e.target=i,bt(n,"crios/")&&(e.target="_blank")),mi(yi())==pi&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof wt?n:Et(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0))}var a=r.join(",");if((_t("iPhone")&&!_t("iPod")&&!_t("iPad")||_t("iPad")||_t("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(j(a=i.document.createElement("A"),"HTMLAnchorElement"),e instanceof wt||e instanceof wt||(e="object"==typeof e&&e.qa?e.pa():String(e),Tt.test(e)||(e="about:invalid#zClosurez"),e=St(e)),a.href=It(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=i.open("",n,a),t=It(e).toString(),a&&(Te&&bt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Dt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ut(t)+'">'),a.document.write(Rt(t)),a.document.close())):(a=i.open(It(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var ai=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,si=/^[^@]+@[^@]+$/;function ui(){var t=null;return new Gt(function(e){"complete"==s.document.readyState?e():(t=function(){e()},ze(window,"load",t))}).s(function(e){throw $e(window,"load",t),e})}function ci(t){return t=t||yi(),!("file:"!==ki()&&"ionic:"!==ki()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function hi(){var t=s.window;try{return!(!t||t==t.top)}catch(t){return!1}}function li(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function fi(){return e.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":e.INTERNAL.hasOwnProperty("node")?"Node":li()?"Worker":"Browser"}function di(){var t=fi();return"ReactNative"===t||"Node"===t}var pi="Firefox",vi="Chrome";function mi(t){var e=t.toLowerCase();return bt(e,"opera/")||bt(e,"opr/")||bt(e,"opios/")?"Opera":bt(e,"iemobile")?"IEMobile":bt(e,"msie")||bt(e,"trident/")?"IE":bt(e,"edge/")?"Edge":bt(e,"firefox/")?pi:bt(e,"silk/")?"Silk":bt(e,"blackberry")?"Blackberry":bt(e,"webos")?"Webos":!bt(e,"safari/")||bt(e,"chrome/")||bt(e,"crios/")||bt(e,"android")?!bt(e,"chrome/")&&!bt(e,"crios/")||bt(e,"edge/")?bt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":vi:"Safari"}var gi={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function bi(t,e){e=e||[];var n,i=[],r={};for(n in gi)r[gi[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=fi())?i=mi(r=yi()):"Worker"===i&&(i=mi(r=yi())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function yi(){return s.navigator&&s.navigator.userAgent||""}function wi(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Ii(){try{var t=s.localStorage,e=_i();if(t)return t.setItem(e,"1"),t.removeItem(e),!ti()||!!s.indexedDB}catch(t){return li()&&!!s.indexedDB}return!1}function Ti(){return(Ei()||"chrome-extension:"===ki()||ci())&&!di()&&Ii()&&!li()}function Ei(){return"http:"===ki()||"https:"===ki()}function ki(){return s.location&&s.location.protocol||null}function Ai(t){return!ii(t=t||yi())&&mi(t)!=pi}function Si(t){return void 0===t?null:Yn(t)}function Ni(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Oi(t){if(null!==t)return JSON.parse(t)}function _i(t){return t||Math.floor(1e9*Math.random()).toString()}function Pi(t){return"Safari"!=mi(t=t||yi())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ri(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ci(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=yi(),e=fi(),this.b=ii(t)||"ReactNative"===e}function Di(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Li(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function xi(){return!(!wi("fireauth.oauthhelper",s)&&!wi("fireauth.iframe",s))}Ci.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Ei()&&"chrome-extension:"!==ki()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Mi,ji={};function Ui(t){ji[t]||(ji[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Vi={};Object.defineProperty(Vi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Vi,"abcd",{configurable:!0,enumerable:!0,value:2}),Mi=2==Vi.abcd}catch(be){Mi=!1}function Fi(t,e,n){Mi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ki(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Fi(t,n,e[n])}function qi(t){var e={};return Ki(e,t),e}function Hi(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Fi(e,n,Hi(t[n]));return e}function Bi(t){var e={},n=t[Wi],i=t[Xi];if(!(t=t[Ji])||t!=Gi&&!n)throw Error("Invalid provider user info!");e[zi]=i||null,e[Yi]=n||null,Fi(this,Zi,t),Fi(this,$i,Hi(e))}var Gi="EMAIL_SIGNIN",Wi="email",Xi="newEmail",Ji="requestType",Yi="email",zi="fromEmail",$i="data",Zi="operation";function Qi(t,e){this.code=er+t,this.message=e||nr[t]||""}function tr(t){var e=t&&t.code;return e?new Qi(e.substring(er.length),t.message):null}S(Qi,Error),Qi.prototype.A=function(){return{code:this.code,message:this.message}},Qi.prototype.toJSON=function(){return this.A()};var er="auth/",nr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function ir(t){var e=kn(t=An(t),rr)||null,n=kn(t,or)||null,i=kn(t,ur)||null;if(i=i&&hr[i]||null,!e||!n||!i)throw new Qi("argument-error",rr+", "+or+"and "+ur+" are required in a valid action code URL.");Ki(this,{apiKey:e,operation:i,code:n,continueUrl:kn(t,ar)||null,languageCode:kn(t,sr)||null,tenantId:kn(t,cr)||null})}var rr="apiKey",or="oobCode",ar="continueUrl",sr="languageCode",ur="mode",cr="tenantId",hr={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:Gi,verifyEmail:"VERIFY_EMAIL"};function lr(t){try{return new ir(t)}catch(t){return null}}function fr(t){var e=t[gr];if(void 0===e)throw new Qi("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Qi("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[dr];if(n&&"object"==typeof n){e=n[wr];var i=n[br];if(n=n[yr],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new Qi("argument-error",br+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Qi("argument-error",yr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Qi("argument-error",wr+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new Qi("missing-android-pkg-name")}}else if(void 0!==n)throw new Qi("argument-error",dr+" property must be a non null object when specified.");if(this.f=null,(e=t[mr])&&"object"==typeof e){if("string"==typeof(e=e[Ir])&&e.length)this.f=e;else if(void 0!==e)throw new Qi("argument-error",Ir+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Qi("argument-error",mr+" property must be a non null object when specified.");if(void 0!==(e=t[vr])&&"boolean"!=typeof e)throw new Qi("argument-error",vr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[pr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Qi("argument-error",pr+" property must be a non empty string when specified.");this.i=t||null}var dr="android",pr="dynamicLinkDomain",vr="handleCodeInApp",mr="iOS",gr="url",br="installApp",yr="minimumVersion",wr="packageName",Ir="bundleId";function Tr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Er=null,kr=null;function Ar(t){var e="";return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=kr[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Er){Er={},kr={};for(var t=0;65>t;t++)Er[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),kr[Er[t]]=t,62<=t&&(kr["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function Sr(t){this.f=t.sub,A(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Nr(t){return(t=Or(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Sr(t):null}function Or(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Ar(t))}catch(t){}return null}Sr.prototype.R=function(){return this.c},Sr.prototype.g=function(){return this.b};var _r,Pr={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Rr(t){for(var e in Pr)if(Pr[e].id===t)return{firebaseEndpoint:(t=Pr[e]).cb,secureTokenEndpoint:t.ib};return null}_r=Rr("__EID__")?"__EID__":void 0;var Cr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Dr=["client_id","response_type","scope","redirect_uri","state"],Lr={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:Dr},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:Dr},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:Dr},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Cr},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function xr(t){for(var e in Lr)if(Lr[e].Fa==t)return Lr[e];return null}function Mr(t){var e={};e["facebook.com"]=Kr,e["google.com"]=Hr,e["github.com"]=qr,e["twitter.com"]=Br;var n=t&&t[Ur];try{if(n)return e[n]?new e[n](t):new Fr(t);if(void 0!==t[jr])return new Vr(t)}catch(t){}return null}var jr="idToken",Ur="providerId";function Vr(t){var e=t[Ur];if(!e&&t[jr]){var n=Nr(t[jr]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Fi(this,"providerId",e),Fi(this,"isNewUser",n)}function Fr(t){Vr.call(this,t),Fi(this,"profile",Hi((t=Oi(t.rawUserInfo||"{}"))||{}))}function Kr(t){if(Fr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function qr(t){if(Fr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Fi(this,"username",this.profile&&this.profile.login||null)}function Hr(t){if(Fr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Br(t){if(Fr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Fi(this,"username",t.screenName||null)}function Gr(t){var e=An(t),n=kn(e,"link"),i=kn(An(n),"link");return e=kn(e,"deep_link_id"),kn(An(e),"link")||e||i||n||t}function Wr(){}function Xr(t,e){return t.then(function(t){if(t[xa]){var n=Nr(t[xa]);if(!n||e!=n.f)throw new Qi("user-mismatch");return t}throw new Qi("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==er+"user-not-found"?new Qi("user-mismatch"):t})}function Jr(t,e){if(!e)throw new Qi("internal-error","failed to construct a credential");this.a=e,Fi(this,"providerId",t),Fi(this,"signInMethod",t)}function Yr(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function zr(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Jr(t.providerId,t.pendingToken)}catch(t){}return null}function $r(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Fi(this,"idToken",e.idToken),e.accessToken&&Fi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Fi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Qi("internal-error","failed to construct a credential");Fi(this,"accessToken",e.oauthToken),Fi(this,"secret",e.oauthTokenSecret)}Fi(this,"providerId",t),Fi(this,"signInMethod",n)}function Zr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:jn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Qr(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new $r(t.providerId,e,t.signInMethod)}catch(t){}}return null}function to(t,e){this.Fc=e||[],Ki(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(xr(t)||{}).Ea||null,this.bb=null}function eo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Qi("argument-error",'SAML provider IDs must be prefixed with "saml."');to.call(this,t,[])}function no(t){to.call(this,t,Dr),this.a=[]}function io(){no.call(this,"facebook.com")}function ro(t){if(!t)throw new Qi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new io).credential({accessToken:e})}function oo(){no.call(this,"github.com")}function ao(t){if(!t)throw new Qi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return b(t)&&(e=t.accessToken),(new oo).credential({accessToken:e})}function so(){no.call(this,"google.com"),this.ya("profile")}function uo(t,e){var n=t;return b(t)&&(n=t.idToken,e=t.accessToken),(new so).credential({idToken:n,accessToken:e})}function co(){to.call(this,"twitter.com",Cr)}function ho(t,e){var n=t;if(b(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Qi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new $r("twitter.com",n,"twitter.com")}function lo(t,e,n){this.a=t,this.c=e,Fi(this,"providerId","password"),Fi(this,"signInMethod",n===po.EMAIL_LINK_SIGN_IN_METHOD?po.EMAIL_LINK_SIGN_IN_METHOD:po.EMAIL_PASSWORD_SIGN_IN_METHOD)}function fo(t){return t&&t.email&&t.password?new lo(t.email,t.password,t.signInMethod):null}function po(){Ki(this,{providerId:"password",isOAuthProvider:!1})}function vo(t,e){if(!(e=mo(e)))throw new Qi("argument-error","Invalid email link!");return new lo(t,e.code,po.EMAIL_LINK_SIGN_IN_METHOD)}function mo(t){return(t=lr(t=Gr(t)))&&t.operation===Gi?t:null}function go(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new Qi("internal-error");this.a=t,Fi(this,"providerId","phone"),Fi(this,"signInMethod","phone")}function bo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return V(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new go(e)}return null}function yo(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function wo(t){try{this.a=t||e.auth()}catch(t){throw new Qi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ki(this,{providerId:"phone",isOAuthProvider:!1})}function Io(t,e){if(!t)throw new Qi("missing-verification-id");if(!e)throw new Qi("missing-verification-code");return new go({Va:t,Ua:e})}function To(t){if(t.temporaryProof&&t.phoneNumber)return new go({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return uo(o,n);case"facebook.com":return ro(n);case"github.com":return ao(n);case"twitter.com":return ho(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new Jr(e,a):new $r(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new no(e).credential({idToken:o,accessToken:n,rawNonce:r}):null}}catch(t){return null}}function Eo(t){if(!t.isOAuthProvider)throw new Qi("invalid-oauth-provider")}function ko(t,e,n,i,r,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=o||null,this.h=a||null,this.a=r||null,!this.g&&!this.a)throw new Qi("invalid-auth-event");if(this.g&&this.a)throw new Qi("invalid-auth-event");if(this.g&&!this.f)throw new Qi("invalid-auth-event")}function Ao(t){return(t=t||{}).type?new ko(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&tr(t.error),t.postBody,t.tenantId):null}function So(){this.b=null,this.a=[]}S(Fr,Vr),S(Kr,Fr),S(qr,Fr),S(Hr,Fr),S(Br,Fr),Jr.prototype.na=function(t){return Qa(t,Yr(this))},Jr.prototype.b=function(t,e){var n=Yr(this);return n.idToken=e,ts(t,n)},Jr.prototype.f=function(t,e){return Xr(es(t,Yr(this)),e)},Jr.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},$r.prototype.na=function(t){return Qa(t,Zr(this))},$r.prototype.b=function(t,e){var n=Zr(this);return n.idToken=e,ts(t,n)},$r.prototype.f=function(t,e){return Xr(es(t,Zr(this)),e)},$r.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},to.prototype.Ga=function(t){return this.zb=Y(t),this},S(eo,to),S(no,to),no.prototype.ya=function(t){return q(this.a,t)||this.a.push(t),this},no.prototype.Hb=function(){return W(this.a)},no.prototype.credential=function(t,e){var n;if(!(n=b(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Qi("argument-error","credential failed: must provide the ID token and/or the access token.");return new $r(this.providerId,n,this.providerId)},S(io,no),Fi(io,"PROVIDER_ID","facebook.com"),Fi(io,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(oo,no),Fi(oo,"PROVIDER_ID","github.com"),Fi(oo,"GITHUB_SIGN_IN_METHOD","github.com"),S(so,no),Fi(so,"PROVIDER_ID","google.com"),Fi(so,"GOOGLE_SIGN_IN_METHOD","google.com"),S(co,to),Fi(co,"PROVIDER_ID","twitter.com"),Fi(co,"TWITTER_SIGN_IN_METHOD","twitter.com"),lo.prototype.na=function(t){return this.signInMethod==po.EMAIL_LINK_SIGN_IN_METHOD?Ps(t,cs,{email:this.a,oobCode:this.c}):Ps(t,Ss,{email:this.a,password:this.c})},lo.prototype.b=function(t,e){return this.signInMethod==po.EMAIL_LINK_SIGN_IN_METHOD?Ps(t,hs,{idToken:e,email:this.a,oobCode:this.c}):Ps(t,ws,{idToken:e,email:this.a,password:this.c})},lo.prototype.f=function(t,e){return Xr(this.na(t),e)},lo.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Ki(po,{PROVIDER_ID:"password"}),Ki(po,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ki(po,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),go.prototype.na=function(t){return t.Wa(yo(this))},go.prototype.b=function(t,e){var n=yo(this);return n.idToken=e,Ps(t,Os,n)},go.prototype.f=function(t,e){var n=yo(this);return n.operation="REAUTH",Xr(t=Ps(t,_s,n),e)},go.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},wo.prototype.Wa=function(t,e){var n=this.a.b;return Zt(e.verify()).then(function(i){if(!u(i))throw new Qi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return Ps(t,bs,e)}(n,{phoneNumber:t,recaptchaToken:i}).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Qi("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Ki(wo,{PROVIDER_ID:"phone"}),Ki(wo,{PHONE_SIGN_IN_METHOD:"phone"}),ko.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},ko.prototype.R=function(){return this.h},ko.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var No,Oo=null;function _o(t){var e="unauthorized-domain",n=void 0,i=An(t);t=i.b,"chrome-extension"==(i=i.f)?n=jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Qi.call(this,e,n)}function Po(t,e,n){Qi.call(this,t,n),(t=e||{}).Ab&&Fi(this,"email",t.Ab),t.ba&&Fi(this,"phoneNumber",t.ba),t.credential&&Fi(this,"credential",t.credential),t.Qb&&Fi(this,"tenantId",t.Qb)}function Ro(t){if(t.code){var e=t.code||"";0==e.indexOf(er)&&(e=e.substring(er.length));var n={credential:To(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new Qi(e,t.message||void 0);return new Po(e,n,t.message)}return null}function Co(){}function Do(t){return t.c||(t.c=t.b())}function Lo(){}function xo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Mo(){}function jo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=E(this.fc,this),this.a.onerror=E(this.Ib,this),this.a.onprogress=E(this.gc,this),this.a.ontimeout=E(this.kc,this)}function Uo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Vo(t,e,n){this.reset(t,e,n,void 0,void 0)}S(_o,Qi),S(Po,Qi),Po.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&$(t,e),t},Po.prototype.toJSON=function(){return this.A()},Co.prototype.c=null,S(Lo,Co),Lo.prototype.a=function(){var t=xo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Lo.prototype.b=function(){var t={};return xo(this)&&(t[0]=!0,t[1]=!0),t},No=new Lo,S(Mo,Co),Mo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new jo;throw Error("Unsupported browser")},Mo.prototype.b=function(){return{}},(t=jo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Uo(this,4)},t.Ib=function(){this.status=500,this.response=this.responseText="",Uo(this,4)},t.kc=function(){this.Ib()},t.gc=function(){this.status=200,Uo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Vo.prototype.a=null;function Fo(t){this.f=t,this.b=this.c=this.a=null}function Ko(t,e){this.name=t,this.value=e}Vo.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||A(),delete this.a},Ko.prototype.toString=function(){return this.name};var qo=new Ko("SEVERE",1e3),Ho=new Ko("WARNING",900),Bo=new Ko("CONFIG",700),Go=new Ko("FINE",500);Fo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(P("Root logger has no level set."),null)}(this).value)for(g(e)&&(e=e()),t=new Vo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Wo={},Xo=null;function Jo(t){var e;if(Xo||(Xo=new Fo(""),Wo[""]=Xo,Xo.c=Bo),!(e=Wo[t])){e=new Fo(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=Jo(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,Wo[t]=e}return e}function Yo(t,e){t&&t.log(Go,e,void 0)}function zo(t){this.f=t}function $o(t){sn.call(this),this.o=t,this.readyState=Zo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Jo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}S(zo,Co),zo.prototype.a=function(){return new $o(this.f)},zo.prototype.b=function(t){return function(){return t}}({}),S($o,sn);var Zo=0;function Qo(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function ta(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,ea(t)}function ea(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function na(t){sn.call(this),this.headers=new vn,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=ia,this.v=this.P=!1}(t=$o.prototype).open=function(t,e){if(this.readyState!=Zo)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,ea(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ta(this,!1)),this.readyState=Zo},t.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,ea(this)),this.a&&(this.readyState=3,ea(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,Qo(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},t.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ta(this,!0):ea(this),3==this.readyState&&Qo(this)}},t.ic=function(t){this.a&&(this.response=this.responseText=t,ta(this,!0))},t.hc=function(t){this.a&&(this.response=t,ta(this,!0))},t.Oa=function(t){var e=this.h;e&&e.log(Ho,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&ta(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Ho,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Ho,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},S(na,sn);var ia="";na.prototype.b=Jo("goog.net.XhrIo");var ra=/^https?$/i,oa=["POST","PUT"];function aa(t,e,n,i,r){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.O=n,t.I=!1,t.c=!0,t.a=t.B?t.B.a():No.a(),t.w=t.B?Do(t.B):Do(No),t.a.onreadystatechange=E(t.Lb,t);try{Yo(t.b,va(t,"Opening Xhr")),t.J=!0,t.a.open(n,String(e),!0),t.J=!1}catch(e){return Yo(t.b,va(t,"Error opening Xhr: "+e.message)),void ua(t,e)}e=i||"";var o=new vn(t.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(m(t)||u(t))V(t,e,void 0);else for(var n=pn(t),i=dn(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=sa,n=t.length,i=u(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:u(t)?t.charAt(e):t[e]}(o.X()),i=s.FormData&&e instanceof s.FormData,!q(oa,n)||r||i||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.P&&(t.a.withCredentials=t.P);try{fa(t),0<t.g&&(t.v=function(t){return we&&Re(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Yo(t.b,va(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=E(t.Ia,t)):t.o=ln(t.Ia,t.g,t)),Yo(t.b,va(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Yo(t.b,va(t,"Send error: "+e.message)),ua(t,e)}}function sa(t){return"content-type"==t.toLowerCase()}function ua(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ca(t),la(t)}function ca(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ha(t){if(t.c&&void 0!==a)if(t.w[1]&&4==da(t)&&2==pa(t))Yo(t.b,va(t,"Local request error detected and ignored"));else if(t.i&&4==da(t))ln(t.Lb,0,t);else if(t.dispatchEvent("readystatechange"),4==da(t)){Yo(t.b,va(t,"Request complete")),t.c=!1;try{var e,n=pa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.l).match(bn)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}r=!ra.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<da(t)?t.a.statusText:""}catch(e){Yo(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+pa(t)+"]",ca(t)}}finally{la(t)}}}function la(t,e){if(t.a){fa(t);var n=t.a,i=t.w[0]?f:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(e){(t=t.b)&&t.log(qo,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function fa(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(s.clearTimeout(t.o),t.o=null)}function da(t){return t.a?t.a.readyState:0}function pa(t){try{return 2<da(t)?t.a.status:-1}catch(t){return-1}}function va(t,e){return e+" ["+t.O+" "+t.l+" "+pa(t)+"]"}function ma(t){var e=Na;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ga(t,e,n){t.a=!0,t.c=n,t.f=!e,Ia(t)}function ba(t){if(t.a){if(!t.u)throw new Ta(t);t.u=!1}}function ya(t,e,n,i){t.g.push([e,n,i]),t.a&&Ia(t)}function wa(t){return K(t.g,function(t){return g(t[1])})}function Ia(t){if(t.h&&t.a&&wa(t)){var e=t.h,n=Aa[e];n&&(s.clearTimeout(n.a),delete Aa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=n=!1;t.g.length&&!t.i;){var r=t.g.shift(),o=r[0],a=r[1];if(r=r[2],o=t.f?a:o)try{var u=o.call(r||t.o,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(N(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(i=!0,t.i=!0)}catch(i){e=i,t.f=!0,wa(t)||(n=!0)}}t.c=e,i&&(u=E(t.m,t,!0),i=E(t.m,t,!1),e instanceof ma?(ya(e,u,i),e.w=!0):e.then(u,i)),n&&(e=new ka(e),Aa[e.a]=e,t.h=e.a)}function Ta(){O.call(this)}function Ea(){O.call(this)}function ka(t){this.a=s.setTimeout(E(this.c,this),0),this.b=t}(t=na.prototype).Ia=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Yo(this.b,va(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Yo(this.b,va(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),la(this))},t.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),la(this,!0)),na.qb.za.call(this)},t.Lb=function(){this.va||(this.J||this.i||this.f?ha(this):this.yc())},t.yc=function(){ha(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(qo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return Yo(this.b,"Can not get response: "+t.message),null}},ma.prototype.cancel=function(t){if(this.a)this.c instanceof ma&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new Ea(this),ba(this),ga(this,!1,t))}},ma.prototype.m=function(t,e){this.i=!1,ga(this,t,e)},ma.prototype.then=function(t,e,n){var i,r,o=new Gt(function(t,e){i=t,r=e});return ya(this,i,function(t){t instanceof Ea?o.cancel():r(t)}),o.then(t,e,n)},ma.prototype.$goog_Thenable=!0,S(Ta,O),Ta.prototype.message="Deferred has already fired",Ta.prototype.name="AlreadyCalledError",S(Ea,O),Ea.prototype.message="Deferred was canceled",Ea.prototype.name="CanceledError",ka.prototype.c=function(){throw delete Aa[this.a],this.b};var Aa={};function Sa(t){var e={},n=e.document||document,i=rt(t).toString(),r=document.createElement("SCRIPT"),o={Nb:r,Ia:void 0},a=new ma(o),u=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(u=window.setTimeout(function(){Oa(r,!0);var t=new Ra(Pa,"Timeout reached for loading script "+i);ba(a),ga(a,!1,t)},c),o.Ia=u),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Oa(r,e.hd||!1,u),ba(a),ga(a,!0,null))},r.onerror=function(){Oa(r,!0,u);var t=new Ra(_a,"Error while loading script "+i);ba(a),ga(a,!1,t)},$(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Gn(r,o),function(t,e){j(t,"HTMLScriptElement"),t.src=rt(e),null===l&&(l=(e=(e=s.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&h.test(e)?e:""),(e=l)&&t.setAttribute("nonce",e)}(r,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),a}function Na(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&Oa(t,!0,this.Ia)}}function Oa(t,e,n){null!=n&&s.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var _a=0,Pa=1;function Ra(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),O.call(this,n),this.code=t}function Ca(t){this.f=t}function Da(t,n,i){if(this.c=t,t=n||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||Ma,this.g=Y(t.secureTokenHeaders||ja),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||Ua,this.a=Y(t.firebaseHeaders||Va),i&&(this.a["X-Client-Version"]=i,this.g["X-Client-Version"]=i),i="Node"==fi(),!(i=s.XMLHttpRequest||i&&e.INTERNAL.node&&e.INTERNAL.node.XMLHttpRequest)&&!li())throw new Qi("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,li()?this.f=new zo(self):di()?this.f=new Ca(i):this.f=new Mo,this.b=null}S(Ra,O),S(Ca,Co),Ca.prototype.a=function(){return new this.f},Ca.prototype.b=function(){return{}};var La,xa="idToken",Ma=new Ci(3e4,6e4),ja={"Content-Type":"application/x-www-form-urlencoded"},Ua=new Ci(3e4,6e4),Va={"Content-Type":"application/json"};function Fa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ka(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function qa(t,e,n,i,r,o,a){(function(){var t=yi();return!((t=mi(t)!=vi?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||we&&_e&&!(9<_e))})()||li()?t=E(t.o,t):(La||(La=new Gt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{s[Ba]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=ot(Ha,{onload:Ba});!function(t,e){ya(t,null,e,void 0)}(Sa(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=E(t.m,t)),t(e,n,i,r,o,a)}Da.prototype.R=function(){return this.b},Da.prototype.o=function(t,e,n,i,r,o){if(li()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new Qi("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new na(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout(function(){a.dispatchEvent("timeout")},o)}un(a,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Yo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),cn(a,"ready",function(){u&&clearTimeout(u),ve(this)}),cn(a,"timeout",function(){u&&clearTimeout(u),ve(this),e&&e(null)}),aa(a,t,n,i,r)};var Ha=new Z(et,"https://apis.google.com/js/client.js?onload=%{onload}"),Ba="__fcb"+Math.floor(1e6*Math.random()).toString();function Ga(t){if(!u(t=t.email)||!si.test(t))throw new Qi("invalid-email")}function Wa(t){"email"in t&&Ga(t)}function Xa(t){if(!t[xa])throw new Qi("internal-error")}function Ja(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Qi("internal-error")}else{if(!t.sessionInfo)throw new Qi("missing-verification-id");if(!t.code)throw new Qi("missing-verification-code")}}Da.prototype.m=function(t,e,n,i,r){var o=this;La.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Da.prototype.ob=function(){return Ps(this,Is,{})},Da.prototype.rb=function(t,e){return Ps(this,ys,{idToken:t,email:e})},Da.prototype.sb=function(t,e){return Ps(this,ws,{idToken:t,password:e})};var Ya={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function za(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Qi("internal-error")}function $a(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Vn(t=new xn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Za(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Ro(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Ro(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Ro(t)):t.errorMessage&&(e=Rs(t.errorMessage)),e)throw e;if(!t[xa])throw new Qi("internal-error")}function Qa(t,e){return e.returnIdpCredential=!0,Ps(t,Ts,e)}function ts(t,e){return e.returnIdpCredential=!0,Ps(t,ks,e)}function es(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ps(t,Es,e)}function ns(t){if(!t.oobCode)throw new Qi("invalid-action-code")}(t=Da.prototype).tb=function(t,e){var n={idToken:t},i=[];return X(Ya,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),Ps(this,ys,n)},t.kb=function(t,e){return $(t={requestType:"PASSWORD_RESET",email:t},e),Ps(this,ps,t)},t.lb=function(t,e){return $(t={requestType:"EMAIL_SIGNIN",email:t},e),Ps(this,fs,t)},t.jb=function(t,e){return $(t={requestType:"VERIFY_EMAIL",idToken:t},e),Ps(this,ds,t)},t.Wa=function(t){return Ps(this,Ns,t)},t.ab=function(t,e){return Ps(this,gs,{oobCode:t,newPassword:e})},t.Ma=function(t){return Ps(this,rs,{oobCode:t})},t.Ya=function(t){return Ps(this,is,{oobCode:t})};var is={endpoint:"setAccountInfo",D:ns,fa:"email",F:!0},rs={endpoint:"resetPassword",D:ns,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Qi("internal-error")},F:!0},os={endpoint:"signupNewUser",D:function(t){if(Ga(t),!t.password)throw new Qi("weak-password")},K:Xa,T:!0,F:!0},as={endpoint:"createAuthUri",F:!0},ss={endpoint:"deleteAccount",V:["idToken"]},us={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!v(t.deleteProvider))throw new Qi("internal-error")}},cs={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Ga,K:Xa,T:!0,F:!0},hs={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Ga,K:Xa,T:!0},ls={endpoint:"getAccountInfo"},fs={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Qi("internal-error");Ga(t)},fa:"email",F:!0},ds={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Qi("internal-error")},fa:"email",F:!0},ps={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Qi("internal-error");Ga(t)},fa:"email",F:!0},vs={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},ms={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new Qi("internal-error")}},gs={endpoint:"resetPassword",D:ns,fa:"email",F:!0},bs={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},ys={endpoint:"setAccountInfo",V:["idToken"],D:Wa,T:!0},ws={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(Wa(t),!t.password)throw new Qi("weak-password")},K:Xa,T:!0},Is={endpoint:"signupNewUser",K:Xa,T:!0,F:!0},Ts={endpoint:"verifyAssertion",D:za,Ra:$a,K:Za,T:!0,F:!0},Es={endpoint:"verifyAssertion",D:za,Ra:$a,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Qi("user-not-found");if(t.errorMessage)throw Rs(t.errorMessage);if(!t[xa])throw new Qi("internal-error")},T:!0,F:!0},ks={endpoint:"verifyAssertion",D:function(t){if(za(t),!t.idToken)throw new Qi("internal-error")},Ra:$a,K:Za,T:!0},As={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new Qi("invalid-custom-token")},K:Xa,T:!0,F:!0},Ss={endpoint:"verifyPassword",D:function(t){if(Ga(t),!t.password)throw new Qi("wrong-password")},K:Xa,T:!0,F:!0},Ns={endpoint:"verifyPhoneNumber",D:Ja,K:Xa,F:!0},Os={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new Qi("internal-error");Ja(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Ro(t);Xa(t)}},_s={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Ja,K:Xa,F:!0};function Ps(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.V))return Qt(new Qi("internal-error"));var i,r=e.Kb||"POST";return Zt(n).then(e.D).then(function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,i,r,o){var a=An(t.h+e);En(a,"key",t.c),o&&En(a,"cb",A().toString());var s="GET"==n;if(s)for(var u in i)i.hasOwnProperty(u)&&En(a,u,i[u]);return new Gt(function(e,o){qa(t,a.toString(),function(t){t?t.error?o(Cs(t,r||{})):e(t):o(new Qi("network-request-failed"))},n,s?void 0:Yn(Ni(i)),t.a,t.i.get())})}(t,e.endpoint,r,n,e.Yb,e.wb||!1)}).then(function(t){return i=t,e.Ra?e.Ra(n,i):i}).then(e.K).then(function(){if(!e.fa)return i;if(!(e.fa in i))throw new Qi("internal-error");return i[e.fa]})}function Rs(t){return Cs({error:{errors:[{message:t}],code:400,message:t}})}function Cs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new Qi(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",$(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new Qi(i[r],e);return!e&&t&&(e=Si(t)),new Qi("internal-error",e)}function Ds(t){this.b=t,this.a=null,this.gb=function(t){return(js||(js=new Gt(function(t,e){function n(){Ri(),wi("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ri(),e(Error("Network Error"))},timeout:xs.get()})}if(wi("gapi.iframes.Iframe"))t();else if(wi("gapi.load"))n();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[i]=function(){wi("gapi.load")?n():e(Error("Network Error"))},Zt(Sa(i=ot(Ls,{onload:i}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw js=null,t}))).then(function(){return new Gt(function(e,n){wi("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:wi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Ms.get());i.ping(r).then(r,function(){n(Error("Network Error"))})})})})}(this)}var Ls=new Z(et,"https://apis.google.com/js/api.js?onload=%{onload}"),xs=new Ci(3e4,6e4),Ms=new Ci(5e3,15e3),js=null;function Us(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Sn(this.i,"/__/auth/iframe"),En(this.a,"apiKey",this.g),En(this.a,"appName",this.h),this.b=null,this.c=[]}function Vs(t,e,n,i,r){this.o=t,this.m=e,this.c=n,this.u=i,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function Fs(t){try{return e.app(t).auth().Ca()}catch(t){return[]}}function Ks(t,e,n,i,r){this.u=t,this.f=e,this.b=n,this.c=i||null,this.h=r||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function qs(t){var e=ei();return function(t){return Ps(t,vs,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=An(e),i=n.f;n=n.b;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=An(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:ai.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new _o(ei())})}function Hs(t){return t.l?t.l:(t.l=ui().then(function(){if(!t.o){var e=t.c,n=t.h,i=Fs(t.b),r=new Us(t.u,t.f,t.b);r.f=e,r.b=n,r.c=W(i||[]),t.o=r.toString()}t.i=new Ds(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then(function(){t.a.register("authEvent",e,wi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=Ao(e.authEvent),n=0;n<t.g.length;n++)i=t.g[n](e)||i;return(n={}).status=i?"ACK":"ERROR",Zt(n)}return n.status="ERROR",Zt(n)})}(t)}),t.l)}function Bs(t){return t.m||(t.v=t.c?bi(t.c,Fs(t.b)):null,t.m=new Da(t.f,Rr(t.h),t.v)),t.m}function Gs(t,e,n,i,r,o,a,s,u,c,h){return(t=new Vs(t,e,n,i,r)).l=o,t.g=a,t.i=s,t.b=Y(u||null),t.f=c,t.nb(h).toString()}function Ws(t){if(this.a=t||e.INTERNAL.reactNative&&e.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Qi("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Xs(t){this.b=t,this.a={},this.f=E(this.c,this)}Us.prototype.toString=function(){return this.f?En(this.a,"v",this.f):Un(this.a.a,"v"),this.b?En(this.a,"eid",this.b):Un(this.a.a,"eid"),this.c.length?En(this.a,"fw",this.c.join(",")):Un(this.a.a,"fw"),this.a.toString()},Vs.prototype.nb=function(t){return this.h=t,this},Vs.prototype.toString=function(){var t=Sn(this.o,"/__/auth/handler");if(En(t,"apiKey",this.m),En(t,"appName",this.c),En(t,"authType",this.u),this.a.isOAuthProvider){var n=this.a;try{var i=e.app(this.c).auth().ha()}catch(t){i=null}for(var r in n.bb=i,En(t,"providerId",this.a.providerId),i=Ni((n=this.a).zb))i[r]=i[r].toString();r=n.Fc,i=Y(i);for(var o=0;o<r.length;o++){var a=r[o];a in i&&delete i[a]}n.eb&&n.bb&&!i[n.eb]&&(i[n.eb]=n.bb),J(i)||En(t,"customParameters",Si(i))}if("function"==typeof this.a.Hb&&((n=this.a.Hb()).length&&En(t,"scopes",n.join(","))),this.l?En(t,"redirectUrl",this.l):Un(t.a,"redirectUrl"),this.g?En(t,"eventId",this.g):Un(t.a,"eventId"),this.i?En(t,"v",this.i):Un(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!kn(t,s)&&En(t,s,this.b[s]);return this.h?En(t,"tid",this.h):Un(t.a,"tid"),this.f?En(t,"eid",this.f):Un(t.a,"eid"),(s=Fs(this.c)).length&&En(t,"fw",s.join(",")),t.toString()},(t=Ks.prototype).Fb=function(t,e,n){var i=new Qi("popup-closed-by-user"),r=new Qi("web-storage-unsupported"),o=this,a=!1;return this.ia().then(function(){(function(t){var e={type:"webStorageSupport"};return Hs(t).then(function(){return function(t,e){return t.gb.then(function(){return new Gt(function(n){t.a.send(e.type,e,n,wi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&ri(t),e(r),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new Gt(function(e){return function n(){fn(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return fn(n).then(function(){e(i)})})},t.Ob=function(){var t=yi();return!Ai(t)&&!Pi(t)},t.Jb=function(){return!1},t.Db=function(t,e,n,i,r,o,a,s){if(!t)return Qt(new Qi("popup-blocked"));if(a&&!Ai())return this.ia().s(function(e){ri(t),r(e)}),i(),Zt();this.a||(this.a=qs(Bs(this)));var u=this;return this.a.then(function(){var e=u.ia().s(function(e){throw ri(t),r(e),e});return i(),e}).then(function(){(Eo(n),a)||ni(Gs(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Eb=function(t,e,n,i){this.a||(this.a=qs(Bs(this)));var r=this;return this.a.then(function(){Eo(e),ni(Gs(r.u,r.f,r.b,t,e,ei(),n,r.c,void 0,r.h,i))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ia=function(){var t=this;return Hs(this).then(function(){return t.i.gb}).s(function(){throw t.a=null,new Qi("network-request-failed")})},t.Rb=function(){return!0},t.Aa=function(t){this.g.push(t)},t.Na=function(t){B(this.g,function(e){return e==t})},(t=Ws.prototype).get=function(t){return Zt(this.a.getItem(t)).then(function(t){return t&&Oi(t)})},t.set=function(t,e){return Zt(this.a.setItem(t,Si(e)))},t.S=function(t){return Zt(this.a.removeItem(t))},t.$=function(){},t.ea=function(){};var Js,Ys=[];function zs(t,e,n){J(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function $s(t){this.a=t}function Zs(t){this.c=t,this.b=!1,this.a=[]}function Qs(t,e,n,i){var r,o,a,s,u=n||{},c=null;if(t.b)return Qt(Error("connection_unavailable"));var h=i?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Gt(function(n,i){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){i(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){i(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[l.port2])):i(Error("connection_unavailable"))}).then(function(e){return tu(t,c),e}).s(function(e){throw tu(t,c),e})}function tu(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),B(t.a,function(t){return t==e})}}function eu(){if(!ru())throw new Qi("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=s.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;li()&&self?(this.l=function(){var t=li()?self:null;if(V(Ys,function(n){n.b==t&&(e=n)}),!e){var e=new Xs(t);Ys.push(e)}return e}(),zs(this.l,"keyChanged",function(e,n){return cu(t).then(function(e){return 0<e.length&&V(t.a,function(t){t(e)}),{keyProcessed:q(e,n.key)}})}),zs(this.l,"ping",function(){return Zt(["keyChanged"])})):function(){var t=s.navigator;return t&&t.serviceWorker?Zt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Zt(null)}().then(function(e){(t.h=e)&&(t.g=new Zs(new $s(e)),Qs(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&q(e[0].value,"keyChanged")&&(t.o=!0)}).s(function(){}))})}function nu(t){return new Gt(function(e,n){var i=t.u.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new Gt(function(e,n){var i=t.u.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return nu(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function iu(t){return t.m||(t.m=nu(t)),t.m}function ru(){try{return!!s.indexedDB}catch(t){return!1}}function ou(t){return t.objectStore("firebaseLocalStorage")}function au(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function su(t){return new Gt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function uu(t,e){return t.g&&t.h&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Qs(t.g,"keyChanged",{key:e},t.o).then(function(){}).s(function(){}):Zt()}function cu(t){return iu(t).then(function(t){var e=ou(au(t,!1));return e.getAll?su(e.getAll()):new Gt(function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i})}function hu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function lu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Zt().then(function(){if(ru()){var t=_i(),i="__sak"+t;return Js||(Js=new eu),(n=Js).set(i,t).then(function(){return n.get(i)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.S(i)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.$(function(t){V(e.a,function(e){e(t)})}),t})}function fu(){this.a={},this.type="inMemory"}function du(){if(!function(){var t="Node"==fi();if(!(t=pu()||t&&e.INTERNAL.node&&e.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==fi())throw new Qi("internal-error","The LocalStorage compatibility library was not found.");throw new Qi("web-storage-unsupported")}this.a=pu()||e.INTERNAL.node.localStorage,this.type="localStorage"}function pu(){try{var t=s.localStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function vu(){this.type="nullStorage"}function mu(){if(!function(){var t="Node"==fi();if(!(t=gu()||t&&e.INTERNAL.node&&e.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==fi())throw new Qi("internal-error","The SessionStorage compatibility library was not found.");throw new Qi("web-storage-unsupported")}this.a=gu()||e.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function gu(){try{var t=s.sessionStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function bu(){var t={};t.Browser=Iu,t.Node=Tu,t.ReactNative=Eu,t.Worker=ku,this.a=t[fi()]}Xs.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];V(i,function(e){r.push(Zt().then(function(){return e(t.origin,t.data.data)}))}),ee(r).then(function(i){var r=[];V(i,function(t){r.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})}),V(r,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})})}},$s.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Zs.prototype.close=function(){for(;0<this.a.length;)tu(this,this.a[0]);this.b=!0},(t=eu.prototype).set=function(t,e){var n,i=!1,r=this;return iu(this).then(function(e){return su((e=ou(au(n=e,!0))).get(t))}).then(function(o){var a=ou(au(n,!0));return o?(o.value=e,su(a.put(o))):(r.b++,i=!0,(o={}).fbase_key=t,o.value=e,su(a.add(o)))}).then(function(){return r.c[t]=e,uu(r,t)}).ka(function(){i&&r.b--})},t.get=function(t){return iu(this).then(function(e){return su(ou(au(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.S=function(t){var e=!1,n=this;return iu(this).then(function(i){return e=!0,n.b++,su(ou(au(i,!0)).delete(t))}).then(function(){return delete n.c[t],uu(n,t)}).ka(function(){e&&n.b--})},t.$=function(t){0==this.a.length&&function(t){hu(t),function e(){t.f=setTimeout(function(){t.i=cu(t).then(function(e){0<e.length&&V(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ea=function(t){B(this.a,function(e){return e==t}),0==this.a.length&&hu(this)},(t=lu.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.S=function(t){return this.b.then(function(e){return e.S(t)})},t.$=function(t){this.a.push(t)},t.ea=function(t){B(this.a,function(e){return e==t})},(t=fu.prototype).get=function(t){return Zt(this.a[t])},t.set=function(t,e){return this.a[t]=e,Zt()},t.S=function(t){return delete this.a[t],Zt()},t.$=function(){},t.ea=function(){},(t=du.prototype).get=function(t){var e=this;return Zt().then(function(){return Oi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Zt().then(function(){var i=Si(e);null===i?n.S(t):n.a.setItem(t,i)})},t.S=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},t.$=function(t){s.window&&Je(s.window,"storage",t)},t.ea=function(t){s.window&&$e(s.window,"storage",t)},(t=vu.prototype).get=function(){return Zt(null)},t.set=function(){return Zt()},t.S=function(){return Zt()},t.$=function(){},t.ea=function(){},(t=mu.prototype).get=function(t){var e=this;return Zt().then(function(){return Oi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Zt().then(function(){var i=Si(e);null===i?n.S(t):n.a.setItem(t,i)})},t.S=function(t){var e=this;return Zt().then(function(){e.a.removeItem(t)})},t.$=function(){},t.ea=function(){};var yu,wu,Iu={C:du,Ta:mu},Tu={C:du,Ta:mu},Eu={C:Ws,Ta:vu},ku={C:du,Ta:vu},Au={ad:"local",NONE:"none",cd:"session"};function Su(){var t=!(Pi(yi())||!hi()),e=Ai(),n=Ii();this.m=t,this.h=e,this.l=n,this.a={},yu||(yu=new bu),t=yu;try{this.g=!ti()&&xi()||!s.indexedDB?new t.a.C:new lu(li()?new fu:new t.a.C)}catch(t){this.g=new fu,this.h=!0}try{this.i=new t.a.Ta}catch(t){this.i=new fu}this.u=new fu,this.f=E(this.Pb,this),this.b={}}function Nu(){return wu||(wu=new Su),wu}function Ou(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function _u(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Pu(t,e,n){return n=_u(e,n),"local"==e.C&&(t.b[n]=null),Ou(t,e.C).S(n)}function Ru(t){t.c&&(clearInterval(t.c),t.c=null)}function Cu(t){this.a=t,this.b=Nu()}(t=Su.prototype).get=function(t,e){return Ou(this,t.C).get(_u(t,e))},t.set=function(t,e,n){var i=_u(t,n),r=this,o=Ou(this,t.C);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.C&&(r.b[i]=e)})},t.addListener=function(t,e,n){t=_u(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),J(this.a)&&(Ou(this,"local").$(this.f),this.h||(ti()||!xi())&&s.indexedDB||!this.l||function(t){Ru(t),t.c=setInterval(function(){for(var e in t.a){var n=s.localStorage.getItem(e),i=t.b[e];n!=i&&(t.b[e]=n,n=new je({type:"storage",key:e,target:window,oldValue:i,newValue:n,a:!0}),t.Pb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=_u(t,e),this.a[t]&&(B(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),J(this.a)&&(Ou(this,"local").ea(this.f),Ru(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=s.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Ou(this,"local").ea(this.f):Ru(this),this.m)if(n=s.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?s.localStorage.setItem(e,i):s.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.$a(e))},we&&_e&&10==_e&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else V(t,E(this.$a,this))},t.$a=function(t){this.a[t]&&V(this.a[t],function(t){t()})};var Du,Lu={name:"authEvent",C:"local"};function xu(){this.a=Nu()}function Mu(t,e){this.b=ju,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0!==Du||(Du=s.Int32Array?new Int32Array(Bu):Bu),this.reset()}S(Mu,function(){this.b=-1});for(var ju=64,Uu=ju-1,Vu=[],Fu=0;Fu<Uu;Fu++)Vu[Fu]=0;var Ku=G(128,Vu);function qu(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Du[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+f|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Hu(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if(u(e))for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(qu(t),r=0);else{if(!m(e))throw Error("message must be string or array");for(;i<n;){var o=e[i++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[r++]=o,r==t.b&&(qu(t),r=0)}}t.c=r,t.g+=n}Mu.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):W(this.h)};var Bu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Gu(){Mu.call(this,8,Wu)}S(Gu,Mu);var Wu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Xu(t,e,n,i,r){this.u=t,this.i=e,this.l=n,this.m=i||null,this.o=r||null,this.h=e+":"+n,this.v=new xu,this.g=new Cu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ju(t){return new Qi("invalid-cordova-configuration",t)}function Yu(t){var e=new Gu;Hu(e,t),t=[];var n=8*e.g;56>e.c?Hu(e,Ku,56-e.c):Hu(e,Ku,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(qu(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return F(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function zu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function $u(t){return t.f||(t.f=t.ia().then(function(){return new Gt(function(e){t.Aa(function n(i){return e(i),t.Na(n),!1}),function(t){function e(e){i=!0,r&&r.cancel(),Zu(t).then(function(i){var r=n;if(i&&e&&e.url){var o=null;-1!=(r=Gr(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Oi(kn(o=An(r),"firebaseError")||null))?tr(o):null)?new ko(i.c,i.b,null,null,o,null,i.R()):new ko(i.c,i.b,r,i.f,null,null,i.R())),r=o||n}zu(t,r)})}var n=new ko("unknown",null,null,null,new Qi("no-auth-event")),i=!1,r=fn(500).then(function(){return Zu(t).then(function(){i||zu(t,n)})}),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(wi("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Oo||(Oo=new So),function(t){var e=Oo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=wi("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)})})),t.f}function Zu(t){var e=null;return function(t){return t.b.get(Lu,t.a).then(function(t){return Ao(t)})}(t.g).then(function(n){return e=n,Pu((n=t.g).b,Lu,n.a)}).then(function(){return e})}function Qu(t){this.a=t,this.b=Nu()}(t=Xu.prototype).ia=function(){return this.Da?this.Da:this.Da=(ci(void 0)?ui().then(function(){return new Gt(function(t,e){var n=s.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Qt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof wi("universalLinks.subscribe",s))throw Ju("cordova-universal-links-plugin-fix is not installed");if(void 0===wi("BuildInfo.packageName",s))throw Ju("cordova-plugin-buildinfo is not installed");if("function"!=typeof wi("cordova.plugins.browsertab.openUrl",s))throw Ju("cordova-plugin-browsertab is not installed");if("function"!=typeof wi("cordova.InAppBrowser.open",s))throw Ju("cordova-plugin-inappbrowser is not installed")},function(){throw new Qi("cordova-not-ready")})},t.Fb=function(t,e){return e(new Qi("operation-not-supported-in-this-environment")),Zt()},t.Db=function(){return Qt(new Qi("operation-not-supported-in-this-environment"))},t.Rb=function(){return!1},t.Ob=function(){return!0},t.Jb=function(){return!0},t.Eb=function(t,e,n,i){if(this.c)return Qt(new Qi("redirect-operation-pending"));var r=this,o=s.document,a=null,u=null,c=null,h=null;return this.c=Zt().then(function(){return Eo(e),$u(r)}).then(function(){return function(t,e,n,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new ko(e,i,null,o,new Qi("no-auth-event"),null,r),u=wi("BuildInfo.packageName",s);if("string"!=typeof u)throw new Qi("invalid-cordova-configuration");var c=wi("BuildInfo.displayName",s),h={};if(yi().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!yi().toLowerCase().match(/android/))return Qt(new Qi("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=Yu(o),h.sessionId=o;var l=Gs(t.u,t.i,t.l,e,n,null,i,t.m,h,t.o,r);return t.ia().then(function(){var e=t.h;return t.v.a.set(Lu,a.A(),e)}).then(function(){var e=wi("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new Qi("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=wi("cordova.plugins.browsertab.openUrl",s)))throw new Qi("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=wi("cordova.InAppBrowser.open",s)))throw new Qi("invalid-cordova-configuration");e=yi(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n,i)}).then(function(){return new Gt(function(t,e){u=function(){var e=wi("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Aa(u),c=function(){a||(a=fn(2e3).then(function(){e(new Qi("redirect-cancelled-by-user"))}))},h=function(){Di()&&c()},o.addEventListener("resume",c,!1),yi().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).s(function(t){return Zu(r).then(function(){throw t})})}).ka(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),u&&r.Na(u),r.c=null})},t.Aa=function(t){this.b.push(t),$u(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new ko("unknown",null,null,null,new Qi("no-auth-event")),t(e))})},t.Na=function(t){B(this.b,function(e){return e==t})};var tc={name:"pendingRedirect",C:"session"};function ec(t){return Pu(t.b,tc,t.a)}function nc(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=E(this.o,this),this.b=new mc,this.w=new Ic,this.g=new Qu(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=ic(this.B,this.u,this.m,_r)}function ic(t,n,i,r){var o=e.SDK_VERSION||null;return ci()?new Xu(t,n,i,o,r):new Ks(t,n,i,o,r)}function rc(t){t.f||(t.f=!0,t.a.Aa(t.l));var e=t.a;return t.a.ia().s(function(n){throw t.a==e&&t.reset(),n})}function oc(t){t.a.Ob()&&rc(t).s(function(e){var n=new ko("unknown",null,null,null,new Qi("operation-not-supported-in-this-environment"));lc(e)&&t.o(n)}),t.a.Jb()||gc(t.b)}function ac(t,e){q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(tc,t.a).then(function(t){return"pending"==t})}(t.g).then(function(e){e?ec(t.g).then(function(){rc(t).s(function(e){var n=new ko("unknown",null,null,null,new Qi("operation-not-supported-in-this-environment"));lc(e)&&t.o(n)})}):oc(t)}).s(function(){oc(t)})}function sc(t,e){B(t.h,function(t){return t==e})}nc.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=ic(this.B,this.u,this.m),this.i={}},nc.prototype.o=function(t){if(!t)throw new Qi("invalid-auth-event");if(6e5<=A()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=A())),e=!0;break}}return gc(this.b),e};var uc=new Ci(2e3,1e4),cc=new Ci(3e4,6e4);function hc(t,e,n,i,r,o,a){return t.a.Db(e,n,i,function(){t.f||(t.f=!0,t.a.Aa(t.l))},function(){t.reset()},r,o,a)}function lc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function fc(t,e,n,i,r){var o;return function(t){return t.b.set(tc,"pending",t.a)}(t.g).then(function(){return t.a.Eb(e,n,i,r).s(function(e){if(lc(e))throw new Qi("operation-not-supported-in-this-environment");return o=e,ec(t.g).then(function(){throw o})}).then(function(){return t.a.Rb()?new Gt(function(){}):ec(t.g).then(function(){return t.oa()}).then(function(){}).s(function(){})})})}function dc(t,e,n,i,r){return t.a.Fb(i,function(t){e.ja(n,null,t,r)},uc.get())}nc.prototype.oa=function(){return this.b.oa()};var pc={};function vc(t,e,n){var i=e+":"+n;return pc[i]||(pc[i]=new nc(t,e,n)),pc[i]}function mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function gc(t){t.g||(t.g=!0,wc(t,!1,null,null))}function bc(t){t.g&&!t.i&&wc(t,!1,null,null)}function yc(t,e){if(t.b=function(){return Zt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function wc(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Qt(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):yc(t,n):yc(t,{user:null}),t.f=[],t.c=[]}function Ic(){}function Tc(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function Ec(t,e){this.a=e,Fi(this,"verificationId",t)}function kc(t,e,n,i){return new wo(t).Wa(e,n).then(function(t){return new Ec(t,i)})}function Ac(t){var e=Or(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Qi("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ki(this,{token:t,expirationTime:Li(1e3*e.exp),authTime:Li(1e3*e.auth_time),issuedAtTime:Li(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Sc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Nc(t){this.f=t,this.b=this.a=null,this.c=0}function Oc(t,e){var n=e[xa],i=e.refreshToken;e=_c(e.expiresIn),t.b=n,t.c=e,t.a=i}function _c(t){return A()+1e3*parseInt(t,10)}function Pc(t,e){return function(t,e){return new Gt(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?qa(t,t.l+"?key="+encodeURIComponent(t.c),function(t){t?t.error?i(Cs(t)):t.access_token&&t.refresh_token?n(t):i(new Qi("internal-error")):i(new Qi("network-request-failed"))},"POST",jn(e).toString(),t.g,t.u.get()):i(new Qi("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=_c(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function Rc(t,e){this.a=t||null,this.b=e||null,Ki(this,{lastSignInTime:Li(e||null),creationTime:Li(t||null)})}function Cc(t,e,n,i,r,o){Ki(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function Dc(t,e){for(var n in Me.call(this,t),e)this[n]=e[n]}function Lc(t,n,i){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=e.SDK_VERSION?bi(e.SDK_VERSION):null,this.a=new Da(this.l,Rr(_r),t),this.b=new Nc(this.a),Kc(this,n[xa]),Oc(this.b,n),Fi(this,"refreshToken",this.b.a),Bc(this,i||{}),sn.call(this),this.J=!1,this.o&&Ti()&&(this.i=vc(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(t){return new Sc(function(){return t.G(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.b.c-A()-3e5;return 0<e?e:0})}(this),this.W=E(this.Ja,this);var r=this;this.ga=null,this.xa=function(t){r.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){Mc(r,t.c)},this.Y=null}function xc(t,e){t.Z&&$e(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&Je(e,"languageCodeChanged",t.xa)}function Mc(t,n){t.P=n,Ka(t.a,e.SDK_VERSION?bi(e.SDK_VERSION,t.P):null)}function jc(t,e){t.Y&&$e(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&Je(e,"frameworkChanged",t.wa)}function Uc(t){try{return e.app(t.m).auth()}catch(e){throw new Qi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Vc(t){t.B||t.w.b||(t.w.start(),$e(t,"tokenChanged",t.W),Je(t,"tokenChanged",t.W))}function Fc(t){$e(t,"tokenChanged",t.W),t.w.stop()}function Kc(t,e){t.ma=e,Fi(t,"_lat",e)}function qc(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return ee(e).then(function(){return t})}function Hc(t){t.i&&!t.J&&(t.J=!0,ac(t.i,t))}function Bc(t,e){Ki(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Rc(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Gc(){}function Wc(t){return Zt().then(function(){if(t.B)throw new Qi("app-deleted")})}function Xc(t){return F(t.providerData,function(t){return t.providerId})}function Jc(t,e){e&&(Yc(t,e.providerId),t.providerData.push(e))}function Yc(t,e){B(t.providerData,function(t){return t.providerId==e})}function zc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Fi(t,e,n)}function $c(t,e){t!=e&&(Ki(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Fi(t,"metadata",function(t){return new Rc(t.a,t.b)}(e.metadata)):Fi(t,"metadata",new Rc),V(e.providerData,function(e){Jc(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Fi(t,"refreshToken",t.b.a))}function Zc(t){return t.G().then(function(e){var n=t.isAnonymous;return function(t,e){return Ps(t.a,ls,{idToken:e}).then(E(t.zc,t))}(t,e).then(function(){return n||zc(t,"isAnonymous",!1),e})})}function Qc(t,e){e[xa]&&t.ma!=e[xa]&&(Oc(t.b,e),t.dispatchEvent(new Dc("tokenChanged")),Kc(t,e[xa]),zc(t,"refreshToken",t.b.a))}function th(t,e){return Zc(t).then(function(){if(q(Xc(t),e))return qc(t).then(function(){throw new Qi("provider-already-linked")})})}function eh(t,e,n){return qi({user:t,credential:To(e),additionalUserInfo:e=Mr(e),operationType:n})}function nh(t,e){return Qc(t,e),t.reload().then(function(){return t})}function ih(t,n,i,r,o){if(!Ti())return Qt(new Qi("operation-not-supported-in-this-environment"));if(t.h&&!o)return Qt(t.h);var a=xr(i.providerId),s=_i(t.uid+":::"),u=null;(!Ai()||hi())&&t.o&&i.isOAuthProvider&&(u=Gs(t.o,t.l,t.m,n,i,null,s,e.SDK_VERSION||null,null,null,t.tenantId));var c=oi(u,a&&a.sa,a&&a.ra);return r=r().then(function(){if(oh(t),!o)return t.G().then(function(){})}).then(function(){return hc(t.i,c,n,i,s,!!u,t.tenantId)}).then(function(){return new Gt(function(e,i){t.ja(n,null,new Qi("cancelled-popup-request"),t.g||null),t.f=e,t.v=i,t.g=s,t.c=dc(t.i,t,n,c,s)})}).then(function(t){return c&&ri(c),t?qi(t):null}).s(function(t){throw c&&ri(c),t}),ah(t,r,o)}function rh(t,e,n,i,r){if(!Ti())return Qt(new Qi("operation-not-supported-in-this-environment"));if(t.h&&!r)return Qt(t.h);var o=null,a=_i(t.uid+":::");return i=i().then(function(){if(oh(t),!r)return t.G().then(function(){})}).then(function(){return t.ca=a,qc(t)}).then(function(e){return t.da&&(e=(e=t.da).b.set(ch,t.A(),e.a)),e}).then(function(){return fc(t.i,e,n,a,t.tenantId)}).s(function(e){if(o=e,t.da)return hh(t.da);throw o}).then(function(){if(o)throw o}),ah(t,i,r)}function oh(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new Qi("internal-error");throw new Qi("auth-domain-config-required")}}function ah(t,e,n){var i=function(t,e,n){return t.h&&!n?(e.cancel(),Qt(t.h)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Dc("userInvalidated")),t.h=e),e})}(t,e,n);return t.I.push(i),i.ka(function(){H(t.I,i)}),i}function sh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[xa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-A())/1e3;var i=new Lc(e,n,t);return t.providerData&&V(t.providerData,function(t){t&&Jc(i,qi(t))}),t.redirectEventId&&(i.ca=t.redirectEventId),i}function uh(t){this.a=t,this.b=Nu()}mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},mc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(wc(this,!0,null,t.a),Zt()):e.Ba(n,i)?function(t,e,n){n=n.Ba(e.c,e.b);var i=e.g,r=e.f,o=e.i,a=e.R(),s=!!e.c.match(/Redirect$/);n(i,r,a,o).then(function(e){wc(t,s,e,null)}).s(function(e){wc(t,s,null,e)})}(this,t,e):Qt(new Qi("invalid-auth-event")):(wc(this,!1,null,null),Zt())}else Qt(new Qi("invalid-auth-event"))},mc.prototype.oa=function(){var t=this;return new Gt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Qi("timeout");t.a&&t.a.cancel(),t.a=fn(cc.get()).then(function(){t.b||(t.g=!0,wc(t,!0,null,e))})}(t))})},Ic.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.ja(t.c,null,t.a,t.b),Zt()):e.Ba(n,i)?function(t,e){var n=t.b,i=t.c;e.Ba(i,n)(t.g,t.f,t.R(),t.i).then(function(t){e.ja(i,t,null,n)}).s(function(t){e.ja(i,null,t,n)})}(t,e):Qt(new Qi("invalid-auth-event"))}else Qt(new Qi("invalid-auth-event"))},Ec.prototype.confirm=function(t){return t=Io(this.verificationId,t),this.a(t)},Sc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=fn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=s.document,e=null,Di()||!t?Zt():new Gt(function(n){e=function(){Di()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},Sc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Nc.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Nc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Qt(new Qi("user-token-expired")):t||!this.b||A()>this.c-3e4?this.a?Pc(this,{grant_type:"refresh_token",refresh_token:this.a}):Zt(null):Zt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Rc.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(Dc,Me),S(Lc,sn),Lc.prototype.ua=function(t){this.ga=t,Fa(this.a,t)},Lc.prototype.ha=function(){return this.ga},Lc.prototype.Ca=function(){return W(this.P)},Lc.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},Fi(Lc.prototype,"providerId","firebase"),(t=Lc.prototype).reload=function(){var t=this;return ah(this,Wc(this).then(function(){return Zc(t).then(function(){return qc(t)}).then(Gc)}))},t.dc=function(t){return this.G(t).then(function(t){return new Ac(t)})},t.G=function(t){var e=this;return ah(this,Wc(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new Qi("internal-error");return t.accessToken!=e.ma&&(Kc(e,t.accessToken),e.dispatchEvent(new Dc("tokenChanged"))),zc(e,"refreshToken",t.refreshToken),t.accessToken}))},t.zc=function(t){if(!(t=t.users)||!t.length)throw new Qi("internal-error");Bc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?F(t,function(t){return new Cc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Jc(this,e[n]);zc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.Ac=function(t){return Ui("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},t.hb=function(t){var e=this,n=null;return ah(this,t.f(this.a,this.uid).then(function(t){return Qc(e,t),n=eh(e,t,"reauthenticate"),e.h=null,e.reload()}).then(function(){return n}),!0)},t.rc=function(t){return Ui("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},t.fb=function(t){var e=this,n=null;return ah(this,th(this,t.providerId).then(function(){return e.G()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=eh(e,t,"link"),nh(e,t)}).then(function(){return n}))},t.sc=function(t,e){var n=this;return ah(this,th(this,"phone").then(function(){return kc(Uc(n),t,e,E(n.fb,n))}))},t.Bc=function(t,e){var n=this;return ah(this,Zt().then(function(){return kc(Uc(n),t,e,E(n.hb,n))}),!0)},t.rb=function(t){var e=this;return ah(this,this.G().then(function(n){return e.a.rb(n,t)}).then(function(t){return Qc(e,t),e.reload()}))},t.Sc=function(t){var e=this;return ah(this,this.G().then(function(n){return t.b(e.a,n)}).then(function(t){return Qc(e,t),e.reload()}))},t.sb=function(t){var e=this;return ah(this,this.G().then(function(n){return e.a.sb(n,t)}).then(function(t){return Qc(e,t),e.reload()}))},t.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Wc(this);var e=this;return ah(this,this.G().then(function(n){return e.a.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Qc(e,t),zc(e,"displayName",t.displayName||null),zc(e,"photoURL",t.photoUrl||null),V(e.providerData,function(t){"password"===t.providerId&&(Fi(t,"displayName",e.displayName),Fi(t,"photoURL",e.photoURL))}),qc(e)}).then(Gc))},t.Qc=function(t){var e=this;return ah(this,Zc(this).then(function(n){return q(Xc(e),t)?function(t,e,n){return Ps(t,us,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then(function(t){var n={};return V(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),V(Xc(e),function(t){n[t]||Yc(e,t)}),n[wo.PROVIDER_ID]||Fi(e,"phoneNumber",null),qc(e)}):qc(e).then(function(){throw new Qi("no-such-provider")})}))},t.delete=function(){var t=this;return ah(this,this.G().then(function(e){return Ps(t.a,ss,{idToken:e})}).then(function(){t.dispatchEvent(new Dc("userDeleted"))})).then(function(){for(var e=0;e<t.I.length;e++)t.I[e].cancel("app-deleted");xc(t,null),jc(t,null),t.I=[],t.B=!0,Fc(t),Fi(t,"refreshToken",null),t.i&&sc(t.i,t)})},t.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},t.ja=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?E(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?E(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?E(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?E(this.Cb,this):null},t.tc=function(t){var e=this;return ih(this,"linkViaPopup",t,function(){return th(e,t.providerId).then(function(){return qc(e)})},!1)},t.Cc=function(t){return ih(this,"reauthViaPopup",t,function(){return Zt()},!0)},t.uc=function(t){var e=this;return rh(this,"linkViaRedirect",t,function(){return th(e,t.providerId)},!1)},t.Dc=function(t){return rh(this,"reauthViaRedirect",t,function(){return Zt()},!0)},t.Bb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return ah(this,this.G().then(function(n){return ts(r.a,{requestUri:t,postBody:i,sessionId:e,idToken:n})}).then(function(t){return o=eh(r,t,"link"),nh(r,t)}).then(function(){return o}))},t.Cb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return ah(this,Zt().then(function(){return Xr(es(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)}).then(function(t){return o=eh(r,t,"reauthenticate"),Qc(r,t),r.h=null,r.reload()}).then(function(){return o}),!0)},t.jb=function(t){var e=this,n=null;return ah(this,this.G().then(function(e){return n=e,void 0===t||J(t)?{}:Tr(new fr(t))}).then(function(t){return e.a.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.A()},t.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&$(t,this.metadata.A()),V(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var ch={name:"redirectUser",C:"session"};function hh(t){return Pu(t.b,ch,t.a)}function lh(t){this.a=t,this.b=Nu(),this.c=null,this.f=function(t){var e=ph("local"),n=ph("session"),i=ph("none");return function(t,e,n){var i=_u(e,n),r=Ou(t,e.C);return t.get(e,n).then(function(o){var a=null;try{a=Oi(s.localStorage.getItem(i))}catch(t){}if(a&&!o)return s.localStorage.removeItem(i),t.set(e,a,n);a&&o&&"localStorage"!=r.type&&s.localStorage.removeItem(i)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(r){return r?n:t.b.get(i,t.a).then(function(n){return n?i:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(dh,t.a).then(function(t){return t?ph(t):e})})})}).then(function(e){return t.c=e,fh(t,e.C)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(ph("local"),this.a,E(this.g,this))}function fh(t,e){var n,i=[];for(n in Au)Au[n]!==e&&i.push(Pu(t.b,ph(Au[n]),t.a));return i.push(Pu(t.b,dh,t.a)),function(t){return new Gt(function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)te(t[s],k(o,s),a);else e(r)})}(i)}lh.prototype.g=function(){var t=this,e=ph("local");bh(this,function(){return Zt().then(function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null}).then(function(n){if(n)return fh(t,"local").then(function(){t.c=e})})})};var dh={name:"persistence",C:"session"};function ph(t){return{name:"authUser",C:t}}function vh(t,e){return bh(t,function(){return t.b.set(t.c,e.A(),t.a)})}function mh(t){return bh(t,function(){return Pu(t.b,t.c,t.a)})}function gh(t,e){return bh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),sh(t||{})})})}function bh(t,e){return t.f=t.f.then(e,e),t.f}function yh(t){if(this.l=!1,Fi(this,"settings",new Tc),Fi(this,"app",t),!Nh(this).options||!Nh(this).options.apiKey)throw new Qi("invalid-api-key");t=e.SDK_VERSION?bi(e.SDK_VERSION):null,this.b=new Da(Nh(this).options&&Nh(this).options.apiKey,Rr(_r),t),this.O=[],this.m=[],this.J=[],this.Ub=e.INTERNAL.createSubscribe(E(this.oc,this)),this.W=void 0,this.Vb=e.INTERNAL.createSubscribe(E(this.pc,this)),Ah(this,null),this.h=new lh(Nh(this).options.apiKey+":"+Nh(this).name),this.w=new uh(Nh(this).options.apiKey+":"+Nh(this).name),this.Y=Rh(this,function(t){var e=Nh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(ch,t.a).then(function(t){return t&&e&&(t.authDomain=e),sh(t||{})})}(t.w,Nh(t).options.authDomain).then(function(e){return(t.B=e)&&(e.da=t.w),hh(t.w)});return Rh(t,e)}(t).then(function(){return gh(t.h,e)}).then(function(e){return e?(e.da=t.w,t.B&&(t.B.ca||null)==(e.ca||null)?e:e.reload().then(function(){return vh(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:mh(t.h)})):null}).then(function(e){Ah(t,e||null)});return Rh(t,n)}(this)),this.i=Rh(this,function(t){return t.Y.then(function(){return Eh(t)}).s(function(){}).then(function(){if(!t.l)return t.ma()}).s(function(){}).then(function(){if(!t.l){t.ga=!0;var e=t.h;e.b.addListener(ph("local"),e.a,t.ma)}})}(this)),this.ga=!1,this.ma=E(this.Nc,this),this.ub=E(this.aa,this),this.wa=E(this.bc,this),this.xa=E(this.mc,this),this.Ja=E(this.nc,this),this.a=null,function(t){var e=Nh(t).options.authDomain,n=Nh(t).options.apiKey;e&&Ti()&&(t.Tb=t.Y.then(function(){if(!t.l){if(t.a=vc(e,n,Nh(t).name),ac(t.a,t),Oh(t)&&Hc(Oh(t)),t.B){Hc(t.B);var i=t.B;i.ua(t.ha()),xc(i,t),Mc(i=t.B,t.I),jc(i,t),t.B=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=E(this.delete,this),this.INTERNAL.logFramework=E(this.vc,this),this.o=0,sn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}(this),this.I=[]}function wh(t){Me.call(this,"languageCodeChanged"),this.g=t}function Ih(t){Me.call(this,"frameworkChanged"),this.c=t}function Th(t){return t.Tb||Qt(new Qi("auth-domain-config-required"))}function Eh(t){if(!Ti())return Qt(new Qi("operation-not-supported-in-this-environment"));var e=Th(t).then(function(){return t.a.oa()}).then(function(t){return t?qi(t):null});return Rh(t,e)}function kh(t,e){var n={};return n.apiKey=Nh(t).options.apiKey,n.authDomain=Nh(t).options.authDomain,n.appName=Nh(t).name,t.Y.then(function(){return function(t,e,n,i){var r=new Lc(t,e);return n&&(r.da=n),i&&Mc(r,i),r.reload().then(function(){return r})}(n,e,t.w,t.Ca())}).then(function(e){return Oh(t)&&e.uid==Oh(t).uid?($c(Oh(t),e),t.aa(e)):(Ah(t,e),Hc(e),t.aa(e))}).then(function(){Ph(t)})}function Ah(t,e){Oh(t)&&(function(t,e){B(t.O,function(t){return t==e})}(Oh(t),t.ub),$e(Oh(t),"tokenChanged",t.wa),$e(Oh(t),"userDeleted",t.xa),$e(Oh(t),"userInvalidated",t.Ja),Fc(Oh(t))),e&&(e.O.push(t.ub),Je(e,"tokenChanged",t.wa),Je(e,"userDeleted",t.xa),Je(e,"userInvalidated",t.Ja),0<t.o&&Vc(e)),Fi(t,"currentUser",e),e&&(e.ua(t.ha()),xc(e,t),Mc(e,t.I),jc(e,t))}function Sh(t,e){var n=null,i=null;return Rh(t,e.then(function(e){return n=To(e),i=Mr(e),kh(t,e)}).then(function(){return qi({user:Oh(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))}function Nh(t){return t.app}function Oh(t){return t.currentUser}function _h(t){return Oh(t)&&Oh(t)._lat||null}function Ph(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](_h(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](_h(t))}}function Rh(t,e){return t.O.push(e),e.ka(function(){H(t.O,e)}),e}function Ch(){}function Dh(){this.a={},this.b=1e12}lh.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new Qi("invalid-persistence-type"),n=new Qi("unsupported-persistence-type");t:{for(i in Au)if(Au[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(fi()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Ii()&&"none"!==t)throw n}}(t),bh(this,function(){return t!=n.c.C?n.b.get(n.c,n.a).then(function(i){return e=i,fh(n,t)}).then(function(){if(n.c=ph(t),e)return n.b.set(n.c,e,n.a)}):Zt()})},S(yh,sn),S(wh,Me),S(Ih,Me),(t=yh.prototype).mb=function(t){return Rh(this,t=this.h.mb(t))},t.ua=function(t){this.Z===t||this.l||(this.Z=t,Fa(this.b,this.Z),this.dispatchEvent(new wh(this.ha())))},t.ha=function(){return this.Z},t.Tc=function(){var t=s.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.vc=function(t){this.I.push(t),Ka(this.b,e.SDK_VERSION?bi(e.SDK_VERSION,this.I):null),this.dispatchEvent(new Ih(this.I))},t.Ca=function(){return W(this.I)},t.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},t.R=function(){return this.P},t.toJSON=function(){return{apiKey:Nh(this).options.apiKey,authDomain:Nh(this).options.authDomain,appName:Nh(this).name,currentUser:Oh(this)&&Oh(this).A()}},t.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ja=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?E(this.ac,this):null},t.ac=function(t,e,n,i){var r=this;t={requestUri:t,postBody:i,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,a=null,s=Qa(r.b,t).then(function(t){return o=To(t),a=Mr(t),t});return Rh(this,t=r.Y.then(function(){return s}).then(function(t){return kh(r,t)}).then(function(){return qi({user:Oh(r),credential:o,additionalUserInfo:a,operationType:"signIn"})}))},t.Lc=function(t){if(!Ti())return Qt(new Qi("operation-not-supported-in-this-environment"));var n=this,i=xr(t.providerId),r=_i(),o=null;(!Ai()||hi())&&Nh(this).options.authDomain&&t.isOAuthProvider&&(o=Gs(Nh(this).options.authDomain,Nh(this).options.apiKey,Nh(this).name,"signInViaPopup",t,null,r,e.SDK_VERSION||null,null,null,this.R()));var a=oi(o,i&&i.sa,i&&i.ra);return Rh(this,i=Th(this).then(function(e){return hc(e,a,"signInViaPopup",t,r,!!o,n.R())}).then(function(){return new Gt(function(t,e){n.ja("signInViaPopup",null,new Qi("cancelled-popup-request"),n.g),n.f=t,n.v=e,n.g=r,n.c=dc(n.a,n,"signInViaPopup",a,r)})}).then(function(t){return a&&ri(a),t?qi(t):null}).s(function(t){throw a&&ri(a),t}))},t.Mc=function(t){if(!Ti())return Qt(new Qi("operation-not-supported-in-this-environment"));var e=this;return Rh(this,Th(this).then(function(){return bh(t=e.h,function(){return t.b.set(dh,t.c.C,t.a)});var t}).then(function(){return fc(e.a,"signInViaRedirect",t,void 0,e.R())}))},t.oa=function(){var t=this;return Eh(this).then(function(e){return t.a&&bc(t.a.b),e}).s(function(e){throw t.a&&bc(t.a.b),e})},t.Rc=function(t){if(!t)return Qt(new Qi("null-user"));if(this.P!=t.tenantId)return Qt(new Qi("tenant-id-mismatch"));var e=this,n={};n.apiKey=Nh(this).options.apiKey,n.authDomain=Nh(this).options.authDomain,n.appName=Nh(this).name;var i=function(t,e,n,i){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var r=t.b,o={};return o[xa]=r.b,o.refreshToken=r.a,o.expiresIn=(r.c-A())/1e3,e=new Lc(e,o),n&&(e.da=n),i&&Mc(e,i),$c(e,t),e}(t,n,e.w,e.Ca());return Rh(this,this.i.then(function(){if(Nh(e).options.apiKey!=t.l)return i.reload()}).then(function(){return Oh(e)&&t.uid==Oh(e).uid?($c(Oh(e),t),e.aa(t)):(Ah(e,i),Hc(i),e.aa(i))}).then(function(){Ph(e)}))},t.pb=function(){var t=this;return Rh(this,this.i.then(function(){return t.a&&bc(t.a.b),Oh(t)?(Ah(t,null),mh(t.h).then(function(){Ph(t)})):Zt()}))},t.Nc=function(){var t=this;return gh(this.h,Nh(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=Oh(t)&&e){n=Oh(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return $c(Oh(t),e),Oh(t).G();(Oh(t)||e)&&(Ah(t,e),e&&(Hc(e),e.da=t.w),t.a&&ac(t.a,t),Ph(t))}})},t.aa=function(t){return vh(this.h,t)},t.bc=function(){Ph(this),this.aa(Oh(this))},t.mc=function(){this.pb()},t.nc=function(){this.pb()},t.oc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Oh(e))})},t.pc=function(t){var e=this;!function(t,e){t.J.push(e),Rh(t,t.i.then(function(){!t.l&&q(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(_h(t)))}))}(this,function(){t.next(Oh(e))})},t.xc=function(t,e,n){var i=this;return this.ga&&Promise.resolve().then(function(){g(t)?t(Oh(i)):g(t.next)&&t.next(Oh(i))}),this.Ub(t,e,n)},t.wc=function(t,e,n){var i=this;return this.ga&&Promise.resolve().then(function(){i.W=i.getUid(),g(t)?t(Oh(i)):g(t.next)&&t.next(Oh(i))}),this.Vb(t,e,n)},t.cc=function(t){var e=this;return Rh(this,this.i.then(function(){return Oh(e)?Oh(e).G(t).then(function(t){return{accessToken:t}}):null}))},t.Hc=function(t){var e=this;return this.i.then(function(){return Sh(e,Ps(e.b,As,{token:t}))}).then(function(t){var n=t.user;return zc(n,"isAnonymous",!1),e.aa(n),t})},t.Ic=function(t,e){var n=this;return this.i.then(function(){return Sh(n,Ps(n.b,Ss,{email:t,password:e}))})},t.Xb=function(t,e){var n=this;return this.i.then(function(){return Sh(n,Ps(n.b,os,{email:t,password:e}))})},t.Sa=function(t){var e=this;return this.i.then(function(){return Sh(e,t.na(e.b))})},t.Gc=function(t){return Ui("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},t.ob=function(){var t=this;return this.i.then(function(){var e=Oh(t);if(e&&e.isAnonymous){var n=qi({providerId:null,isNewUser:!1});return qi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Sh(t,t.b.ob()).then(function(e){var n=e.user;return zc(n,"isAnonymous",!0),t.aa(n),e})})},t.getUid=function(){return Oh(this)&&Oh(this).uid||null},t.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&Oh(this)&&Vc(Oh(this))},t.Ec=function(t){var e=this;V(this.m,function(n){n==t&&e.o--}),0>this.o&&(this.o=0),0==this.o&&Oh(this)&&Fc(Oh(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),Rh(this,this.i.then(function(){e.l||q(e.m,t)&&t(_h(e))}))},t.removeAuthTokenListener=function(t){B(this.m,function(e){return e==t})},t.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h).b.removeListener(ph("local"),t.a,this.ma),this.a&&(sc(this.a,this),bc(this.a.b)),Promise.resolve()},t.$b=function(t){return Rh(this,function(t,e){return Ps(t,as,{identifier:e,continueUri:Ei()?ei():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},t.qc=function(t){return!!mo(t)},t.lb=function(t,e){var n=this;return Rh(this,Zt().then(function(){var t=new fr(e);if(!t.c)throw new Qi("argument-error",vr+" must be true when sending sign in link to email");return Tr(t)}).then(function(e){return n.b.lb(t,e)}).then(function(){}))},t.Uc=function(t){return this.Ma(t).then(function(t){return t.data.email})},t.ab=function(t,e){return Rh(this,this.b.ab(t,e).then(function(){}))},t.Ma=function(t){return Rh(this,this.b.Ma(t).then(function(t){return new Bi(t)}))},t.Ya=function(t){return Rh(this,this.b.Ya(t).then(function(){}))},t.kb=function(t,e){var n=this;return Rh(this,Zt().then(function(){return void 0===e||J(e)?{}:Tr(new fr(e))}).then(function(e){return n.b.kb(t,e)}).then(function(){}))},t.Kc=function(t,e){return Rh(this,kc(this,t,e,E(this.Sa,this)))},t.Jc=function(t,e){var n=this;return Rh(this,Zt().then(function(){var i=e||ei(),r=vo(t,i);if(!(i=mo(i)))throw new Qi("argument-error","Invalid email link!");if(i.tenantId!==n.R())throw new Qi("tenant-id-mismatch");return n.Sa(r)}))},Ch.prototype.render=function(){},Ch.prototype.reset=function(){},Ch.prototype.getResponse=function(){},Ch.prototype.execute=function(){};var Lh=null;function xh(t,e){return(e=Mh(e))&&t.a[e]||null}function Mh(t){return(t=void 0===t?1e12:t)?t.toString():null}function jh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Bn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Je(this.f,"click",this.i)}function Uh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Vh(){}Dh.prototype.render=function(t,e){return this.a[this.b.toString()]=new jh(t,e),this.b++},Dh.prototype.reset=function(t){var e=xh(this,t);t=Mh(t),e&&t&&(e.delete(),delete this.a[t])},Dh.prototype.getResponse=function(t){return(t=xh(this,t))?t.getResponse():null},Dh.prototype.execute=function(t){(t=xh(this,t))&&t.execute()},jh.prototype.getResponse=function(){return Uh(this),this.b},jh.prototype.execute=function(){Uh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},jh.prototype.delete=function(){Uh(this),this.g=!0,clearTimeout(this.a),this.a=null,$e(this.f,"click",this.i)},Vh.prototype.g=function(){return Lh||(Lh=new Dh),Zt(Lh)},Vh.prototype.c=function(){};var Fh=null;function Kh(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var qh=new Z(et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Hh=new Ci(3e4,6e4);Kh.prototype.g=function(t){var e=this;return new Gt(function(n,i){var r=setTimeout(function(){i(new Qi("network-request-failed"))},Hh.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(r),n(s.grecaptcha)}else clearTimeout(r),i(new Qi("internal-error"));delete s[e.a]},Zt(Sa(ot(qh,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(r),i(new Qi("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),n(s.grecaptcha))})},Kh.prototype.c=function(){this.b--};var Bh=null;function Gh(t,e,n,i,r,o,a){if(Fi(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,a?(Fh||(Fh=new Vh),a=Fh):(Bh||(Bh=new Kh),a=Bh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Jh])throw new Qi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Yh],!s.document)throw new Qi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Bn(e)||!this.i&&Bn(e).hasChildNodes())throw new Qi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Da(t,o||null,r||null),this.v=i||function(){return null};var u=this;this.l=[];var c=this.a[Wh];this.a[Wh]=function(t){if(zh(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=wi(c,s);"function"==typeof e&&e(t)}};var h=this.a[Xh];this.a[Xh]=function(){if(zh(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=wi(h,s);"function"==typeof t&&t()}}}var Wh="callback",Xh="expired-callback",Jh="sitekey",Yh="size";function zh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function $h(t,e){return t.h.push(e),e.ka(function(){H(t.h,e)}),e}function Zh(t){if(t.B)throw new Qi("internal-error","RecaptchaVerifier instance has been destroyed.")}function Qh(t,n,i){var r=!1;try{this.b=i||e.app()}catch(t){throw new Qi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Qi("invalid-api-key");i=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ca()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}a=e.SDK_VERSION?bi(e.SDK_VERSION,a):null,Gh.call(this,i,t,n,function(){try{var t=o.b.auth().ha()}catch(e){t=null}return t},a,Rr(_r),r)}function tl(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Qi("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].N(n[r])&&!o){if(e=e[r],0>r||r>=el.length)throw new Qi("internal-error","Argument validator received an unsupported number of arguments.");n=el[r],i=(i?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}i=null}}if(i)throw new Qi("argument-error",t+" failed: "+i)}(t=Gh.prototype).Da=function(){var t=this;return this.f?this.f:this.f=$h(this,Zt().then(function(){if(Ei()&&!li())return ui();throw new Qi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.m.g(t.v())}).then(function(e){return t.g=e,Ps(t.o,ms,{})}).then(function(e){t.a[Jh]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){Zh(this);var t=this;return $h(this,this.Da().then(function(){if(null===t.c){var e=t.u;if(!t.i){var n=Bn(e);e=Xn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Zh(this);var t=this;return $h(this,this.render().then(function(e){return new Gt(function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){B(t.l,function(t){return t==e})}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Zh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Zh(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Bn(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},S(Qh,Gh);var el="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function nl(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:u}}function il(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:c}}function rl(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:b}}function ol(t,e){return{name:t||"",M:"a function",optional:!!e,N:g}}function al(t,e){return{name:t||"",M:"null",optional:!!e,N:p}}function sl(t){return{name:t?t+"Credential":"credential",M:t?"a valid "+t+" credential":"a valid credential",optional:!1,N:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.na||!n)}}}function ul(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&u(t.type)&&g(t.verify))}}}function cl(t,e,n,i){return{name:n||"",M:t.M+" or "+e.M,optional:!!i,N:function(n){return t.N(n)||e.N(n)}}}function hl(t,e){for(var n in e){var i=e[n].name;t[i]=dl(i,t[n],e[n].j)}}function ll(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:k(function(t){return this[t]},n),set:k(function(t,e,n,i){tl(t,[n],[i],!0),this[e]=i},i,n,e[n].Za),enumerable:!0})}}function fl(t,e,n,i){t[e]=dl(e,n,i)}function dl(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return tl(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}hl(yh.prototype,{Ya:{name:"applyActionCode",j:[nl("code")]},Ma:{name:"checkActionCode",j:[nl("code")]},ab:{name:"confirmPasswordReset",j:[nl("code"),nl("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[nl("email"),nl("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[nl("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[nl("emailLink")]},wc:{name:"onAuthStateChanged",j:[cl(rl(),ol(),"nextOrObserver"),ol("opt_error",!0),ol("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[cl(rl(),ol(),"nextOrObserver"),ol("opt_error",!0),ol("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[nl("email"),cl(rl("opt_actionCodeSettings",!0),al(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[nl("email"),rl("actionCodeSettings")]},mb:{name:"setPersistence",j:[nl("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[sl()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[sl()]},Hc:{name:"signInWithCustomToken",j:[nl("token")]},Ic:{name:"signInWithEmailAndPassword",j:[nl("email"),nl("password")]},Jc:{name:"signInWithEmailLink",j:[nl("email"),nl("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[nl("phoneNumber"),ul()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[cl({name:"user",M:"an instance of Firebase User",optional:!1,N:function(t){return!!(t&&t instanceof Lc)}},al(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[nl(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[nl("code")]}}),ll(yh.prototype,{lc:{name:"languageCode",Za:cl(nl(),al(),"languageCode")},ti:{name:"tenantId",Za:cl(nl(),al(),"tenantId")}}),yh.Persistence=Au,yh.Persistence.LOCAL="local",yh.Persistence.SESSION="session",yh.Persistence.NONE="none",hl(Lc.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[il("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[il("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[sl()]},fb:{name:"linkWithCredential",j:[sl()]},sc:{name:"linkWithPhoneNumber",j:[nl("phoneNumber"),ul()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[sl()]},hb:{name:"reauthenticateWithCredential",j:[sl()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[nl("phoneNumber"),ul()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[cl(rl("opt_actionCodeSettings",!0),al(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[nl(null,!0)]},Qc:{name:"unlink",j:[nl("provider")]},rb:{name:"updateEmail",j:[nl("email")]},sb:{name:"updatePassword",j:[nl("password")]},Sc:{name:"updatePhoneNumber",j:[sl("phone")]},tb:{name:"updateProfile",j:[rl("profile")]}}),hl(Dh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hl(Ch.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),hl(Gt.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),ll(Tc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:il("appVerificationDisabledForTesting")}}),hl(Ec.prototype,{confirm:{name:"confirm",j:[nl("verificationCode")]}}),fl(Wr,"fromJSON",function(t){t=u(t)?JSON.parse(t):t;for(var e,n=[Qr,fo,bo,zr],i=0;i<n.length;i++)if(e=n[i](t))return e;return null},[cl(nl(),rl(),"json")]),fl(po,"credential",function(t,e){return new lo(t,e)},[nl("email"),nl("password")]),hl(lo.prototype,{A:{name:"toJSON",j:[nl(null,!0)]}}),hl(io.prototype,{ya:{name:"addScope",j:[nl("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),fl(io,"credential",ro,[cl(nl(),rl(),"token")]),fl(po,"credentialWithLink",vo,[nl("email"),nl("emailLink")]),hl(oo.prototype,{ya:{name:"addScope",j:[nl("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),fl(oo,"credential",ao,[cl(nl(),rl(),"token")]),hl(so.prototype,{ya:{name:"addScope",j:[nl("scope")]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),fl(so,"credential",uo,[cl(nl(),cl(rl(),al()),"idToken"),cl(nl(),al(),"accessToken",!0)]),hl(co.prototype,{Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),fl(co,"credential",ho,[cl(nl(),rl(),"token"),nl("secret",!0)]),hl(no.prototype,{ya:{name:"addScope",j:[nl("scope")]},credential:{name:"credential",j:[cl(nl(),cl(rl(),al()),"optionsOrIdToken"),cl(nl(),al(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[rl("customOAuthParameters")]}}),hl($r.prototype,{A:{name:"toJSON",j:[nl(null,!0)]}}),hl(Jr.prototype,{A:{name:"toJSON",j:[nl(null,!0)]}}),fl(wo,"credential",Io,[nl("verificationId"),nl("verificationCode")]),hl(wo.prototype,{Wa:{name:"verifyPhoneNumber",j:[nl("phoneNumber"),ul()]}}),hl(go.prototype,{A:{name:"toJSON",j:[nl(null,!0)]}}),hl(Qi.prototype,{toJSON:{name:"toJSON",j:[nl(null,!0)]}}),hl(Po.prototype,{toJSON:{name:"toJSON",j:[nl(null,!0)]}}),hl(_o.prototype,{toJSON:{name:"toJSON",j:[nl(null,!0)]}}),hl(Qh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),fl(ir,"parseLink",lr,[nl("link")]),function(){if(void 0===e||!e.INTERNAL||!e.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Gi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:yh,AuthCredential:Wr,Error:Qi};fl(t,"EmailAuthProvider",po,[]),fl(t,"FacebookAuthProvider",io,[]),fl(t,"GithubAuthProvider",oo,[]),fl(t,"GoogleAuthProvider",so,[]),fl(t,"TwitterAuthProvider",co,[]),fl(t,"OAuthProvider",no,[nl("providerId")]),fl(t,"SAMLAuthProvider",eo,[nl("providerId")]),fl(t,"PhoneAuthProvider",wo,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof yh)}}]),fl(t,"RecaptchaVerifier",Qh,[cl(nl(),{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),rl("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof e.app.App)}}]),fl(t,"ActionCodeURL",ir,[]),e.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new yh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),e.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:E((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:E(t.cc,t),addAuthTokenListener:E(t.Wb,t),removeAuthTokenListener:E(t.Ec,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),e.registerVersion("@firebase/auth","0.13.4"),e.INTERNAL.extendNamespace({User:Lc})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"@firebase/app":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/app/dist/index.cjs.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/component/dist/index.cjs.js":[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib=require("tslib"),util=require("@firebase/util"),Component=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),DEFAULT_ENTRY_NAME="[DEFAULT]",Provider=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=DEFAULT_ENTRY_NAME);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new util.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=tslib.__assign({identifier:DEFAULT_ENTRY_NAME,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,isComponentEager(t))try{this.getOrInitializeService(DEFAULT_ENTRY_NAME)}catch(t){}try{for(var r=tslib.__values(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=tslib.__read(i.value,2),s=o[0],a=o[1],c=this.normalizeInstanceIdentifier(s);try{var p=this.getOrInitializeService(c);a.resolve(p)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=DEFAULT_ENTRY_NAME),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return tslib.__awaiter(this,void 0,void 0,function(){var t;return tslib.__generator(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,normalizeIdentifierForFactory(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:DEFAULT_ENTRY_NAME:t},t}();function normalizeIdentifierForFactory(t){return t===DEFAULT_ENTRY_NAME?void 0:t}function isComponentEager(t){return"EAGER"===t.instantiationMode}var ComponentContainer=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Provider(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.Component=Component,exports.ComponentContainer=ComponentContainer,exports.Provider=Provider;

},{"@firebase/util":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/util/dist/index.cjs.js","tslib":"/Users/rabbit/projects/buntimer2020-github/node_modules/tslib/tslib.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/firestore/dist/index.cjs.js":[function(require,module,exports){
(function (process){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var LogLevel,firebase=_interopDefault(require("@firebase/app")),tslib=require("tslib"),logger=require("@firebase/logger"),util=require("@firebase/util"),component=require("@firebase/component"),webchannelWrapper=require("@firebase/webchannel-wrapper"),SDK_VERSION=firebase.SDK_VERSION,logClient=new logger.Logger("@firebase/firestore");function getLogLevel(){return logClient.logLevel===logger.LogLevel.DEBUG?LogLevel.DEBUG:logClient.logLevel===logger.LogLevel.SILENT?LogLevel.SILENT:LogLevel.ERROR}function setLogLevel(e){switch(e){case LogLevel.DEBUG:logClient.logLevel=logger.LogLevel.DEBUG;break;case LogLevel.ERROR:logClient.logLevel=logger.LogLevel.ERROR;break;case LogLevel.SILENT:logClient.logLevel=logger.LogLevel.SILENT;break;default:logClient.error("Firestore ("+SDK_VERSION+"): Invalid value passed to `setLogLevel`")}}function debug(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(logClient.logLevel<=logger.LogLevel.DEBUG){var i=r.map(argToString);logClient.debug.apply(logClient,tslib.__spreadArrays(["Firestore ("+SDK_VERSION+") ["+e+"]: "+t],i))}}function error(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(logClient.logLevel<=logger.LogLevel.ERROR){var n=t.map(argToString);logClient.error.apply(logClient,tslib.__spreadArrays(["Firestore ("+SDK_VERSION+"): "+e],n))}}function argToString(e){if("string"==typeof e)return e;var t=PlatformSupport.getPlatform();try{return t.formatJSON(e)}catch(t){return e}}function fail(e){var t="FIRESTORE ("+SDK_VERSION+") INTERNAL ASSERTION FAILED: "+e;throw error(t),new Error(t)}function assert(e,t){e||fail(t)}!function(e){e[e.DEBUG=0]="DEBUG",e[e.ERROR=1]="ERROR",e[e.SILENT=2]="SILENT"}(LogLevel||(LogLevel={}));var PlatformSupport=function(){function e(){}return e.setPlatform=function(t){e.platform&&fail("Platform already defined"),e.platform=t},e.getPlatform=function(){return e.platform||fail("Platform not set"),e.platform},e}();function emptyByteString(){return PlatformSupport.getPlatform().emptyByteString}var Code={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},FirestoreError=function(e){function t(t,r){var n=e.call(this,r)||this;return n.code=t,n.message=r,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}return tslib.__extends(t,e),t}(Error);function makeConstructorPrivate(e,t){function r(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new FirestoreError(Code.INVALID_ARGUMENT,e)}for(var n in r.prototype=e.prototype,e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}function contains(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function defaulted(e,t){return void 0!==e?e:t}function forEachNumber(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Number(r);isNaN(n)||t(n,e[r])}}function values(e){var t=[];return forEach(e,function(e,r){return t.push(r)}),t}function forEach(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function isEmpty(e){for(var t in assert(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function shallowCopy(e){assert(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function validateNoArgs(e,t){if(0!==t.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+formatPlural(t.length,"argument")+".")}function validateExactNumberOfArgs(e,t,r){if(t.length!==r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires "+formatPlural(r,"argument")+", but was called with "+formatPlural(t.length,"argument")+".")}function validateAtLeastNumberOfArgs(e,t,r){if(t.length<r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires at least "+formatPlural(r,"argument")+", but was called with "+formatPlural(t.length,"argument")+".")}function validateBetweenNumberOfArgs(e,t,r,n){if(t.length<r||t.length>n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires between "+r+" and "+n+" arguments, but was called with "+formatPlural(t.length,"argument")+".")}function validateNamedArrayAtLeastNumberOfElements(e,t,r,n){if(!(t instanceof Array)||t.length<n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+r+" argument to be an array with at least "+formatPlural(n,"element")+".")}function validateArgType(e,t,r,n){validateType(e,t,ordinal(r)+" argument",n)}function validateOptionalArgType(e,t,r,n){void 0!==n&&validateArgType(e,t,r,n)}function validateNamedType(e,t,r,n){validateType(e,t,r+" option",n)}function validateNamedOptionalType(e,t,r,n){void 0!==n&&validateNamedType(e,t,r,n)}function validateArrayElements(e,t,r,n,i){if(!(n instanceof Array))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+t+" option to be an array, but it was: "+valueDescription(n));for(var o=0;o<n.length;++o)if(!i(n[o]))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires all "+t+" elements to be "+r+", but the value at index "+o+" was: "+valueDescription(n[o]))}function validateOptionalArrayElements(e,t,r,n,i){void 0!==n&&validateArrayElements(e,t,r,n,i)}function validateNamedPropertyEquals(e,t,r,n,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===n)return;o.push(valueDescription(u))}var c=valueDescription(n);throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+r+'". Acceptable values: '+o.join(", "))}function validateNamedOptionalPropertyEquals(e,t,r,n,i){void 0!==n&&validateNamedPropertyEquals(e,t,r,n,i)}function validateStringEnum(e,t,r,n){if(!t.some(function(e){return e===n}))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid value "+valueDescription(n)+" provided to function "+e+"() for its "+ordinal(r)+" argument. Acceptable values: "+t.join(", "))}function validateType(e,t,r,n){if(!("object"===t?isPlainObject(n):"non-empty string"===t?"string"==typeof n&&""!==n:typeof n===t)){var i=valueDescription(n);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+r+" to be of type "+t+", but it was: "+i)}}function isPlainObject(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function valueDescription(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=tryGetCustomObjectType(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":fail("Unknown wrong type: "+typeof e)}function tryGetCustomObjectType(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}function validateDefined(e,t,r){if(void 0===r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+ordinal(t)+" argument, but it was undefined.")}function validateOptionNames(e,t,r){forEach(t,function(t,n){if(r.indexOf(t)<0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+r.join(", "))})}function invalidClassError(e,t,r,n){var i=valueDescription(n);return new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+ordinal(r)+" argument to be a "+t+", but it was: "+i)}function validatePositiveNumber(e,t,r){if(r<=0)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function "'+e+'()" requires its '+ordinal(t)+" argument to be a positive number, but it was: "+r+".")}function ordinal(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function formatPlural(e,t){return e+" "+t+(1===e?"":"s")}var AutoId=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",r=0;r<20;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return assert(20===t.length,"Invalid auto ID: "+t),t},e}();function primitiveComparator(e,t){return e<t?-1:e>t?1:0}function equals(e,t){return null!=e?!(!t||!e.isEqual(t)):e===t}function arrayEquals(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].isEqual(t[r]))return!1;return!0}function immediateSuccessor(e){return e+"\0"}function assertUint8ArrayAvailable(){if("undefined"==typeof Uint8Array)throw new FirestoreError(Code.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function assertBase64Available(){if(!PlatformSupport.getPlatform().base64Available)throw new FirestoreError(Code.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var TimerId,Blob=function(){function e(e){assertBase64Available(),this._binaryString=e}return e.fromBase64String=function(t){validateExactNumberOfArgs("Blob.fromBase64String",arguments,1),validateArgType("Blob.fromBase64String","string",1,t),assertBase64Available();try{return new e(PlatformSupport.getPlatform().atob(t))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},e.fromUint8Array=function(t){if(validateExactNumberOfArgs("Blob.fromUint8Array",arguments,1),assertUint8ArrayAvailable(),!(t instanceof Uint8Array))throw invalidClassError("Blob.fromUint8Array","Uint8Array",1,t);return new e(Array.prototype.map.call(t,function(e){return String.fromCharCode(e)}).join(""))},e.prototype.toBase64=function(){return validateExactNumberOfArgs("Blob.toBase64",arguments,0),assertBase64Available(),PlatformSupport.getPlatform().btoa(this._binaryString)},e.prototype.toUint8Array=function(){validateExactNumberOfArgs("Blob.toUint8Array",arguments,0),assertUint8ArrayAvailable();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._binaryString===e._binaryString},e.prototype._compareTo=function(e){return primitiveComparator(this._binaryString,e._binaryString)},e}(),PublicBlob=makeConstructorPrivate(Blob,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),DatabaseInfo=function(){return function(e,t,r,n,i){this.databaseId=e,this.persistenceKey=t,this.host=r,this.ssl=n,this.forceLongPolling=i}}(),DEFAULT_DATABASE_NAME="(default)",DatabaseId=function(){function e(e,t){this.projectId=e,this.database=t||DEFAULT_DATABASE_NAME}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database===DEFAULT_DATABASE_NAME},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.compareTo=function(e){return primitiveComparator(this.projectId,e.projectId)||primitiveComparator(this.database,e.database)},e}(),ListenSequence=function(){function e(e,t){var r=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return r.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}return e.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},e.INVALID=-1,e}(),DOCUMENT_KEY_NAME="__name__",BasePath=function(){function e(e,t,r){void 0===t?t=0:t>e.length&&fail("offset "+t+" out of range "+e.length),void 0===r?r=e.length-t:r>e.length-t&&fail("length "+r+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=r}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var r=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){r.push(e)}):r.push(t),this.construct(r)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return e=void 0===e?1:e,assert(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return assert(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return assert(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return assert(e<this.length,"Index out of range"),this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var r=Math.min(e.length,t.length),n=0;n<r;n++){var i=e.get(n),o=t.get(n);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),ResourcePath=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.construct=function(e,r,n){return new t(e,r,n)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(e.indexOf("//")>=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter(function(e){return e.length>0}))},t.EMPTY_PATH=new t([]),t}(BasePath),identifierRegExp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,FieldPath=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.construct=function(e,r,n){return new t(e,r,n)},t.isValidIdentifier=function(e){return identifierRegExp.test(e)},t.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===DOCUMENT_KEY_NAME},t.keyField=function(){return new t([DOCUMENT_KEY_NAME])},t.fromServerFormat=function(e){for(var r=[],n="",i=0,o=function(){if(0===n.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");r.push(n),n=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new FirestoreError(Code.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(n+=s,i++):(o(),i++)}if(o(),a)throw new FirestoreError(Code.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(r)},t.EMPTY_PATH=new t([]),t}(BasePath),DocumentKey=function(){function e(t){this.path=t,assert(e.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}return e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===ResourcePath.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return ResourcePath.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new ResourcePath(t.slice()))},e.fromPathString=function(t){return new e(ResourcePath.fromString(t))},e.EMPTY=new e(new ResourcePath([])),e}(),Deferred=function(){return function(){var e=this;this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})}}();!function(e){e.All="all",e.ListenStreamIdle="listen_stream_idle",e.ListenStreamConnectionBackoff="listen_stream_connection_backoff",e.WriteStreamIdle="write_stream_idle",e.WriteStreamConnectionBackoff="write_stream_connection_backoff",e.OnlineStateTimeout="online_state_timeout",e.ClientMetadataRefresh="client_metadata_refresh",e.LruGarbageCollection="lru_garbage_collection",e.RetryTransaction="retry_transaction"}(TimerId||(TimerId={}));var DelayedOperation=function(){function e(e,t,r,n,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=i,this.deferred=new Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return e.createAndSchedule=function(t,r,n,i,o){var a=new e(t,r,Date.now()+n,i,o);return a.start(n),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(Code.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}(),AsyncQueue=function(){function e(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenAfterShutdown=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueEvenAfterShutdown=function(e){return this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueAndInitiateShutdown=function(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){switch(t.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(e){}):this.enqueueInternal(e)},e.prototype.enqueueInternal=function(e){var t=this,r=this.tail.then(function(){return t.operationInProgress=!0,e().catch(function(e){t.failure=e,t.operationInProgress=!1;var r=e.stack||e.message||"";throw error("INTERNAL UNHANDLED ERROR: ",r),r.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw e},0),e}).then(function(e){return t.operationInProgress=!1,e})});return this.tail=r,r},e.prototype.enqueueAfterDelay=function(e,t,r){var n=this;this.verifyNotFailed(),assert(t>=0,"Attempted to schedule an operation with a negative delay of "+t),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);var i=DelayedOperation.createAndSchedule(this,e,t,r,function(e){return n.removeDelayedOperation(e)});return this.delayedOperations.push(i),i},e.prototype.verifyNotFailed=function(){this.failure&&fail("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){assert(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueueEvenAfterShutdown(function(){return Promise.resolve()})},e.prototype.containsDelayedOperation=function(e){for(var t=0,r=this.delayedOperations;t<r.length;t++){if(r[t].timerId===e)return!0}return!1},e.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then(function(){assert(e===TimerId.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var r=0,n=t.delayedOperations;r<n.length;r++){var i=n[r];if(i.skipDelay(),e!==TimerId.All&&i.timerId===e)break}return t.drain()})},e.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);assert(t>=0,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}(),escapeChar="",encodedSeparatorChar="",encodedNul="",encodedEscape="";function encode(e){for(var t="",r=0;r<e.length;r++)t.length>0&&(t=encodeSeparator(t)),t=encodeSegment(e.get(r),t);return encodeSeparator(t)}function encodeSegment(e,t){for(var r=t,n=e.length,i=0;i<n;i++){var o=e.charAt(i);switch(o){case"\0":r+=escapeChar+encodedNul;break;case escapeChar:r+=escapeChar+encodedEscape;break;default:r+=o}}return r}function encodeSeparator(e){return e+escapeChar+encodedSeparatorChar}function decode(e){var t=e.length;if(assert(t>=2,"Invalid path "+e),2===t)return assert(e.charAt(0)===escapeChar&&e.charAt(1)===encodedSeparatorChar,"Non-empty path "+e+" had length 2"),ResourcePath.EMPTY_PATH;for(var r=t-2,n=[],i="",o=0;o<t;){var a=e.indexOf(escapeChar,o);switch((a<0||a>r)&&fail('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case encodedSeparatorChar:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),n.push(u);break;case encodedNul:i+=e.substring(o,a),i+="\0";break;case encodedEscape:i+=e.substring(o,a+1);break;default:fail('Invalid encoded resource path: "'+e+'"')}o=a+2}return new ResourcePath(n)}var Timestamp=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var r=Math.floor(t/1e3);return new e(r,1e6*(t-1e3*r))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?primitiveComparator(this.nanoseconds,e.nanoseconds):primitiveComparator(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e}(),SnapshotVersion=function(){function e(e){this.timestamp=e}return e.fromMicroseconds=function(t){var r=Math.floor(t/1e6);return new e(new Timestamp(r,t%1e6*1e3))},e.fromTimestamp=function(t){return new e(t)},e.forDeletedDoc=function(){return e.MIN},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e.MIN=new e(new Timestamp(0,0)),e}(),SortedMap=function(){function e(e,t){this.comparator=e,this.root=t||LLRBNode.EMPTY}return e.prototype.insert=function(t,r){return new e(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,r=this.root;!r.isEmpty();){var n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal(function(t,r){return e(t,r),!1})},e.prototype.toString=function(){var e=[];return this.inorderTraversal(function(t,r){return e.push(t+":"+r),!1}),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new SortedMapIterator(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new SortedMapIterator(this.root,e,this.comparator,!0)},e}(),SortedMapIterator=function(){function e(e,t,r,n){this.isReverse=n,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?r(e.key,t):1,n&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){assert(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),LLRBNode=function(){function e(t,r,n,i,o){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,r,n,i,o){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,r){var n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===r(t,i.key)){if(i.right.isEmpty())return e.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw fail("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw fail("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw fail("Black depths differ");return e+(this.isRed()?0:1)},e.EMPTY=null,e.RED=!0,e.BLACK=!1,e}(),LLRBEmptyNode=function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw fail("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw fail("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw fail("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw fail("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw fail("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new LLRBNode(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}();LLRBNode.EMPTY=new LLRBEmptyNode;var SortedSet=function(){function e(e){this.comparator=e,this.data=new SortedMap(this.comparator)}return e.fromMapKeys=function(t){var r=new e(t.comparator);return t.forEach(function(e){r=r.add(e)}),r},e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal(function(t,r){return e(t),!1})},e.prototype.forEachInRange=function(e,t){for(var r=this.data.getIteratorFrom(e[0]);r.hasNext();){var n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}},e.prototype.forEachWhile=function(e,t){var r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();){if(!e(r.getNext().key))return}},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new SortedSetIterator(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new SortedSetIterator(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return e.forEach(function(e){t=t.add(e)}),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var r=this.data.getIterator(),n=t.data.getIterator();r.hasNext();){var i=r.getNext().key,o=n.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},e.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var r=new e(this.comparator);return r.data=t,r},e}(),SortedSetIterator=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),EMPTY_MAYBE_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator);function maybeDocumentMap(){return EMPTY_MAYBE_DOCUMENT_MAP}function nullableMaybeDocumentMap(){return maybeDocumentMap()}var EMPTY_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator);function documentMap(){return EMPTY_DOCUMENT_MAP}var EMPTY_DOCUMENT_VERSION_MAP=new SortedMap(DocumentKey.comparator);function documentVersionMap(){return EMPTY_DOCUMENT_VERSION_MAP}var EMPTY_DOCUMENT_KEY_SET=new SortedSet(DocumentKey.comparator);function documentKeySet(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=EMPTY_DOCUMENT_KEY_SET,n=0,i=e;n<i.length;n++){var o=i[n];r=r.add(o)}return r}var EMPTY_TARGET_ID_SET=new SortedSet(primitiveComparator);function targetIdSet(){return EMPTY_TARGET_ID_SET}var BATCHID_UNKNOWN=-1,MutationBatch=function(){function e(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n,assert(n.length>0,"Cannot create an empty mutation batch")}return e.prototype.applyToRemoteDocument=function(e,t,r){t&&assert(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var n=r.mutationResults;assert(n.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+n.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(e)){var a=n[i];t=o.applyToRemoteDocument(t,a)}}return t},e.prototype.applyToLocalView=function(e,t){t&&assert(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var r=0,n=this.baseMutations;r<n.length;r++){(s=n[r]).key.isEqual(e)&&(t=s.applyToLocalView(t,t,this.localWriteTime))}for(var i=t,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(e)&&(t=s.applyToLocalView(t,i,this.localWriteTime))}return t},e.prototype.applyToLocalDocumentSet=function(e){var t=this,r=e;return this.mutations.forEach(function(n){var i=t.applyToLocalView(n.key,e.get(n.key));i&&(r=r.insert(n.key,i))}),r},e.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},documentKeySet())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&arrayEquals(this.mutations,e.mutations)&&arrayEquals(this.baseMutations,e.baseMutations)},e}(),MutationBatchResult=function(){function e(e,t,r,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.streamToken=n,this.docVersions=i}return e.from=function(t,r,n,i){assert(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var o=documentVersionMap(),a=t.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,n[s].version);return new e(t,r,n,i,o)},e}(),PersistencePromise=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,r){var n=this;return this.callbackAttached&&fail("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){n.nextCallback=function(r){n.wrapSuccess(t,r).next(e,i)},n.catchCallback=function(t){n.wrapFailure(r,t).next(e,i)}})},e.prototype.toPromise=function(){var e=this;return new Promise(function(t,r){e.next(t,r)})},e.prototype.wrapUserFunction=function(t){try{var r=t();return r instanceof e?r:e.resolve(r)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,r){return t?this.wrapUserFunction(function(){return t(r)}):e.resolve(r)},e.prototype.wrapFailure=function(t,r){return t?this.wrapUserFunction(function(){return t(r)}):e.reject(r)},e.resolve=function(t){return new e(function(e,r){e(t)})},e.reject=function(t){return new e(function(e,r){r(t)})},e.waitFor=function(t){return new e(function(e,r){var n=0,i=0,o=!1;t.forEach(function(t){++n,t.next(function(){++i,o&&i===n&&e()},function(e){return r(e)})}),o=!0,i===n&&e()})},e.or=function(t){for(var r=e.resolve(!1),n=function(t){r=r.next(function(r){return r?e.resolve(r):t()})},i=0,o=t;i<o.length;i++){n(o[i])}return r},e.forEach=function(e,t){var r=this,n=[];return e.forEach(function(e,i){n.push(t.call(r,e,i))}),this.waitFor(n)},e}(),LOG_TAG="SimpleDb",TRANSACTION_RETRY_COUNT=3,SimpleDb=function(){function e(t){this.db=t,12.2===e.getIOSVersion(util.getUA())&&error("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,r,n){return assert(e.isAvailable(),"IndexedDB not supported in current environment."),debug(LOG_TAG,"Opening database:",t),new PersistencePromise(function(i,o){var a=window.indexedDB.open(t,r);a.onsuccess=function(t){var r=t.target.result;i(new e(r))},a.onblocked=function(){o(new FirestoreError(Code.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var t=e.target.error;"VersionError"===t.name?o(new FirestoreError(Code.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(t)},a.onupgradeneeded=function(e){debug(LOG_TAG,'Database "'+t+'" requires upgrade from version:',e.oldVersion);var r=e.target.result;n.createOrUpgrade(r,a.transaction,e.oldVersion,SCHEMA_VERSION).next(function(){debug(LOG_TAG,"Database upgrade to version "+SCHEMA_VERSION+" complete")})}}).toPromise()},e.delete=function(e){return debug(LOG_TAG,"Removing database:",e),wrapRequest(window.indexedDB.deleteDatabase(e)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(e.isMockPersistence())return!0;if(void 0===window.navigator)return!1;var t=util.getUA(),r=e.getIOSVersion(t),n=0<r&&r<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||o)},e.isMockPersistence=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.USE_MOCK_PERSISTENCE)},e.getStore=function(e,t){return e.store(t)},e.getIOSVersion=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)},e.getAndroidVersion=function(e){var t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)},e.prototype.setVersionChangeListener=function(e){this.db.onversionchange=function(t){return e(t)}},e.prototype.runTransaction=function(e,t,r){return tslib.__awaiter(this,void 0,void 0,function(){var n,i,o,a,s,u;return tslib.__generator(this,function(c){switch(c.label){case 0:n=e.startsWith("readonly"),i=e.endsWith("idempotent"),o=0,a=function(){var e,a,u,c;return tslib.__generator(this,function(l){switch(l.label){case 0:++o,e=SimpleDbTransaction.open(s.db,n?"readonly":"readwrite",t),l.label=1;case 1:return l.trys.push([1,3,,4]),(a=r(e).catch(function(t){return e.abort(t),PersistencePromise.reject(t)}).toPromise()).catch(function(){}),[4,e.completionPromise];case 2:return l.sent(),[2,{value:a}];case 3:return u=l.sent(),c=i&&"FirebaseError"!==u.name&&o<TRANSACTION_RETRY_COUNT,debug(LOG_TAG,"Transaction failed with error: %s. Retrying: %s.",u.message,c),c?[3,4]:[2,{value:Promise.reject(u)}];case 4:return[2]}})},s=this,c.label=1;case 1:return[5,a()];case 2:return"object"==typeof(u=c.sent())?[2,u.value]:[3,1];case 3:return[2]}})})},e.prototype.close=function(){this.db.close()},e}(),IterationController=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return wrapRequest(this.dbCursor.delete())},e}(),SimpleDbTransaction=function(){function e(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new Deferred,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){var r=checkForAndReportiOSError(e.target.error);t.completionDeferred.reject(r)}}return e.open=function(t,r,n){return new e(t.transaction(n,r))},Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(debug(LOG_TAG,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return assert(!!t,"Object store not part of transaction: "+e),new SimpleDbStore(t)},e}(),SimpleDbStore=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var r;return void 0!==t?(debug(LOG_TAG,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(debug(LOG_TAG,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),wrapRequest(r)},e.prototype.add=function(e){return debug(LOG_TAG,"ADD",this.store.name,e,e),wrapRequest(this.store.add(e))},e.prototype.get=function(e){var t=this;return wrapRequest(this.store.get(e)).next(function(r){return void 0===r&&(r=null),debug(LOG_TAG,"GET",t.store.name,e,r),r})},e.prototype.delete=function(e){return debug(LOG_TAG,"DELETE",this.store.name,e),wrapRequest(this.store.delete(e))},e.prototype.count=function(){return debug(LOG_TAG,"COUNT",this.store.name),wrapRequest(this.store.count())},e.prototype.loadAll=function(e,t){var r=this.cursor(this.options(e,t)),n=[];return this.iterateCursor(r,function(e,t){n.push(t)}).next(function(){return n})},e.prototype.deleteAll=function(e,t){debug(LOG_TAG,"DELETE ALL",this.store.name);var r=this.options(e,t);r.keysOnly=!1;var n=this.cursor(r);return this.iterateCursor(n,function(e,t,r){return r.delete()})},e.prototype.iterate=function(e,t){var r;t?r=e:(r={},t=e);var n=this.cursor(r);return this.iterateCursor(n,t)},e.prototype.iterateSerial=function(e){var t=this.cursor({});return new PersistencePromise(function(r,n){t.onerror=function(e){var t=checkForAndReportiOSError(e.target.error);n(t)},t.onsuccess=function(t){var n=t.target.result;n?e(n.primaryKey,n.value).next(function(e){e?n.continue():r()}):r()}})},e.prototype.iterateCursor=function(e,t){var r=[];return new PersistencePromise(function(n,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new IterationController(i),a=t(i.primaryKey,i.value,o);if(a instanceof PersistencePromise){var s=a.catch(function(e){return o.done(),PersistencePromise.reject(e)});r.push(s)}o.isDone?n():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else n()}}).next(function(){return PersistencePromise.waitFor(r)})},e.prototype.options=function(e,t){var r=void 0;return void 0!==e&&("string"==typeof e?r=e:(assert(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:r,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var r=this.store.index(e.index);return e.keysOnly?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function wrapRequest(e){return new PersistencePromise(function(t,r){e.onsuccess=function(e){var r=e.target.result;t(r)},e.onerror=function(e){var t=checkForAndReportiOSError(e.target.error);r(t)}})}var reportedIOSError=!1;function checkForAndReportiOSError(e){var t=SimpleDb.getIOSVersion(util.getUA());if(t>=12.2&&t<13){var r="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(r)>=0){var n=new FirestoreError("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+r+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return reportedIOSError||(reportedIOSError=!0,setTimeout(function(){throw n},0)),n}}return e}var IndexedDbMutationQueue=function(){function e(e,t,r,n){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=n,this.documentKeysByBatchId={}}return e.forUser=function(t,r,n,i){return assert(""!==t.uid,"UserID must not be an empty string."),new e(t.isAuthenticated()?t.uid:"",r,n,i)},e.prototype.checkEmpty=function(e){var t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mutationsStore(e).iterate({index:DbMutationBatch.userMutationsIndex,range:r},function(e,r,n){t=!1,n.done()}).next(function(){return t})},e.prototype.acknowledgeBatch=function(e,t,r){return this.getMutationQueueMetadata(e).next(function(t){return t.lastStreamToken=convertStreamToken(r),mutationQueuesStore(e).put(t)})},e.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next(function(e){return e.lastStreamToken})},e.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next(function(r){return r.lastStreamToken=convertStreamToken(t),mutationQueuesStore(e).put(r)})},e.prototype.addMutationBatch=function(e,t,r,n){var i=this,o=documentMutationsStore(e),a=mutationsStore(e);return a.add({}).next(function(s){assert("number"==typeof s,"Auto-generated key is not a number");for(var u=new MutationBatch(s,t,r,n),c=i.serializer.toDbMutationBatch(i.userId,u),l=[],h=new SortedSet(function(e,t){return primitiveComparator(e.canonicalString(),t.canonicalString())}),d=0,f=n;d<f.length;d++){var p=f[d],m=DbDocumentMutation.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(m,DbDocumentMutation.PLACEHOLDER))}return h.forEach(function(t){l.push(i.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.documentKeysByBatchId[s]=u.keys()}),PersistencePromise.waitFor(l).next(function(){return u})})},e.prototype.lookupMutationBatch=function(e,t){var r=this;return mutationsStore(e).get(t).next(function(e){return e?(assert(e.userId===r.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.serializer.fromDbMutationBatch(e)):null})},e.prototype.lookupMutationKeys=function(e,t){var r=this;return this.documentKeysByBatchId[t]?PersistencePromise.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var n=e.keys();return r.documentKeysByBatchId[t]=n,n}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var r=this,n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]),o=null;return mutationsStore(e).iterate({index:DbMutationBatch.userMutationsIndex,range:i},function(e,t,i){t.userId===r.userId&&(assert(t.batchId>=n,"Should have found mutation after "+n),o=r.serializer.fromDbMutationBatch(t)),i.done()}).next(function(){return o})},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=BATCHID_UNKNOWN;return mutationsStore(e).iterate({index:DbMutationBatch.userMutationsIndex,range:t,reverse:!0},function(e,t,n){r=t.batchId,n.done()}).next(function(){return r})},e.prototype.getAllMutationBatches=function(e){var t=this,r=IDBKeyRange.bound([this.userId,BATCHID_UNKNOWN],[this.userId,Number.POSITIVE_INFINITY]);return mutationsStore(e).loadAll(DbMutationBatch.userMutationsIndex,r).next(function(e){return e.map(function(e){return t.serializer.fromDbMutationBatch(e)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var r=this,n=DbDocumentMutation.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(n),o=[];return documentMutationsStore(e).iterate({range:i},function(n,i,a){var s=n[0],u=n[1],c=n[2],l=decode(u);if(s===r.userId&&t.path.isEqual(l))return mutationsStore(e).get(c).next(function(e){if(!e)throw fail("Dangling document-mutation reference found: "+n+" which points to "+c);assert(e.userId===r.userId,"Unexpected user '"+e.userId+"' for mutation batch "+c),o.push(r.serializer.fromDbMutationBatch(e))});a.done()}).next(function(){return o})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var r=this,n=new SortedSet(primitiveComparator),i=[];return t.forEach(function(t){var o=DbDocumentMutation.prefixForPath(r.userId,t.path),a=IDBKeyRange.lowerBound(o),s=documentMutationsStore(e).iterate({range:a},function(e,i,o){var a=e[0],s=e[1],u=e[2],c=decode(s);a===r.userId&&t.path.isEqual(c)?n=n.add(u):o.done()});i.push(s)}),PersistencePromise.waitFor(i).next(function(){return r.lookupMutationBatches(e,n)})},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var r=this;assert(!t.isDocumentQuery(),"Document queries shouldn't go down this path"),assert(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,i=n.length+1,o=DbDocumentMutation.prefixForPath(this.userId,n),a=IDBKeyRange.lowerBound(o),s=new SortedSet(primitiveComparator);return documentMutationsStore(e).iterate({range:a},function(e,t,o){var a=e[0],u=e[1],c=e[2],l=decode(u);a===r.userId&&n.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(function(){return r.lookupMutationBatches(e,s)})},e.prototype.lookupMutationBatches=function(e,t){var r=this,n=[],i=[];return t.forEach(function(t){i.push(mutationsStore(e).get(t).next(function(e){if(null===e)throw fail("Dangling document-mutation reference found, which points to "+t);assert(e.userId===r.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.push(r.serializer.fromDbMutationBatch(e))}))}),PersistencePromise.waitFor(i).next(function(){return n})},e.prototype.removeMutationBatch=function(e,t){var r=this;return removeMutationBatch(e.simpleDbTransaction,this.userId,t).next(function(n){return e.addOnCommittedListener(function(){r.removeCachedMutationKeys(t.batchId)}),PersistencePromise.forEach(n,function(t){return r.referenceDelegate.removeMutationReference(e,t)})})},e.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next(function(r){if(!r)return PersistencePromise.resolve();var n=IDBKeyRange.lowerBound(DbDocumentMutation.prefixForUser(t.userId)),i=[];return documentMutationsStore(e).iterate({range:n},function(e,r,n){if(e[0]===t.userId){var o=decode(e[1]);i.push(o)}else n.done()}).next(function(){assert(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(e){return e.canonicalString()}))})})},e.prototype.containsKey=function(e,t){return mutationQueueContainsKey(e,this.userId,t)},e.prototype.getMutationQueueMetadata=function(e){var t=this;return mutationQueuesStore(e).get(this.userId).next(function(e){return e||new DbMutationQueue(t.userId,BATCHID_UNKNOWN,"")})},e}();function mutationQueueContainsKey(e,t,r){var n=DbDocumentMutation.prefixForPath(t,r.path),i=n[1],o=IDBKeyRange.lowerBound(n),a=!1;return documentMutationsStore(e).iterate({range:o,keysOnly:!0},function(e,r,n){var o=e[0],s=e[1];e[2];o===t&&s===i&&(a=!0),n.done()}).next(function(){return a})}function mutationQueuesContainKey(e,t){var r=!1;return mutationQueuesStore(e).iterateSerial(function(n){return mutationQueueContainsKey(e,n,t).next(function(e){return e&&(r=!0),PersistencePromise.resolve(!e)})}).next(function(){return r})}function removeMutationBatch(e,t,r){var n=e.store(DbMutationBatch.store),i=e.store(DbDocumentMutation.store),o=[],a=IDBKeyRange.only(r.batchId),s=0,u=n.iterate({range:a},function(e,t,r){return s++,r.delete()});o.push(u.next(function(){assert(1===s,"Dangling document-mutation reference found: Missing batch "+r.batchId)}));for(var c=[],l=0,h=r.mutations;l<h.length;l++){var d=h[l],f=DbDocumentMutation.key(t,d.key.path,r.batchId);o.push(i.delete(f)),c.push(d.key)}return PersistencePromise.waitFor(o).next(function(){return c})}function convertStreamToken(e){return e instanceof Uint8Array?(assert(SimpleDb.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function mutationsStore(e){return IndexedDbPersistence.getStore(e,DbMutationBatch.store)}function documentMutationsStore(e){return IndexedDbPersistence.getStore(e,DbDocumentMutation.store)}function mutationQueuesStore(e){return IndexedDbPersistence.getStore(e,DbMutationQueue.store)}var GeneratorIds,RESERVED_BITS=1;!function(e){e[e.QueryCache=0]="QueryCache",e[e.SyncEngine=1]="SyncEngine"}(GeneratorIds||(GeneratorIds={}));var TargetIdGenerator=function(){function e(e,t){this.generatorId=e,assert((e&RESERVED_BITS)===e,"Generator ID "+e+" contains more than "+RESERVED_BITS+" reserved bits"),this.seek(void 0!==t?t:this.generatorId)}return e.prototype.next=function(){var e=this.nextId;return this.nextId+=1<<RESERVED_BITS,e},e.prototype.after=function(e){return this.seek(e+(1<<RESERVED_BITS)),this.next()},e.prototype.seek=function(e){assert((e&RESERVED_BITS)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},e.forTargetCache=function(){return new e(GeneratorIds.QueryCache,2)},e.forSyncEngine=function(){return new e(GeneratorIds.SyncEngine)},e}(),IndexedDbTargetCache=function(){function e(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=TargetIdGenerator.forTargetCache()}return e.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next(function(r){return r.highestTargetId=t.targetIdGenerator.after(r.highestTargetId),t.saveMetadata(e,r).next(function(){return r.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next(function(e){return SnapshotVersion.fromTimestamp(new Timestamp(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(e){return getHighestListenSequenceNumber(e.simpleDbTransaction)},e.prototype.setTargetsMetadata=function(e,t,r){var n=this;return this.retrieveMetadata(e).next(function(i){return i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),n.saveMetadata(e,i)})},e.prototype.addTargetData=function(e,t){var r=this;return this.saveTargetData(e,t).next(function(){return r.retrieveMetadata(e).next(function(n){return n.targetCount+=1,r.updateMetadataFromTargetData(t,n),r.saveMetadata(e,n)})})},e.prototype.updateTargetData=function(e,t){return this.saveTargetData(e,t)},e.prototype.removeTargetData=function(e,t){var r=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return targetsStore(e).delete(t.targetId)}).next(function(){return r.retrieveMetadata(e)}).next(function(t){return assert(t.targetCount>0,"Removing from an empty target cache"),t.targetCount-=1,r.saveMetadata(e,t)})},e.prototype.removeTargets=function(e,t,r){var n=this,i=0,o=[];return targetsStore(e).iterate(function(a,s){var u=n.serializer.fromDbTarget(s);u.sequenceNumber<=t&&null===r.get(u.targetId)&&(i++,o.push(n.removeTargetData(e,u)))}).next(function(){return PersistencePromise.waitFor(o)}).next(function(){return i})},e.prototype.forEachTarget=function(e,t){var r=this;return targetsStore(e).iterate(function(e,n){var i=r.serializer.fromDbTarget(n);t(i)})},e.prototype.retrieveMetadata=function(e){return retrieveMetadata(e.simpleDbTransaction)},e.prototype.saveMetadata=function(e,t){return globalTargetStore(e).put(DbTargetGlobal.key,t)},e.prototype.saveTargetData=function(e,t){return targetsStore(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromTargetData=function(e,t){var r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r},e.prototype.getTargetCount=function(e){return this.retrieveMetadata(e).next(function(e){return e.targetCount})},e.prototype.getTargetData=function(e,t){var r=this,n=t.canonicalId(),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),o=null;return targetsStore(e).iterate({range:i,index:DbTarget.queryTargetsIndexName},function(e,n,i){var a=r.serializer.fromDbTarget(n);t.isEqual(a.target)&&(o=a,i.done())}).next(function(){return o})},e.prototype.addMatchingKeys=function(e,t,r){var n=this,i=[],o=documentTargetStore(e);return t.forEach(function(t){var a=encode(t.path);i.push(o.put(new DbTargetDocument(r,a))),i.push(n.referenceDelegate.addReference(e,t))}),PersistencePromise.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,r){var n=this,i=documentTargetStore(e);return PersistencePromise.forEach(t,function(t){var o=encode(t.path);return PersistencePromise.waitFor([i.delete([r,o]),n.referenceDelegate.removeReference(e,t)])})},e.prototype.removeMatchingKeysForTargetId=function(e,t){var r=documentTargetStore(e),n=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(n)},e.prototype.getMatchingKeysForTargetId=function(e,t){var r=IDBKeyRange.bound([t],[t+1],!1,!0),n=documentTargetStore(e),i=documentKeySet();return n.iterate({range:r,keysOnly:!0},function(e,t,r){var n=decode(e[1]),o=new DocumentKey(n);i=i.add(o)}).next(function(){return i})},e.prototype.containsKey=function(e,t){var r=encode(t.path),n=IDBKeyRange.bound([r],[immediateSuccessor(r)],!1,!0),i=0;return documentTargetStore(e).iterate({index:DbTargetDocument.documentTargetsIndex,keysOnly:!0,range:n},function(e,t,r){var n=e[0];e[1];0!==n&&(i++,r.done())}).next(function(){return i>0})},e.prototype.getTargetDataForTarget=function(e,t){var r=this;return targetsStore(e).get(t).next(function(e){return e?r.serializer.fromDbTarget(e):null})},e}();function targetsStore(e){return IndexedDbPersistence.getStore(e,DbTarget.store)}function globalTargetStore(e){return IndexedDbPersistence.getStore(e,DbTargetGlobal.store)}function retrieveMetadata(e){return SimpleDb.getStore(e,DbTargetGlobal.store).get(DbTargetGlobal.key).next(function(e){return assert(null!==e,"Missing metadata row."),e})}function getHighestListenSequenceNumber(e){return retrieveMetadata(e).next(function(e){return e.highestListenSequenceNumber})}function documentTargetStore(e){return IndexedDbPersistence.getStore(e,DbTargetDocument.store)}var MutationType,FieldMask=function(){function e(e){this.fields=e}return e.fromSet=function(t){return new e(t)},e.fromArray=function(t){var r=new SortedSet(FieldPath.comparator);return t.forEach(function(e){return r=r.add(e)}),new e(r)},e.prototype.covers=function(e){var t=!1;return this.fields.forEach(function(r){r.isPrefixOf(e)&&(t=!0)}),t},e.prototype.isEqual=function(e){return this.fields.isEqual(e.fields)},e}(),FieldTransform=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),MutationResult=function(){return function(e,t){this.version=e,this.transformResults=t}}();!function(e){e[e.Set=0]="Set",e[e.Patch=1]="Patch",e[e.Transform=2]="Transform",e[e.Delete=3]="Delete",e[e.Verify=4]="Verify"}(MutationType||(MutationType={}));var TypeOrder,ServerTimestampBehavior,Precondition=function(){function e(e,t){this.updateTime=e,this.exists=t,assert(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),e.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof Document&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof Document:(assert(this.isNone,"Precondition should be empty"),!0)},e.prototype.isEqual=function(e){return equals(this.updateTime,e.updateTime)&&this.exists===e.exists},e.NONE=new e,e}(),Mutation=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&assert(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof Document?e.version:SnapshotVersion.MIN},e}(),SetMutation=function(e){function t(t,r,n){var i=e.call(this)||this;return i.key=t,i.value=r,i.precondition=n,i.type=MutationType.Set,i}return tslib.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){this.verifyKeyMatches(e),assert(null==t.transformResults,"Transform results received by SetMutation.");var r=t.version;return new Document(this.key,r,{hasCommittedMutations:!0},this.value)},t.prototype.applyToLocalView=function(e,t,r){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var n=Mutation.getPostMutationVersion(e);return new Document(this.key,n,{hasLocalMutations:!0},this.value)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(Mutation),PatchMutation=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.key=t,o.data=r,o.fieldMask=n,o.precondition=i,o.type=MutationType.Patch,o}return tslib.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),assert(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new UnknownDocument(this.key,t.version);var r=this.patchDocument(e);return new Document(this.key,t.version,{hasCommittedMutations:!0},r)},t.prototype.applyToLocalView=function(e,t,r){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var n=Mutation.getPostMutationVersion(e),i=this.patchDocument(e);return new Document(this.key,n,{hasLocalMutations:!0},i)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof Document?e.data():ObjectValue.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){var t=this;return this.fieldMask.fields.forEach(function(r){if(!r.isEmpty()){var n=t.data.field(r);e=null!==n?e.set(r,n):e.delete(r)}}),e},t}(Mutation),TransformMutation=function(e){function t(t,r){var n=e.call(this)||this;return n.key=t,n.fieldTransforms=r,n.type=MutationType.Transform,n.precondition=Precondition.exists(!0),n}return tslib.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),assert(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new UnknownDocument(this.key,t.version);var r=this.requireDocument(e),n=this.serverTransformResults(e,t.transformResults),i=t.version,o=this.transformObject(r.data(),n);return new Document(this.key,i,{hasCommittedMutations:!0},o)},t.prototype.applyToLocalView=function(e,t,r){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var n=this.requireDocument(e),i=this.localTransformResults(r,e,t),o=this.transformObject(n.data(),i);return new Document(this.key,n.version,{hasLocalMutations:!0},o)},t.prototype.extractBaseValue=function(e){for(var t=null,r=0,n=this.fieldTransforms;r<n.length;r++){var i=n[r],o=e instanceof Document?e.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(t=null==t?ObjectValue.EMPTY.set(i.field,a):t.set(i.field,a))}return t},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&arrayEquals(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){return assert(e instanceof Document,"Unknown MaybeDocument type "+e),assert(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},t.prototype.serverTransformResults=function(e,t){var r=[];assert(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var n=0;n<t.length;n++){var i=this.fieldTransforms[n],o=i.transform,a=null;e instanceof Document&&(a=e.field(i.field)),r.push(o.applyToRemoteDocument(a,t[n]))}return r},t.prototype.localTransformResults=function(e,t,r){for(var n=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;t instanceof Document&&(u=t.field(a.field)),null===u&&r instanceof Document&&(u=r.field(a.field)),n.push(s.applyToLocalView(u,e))}return n},t.prototype.transformObject=function(e,t){assert(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var r=0;r<this.fieldTransforms.length;r++){var n=this.fieldTransforms[r].field;e=e.set(n,t[r])}return e},t}(Mutation),DeleteMutation=function(e){function t(t,r){var n=e.call(this)||this;return n.key=t,n.precondition=r,n.type=MutationType.Delete,n}return tslib.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),assert(null==t.transformResults,"Transform results received by DeleteMutation."),new NoDocument(this.key,t.version,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,r){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&assert(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new NoDocument(this.key,SnapshotVersion.forDeletedDoc())):e},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(Mutation),VerifyMutation=function(e){function t(t,r){var n=e.call(this)||this;return n.key=t,n.precondition=r,n.type=MutationType.Verify,n}return tslib.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){fail("VerifyMutation should only be used in Transactions.")},t.prototype.applyToLocalView=function(e,t,r){fail("VerifyMutation should only be used in Transactions.")},t.prototype.extractBaseValue=function(e){fail("VerifyMutation should only be used in Transactions.")},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(Mutation);!function(e){e[e.NullValue=0]="NullValue",e[e.BooleanValue=1]="BooleanValue",e[e.NumberValue=2]="NumberValue",e[e.TimestampValue=3]="TimestampValue",e[e.StringValue=4]="StringValue",e[e.BlobValue=5]="BlobValue",e[e.RefValue=6]="RefValue",e[e.GeoPointValue=7]="GeoPointValue",e[e.ArrayValue=8]="ArrayValue",e[e.ObjectValue=9]="ObjectValue"}(TypeOrder||(TypeOrder={})),function(e){e[e.Default=0]="Default",e[e.Estimate=1]="Estimate",e[e.Previous=2]="Previous"}(ServerTimestampBehavior||(ServerTimestampBehavior={}));var FieldValueOptions=function(){function e(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return e.fromSnapshotOptions=function(t,r){switch(t.serverTimestamps){case"estimate":return new e(ServerTimestampBehavior.Estimate,r);case"previous":return new e(ServerTimestampBehavior.Previous,r);case"none":case void 0:return new e(ServerTimestampBehavior.Default,r);default:return fail("fromSnapshotOptions() called with invalid options.")}},e}(),FieldValue=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return assert(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),primitiveComparator(this.typeOrder,e.typeOrder)},e}(),NullValue=function(e){function t(){var t=e.call(this)||this;return t.typeOrder=TypeOrder.NullValue,t.internalValue=null,t}return tslib.__extends(t,e),t.prototype.value=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t},t.prototype.compareTo=function(e){return e instanceof t?0:this.defaultCompareTo(e)},t.INSTANCE=new t,t}(FieldValue),BooleanValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.BooleanValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?primitiveComparator(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(FieldValue),NumberValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.NumberValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?numericComparator(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(FieldValue);function numericComparator(e,t){return e<t?-1:e>t?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}function numericEquals(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var IntegerValue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&numericEquals(this.internalValue,e.internalValue)},t}(NumberValue),DoubleValue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&numericEquals(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(NumberValue),StringValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.StringValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?primitiveComparator(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),TimestampValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.TimestampValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return!e||e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof ServerTimestampValue?-1:this.defaultCompareTo(e)},t}(FieldValue),ServerTimestampValue=function(e){function t(t,r){var n=e.call(this)||this;return n.localWriteTime=t,n.previousValue=r,n.typeOrder=TypeOrder.TimestampValue,n}return tslib.__extends(t,e),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===ServerTimestampBehavior.Estimate?new TimestampValue(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===ServerTimestampBehavior.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof TimestampValue?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(FieldValue),BlobValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.BlobValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),RefValue=function(e){function t(t,r){var n=e.call(this)||this;return n.databaseId=t,n.key=r,n.typeOrder=TypeOrder.RefValue,n}return tslib.__extends(t,e),t.prototype.value=function(e){return this.key},t.prototype.isEqual=function(e){return e instanceof t&&(this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId))},t.prototype.compareTo=function(e){if(e instanceof t){var r=this.databaseId.compareTo(e.databaseId);return 0!==r?r:DocumentKey.comparator(this.key,e.key)}return this.defaultCompareTo(e)},t}(FieldValue),GeoPointValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.GeoPointValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),ObjectValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.ObjectValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal(function(r,n){t[r]=n.value(e)}),t},t.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},t.prototype.isEqual=function(e){if(e instanceof t){for(var r=this.internalValue.getIterator(),n=e.internalValue.getIterator();r.hasNext()&&n.hasNext();){var i=r.getNext(),o=n.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!r.hasNext()&&!n.hasNext()}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var r=this.internalValue.getIterator(),n=e.internalValue.getIterator();r.hasNext()&&n.hasNext();){var i=r.getNext(),o=n.getNext(),a=primitiveComparator(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return primitiveComparator(r.hasNext(),n.hasNext())}return this.defaultCompareTo(e)},t.prototype.set=function(e,r){if(assert(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),r);var n=this.child(e.firstSegment());n instanceof t||(n=t.EMPTY);var i=n.set(e.popFirst(),r);return this.setChild(e.firstSegment(),i)},t.prototype.delete=function(e){if(assert(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new t(this.internalValue.remove(e.firstSegment()));var r=this.child(e.firstSegment());if(r instanceof t){var n=r.delete(e.popFirst());return new t(this.internalValue.insert(e.firstSegment(),n))}return this},t.prototype.contains=function(e){return null!==this.field(e)},t.prototype.field=function(e){assert(!e.isEmpty(),"Can't get field of empty path");var r=this;return e.forEach(function(e){r=r instanceof t?r.internalValue.get(e):null}),r},t.prototype.fieldMask=function(){var e=new SortedSet(FieldPath.comparator);return this.internalValue.forEach(function(r,n){var i=new FieldPath([r]);if(n instanceof t){var o=n.fieldMask().fields;o.isEmpty()?e=e.add(i):o.forEach(function(t){e=e.add(i.child(t))})}else e=e.add(i)}),FieldMask.fromSet(e)},t.prototype.toString=function(){return this.internalValue.toString()},t.prototype.child=function(e){return this.internalValue.get(e)||void 0},t.prototype.setChild=function(e,r){return new t(this.internalValue.insert(e,r))},t.EMPTY=new t(new SortedMap(primitiveComparator)),t}(FieldValue),ArrayValue=function(e){function t(t){var r=e.call(this)||this;return r.internalValue=t,r.typeOrder=TypeOrder.ArrayValue,r}return tslib.__extends(t,e),t.prototype.value=function(e){return this.internalValue.map(function(t){return t.value(e)})},t.prototype.contains=function(e){for(var t=0,r=this.internalValue;t<r.length;t++){if(r[t].isEqual(e))return!0}return!1},t.prototype.forEach=function(e){this.internalValue.forEach(e)},t.prototype.isEqual=function(e){if(e instanceof t){if(this.internalValue.length!==e.internalValue.length)return!1;for(var r=0;r<this.internalValue.length;r++)if(!this.internalValue[r].isEqual(e.internalValue[r]))return!1;return!0}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var r=Math.min(this.internalValue.length,e.internalValue.length),n=0;n<r;n++){var i=this.internalValue[n].compareTo(e.internalValue[n]);if(i)return i}return primitiveComparator(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},t.prototype.toString=function(){return"["+this.internalValue.map(function(e){return e.toString()}).join(",")+"]"},t}(FieldValue),MaybeDocument=function(){function e(e,t){this.key=e,this.version=t}return e.compareByKey=function(e,t){return DocumentKey.comparator(e.key,t.key)},e}(),Document=function(e){function t(t,r,n,i,o,a){var s=e.call(this,t,r)||this;return s.objectValue=i,s.proto=o,s.converter=a,assert(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!n.hasLocalMutations,s.hasCommittedMutations=!!n.hasCommittedMutations,s}return tslib.__extends(t,e),t.prototype.field=function(e){if(this.objectValue)return this.objectValue.field(e);this.fieldValueCache||(this.fieldValueCache=new Map);var t=e.canonicalString(),r=this.fieldValueCache.get(t);if(void 0===r){var n=this.getProtoField(e);r=void 0===n?null:this.converter(n),this.fieldValueCache.set(t,r)}return r},t.prototype.data=function(){var e=this;if(!this.objectValue){var t=ObjectValue.EMPTY;forEach(this.proto.fields||{},function(r,n){t=t.set(new FieldPath([r]),e.converter(n))}),this.objectValue=t,this.fieldValueCache=void 0}return this.objectValue},t.prototype.value=function(){return this.data().value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.data().isEqual(e.data())},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.getProtoField=function(e){assert(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var t=this.proto.fields?this.proto.fields[e.firstSegment()]:void 0,r=1;r<e.length;++r){if(!t||!t.mapValue||!t.mapValue.fields)return;t=t.mapValue.fields[e.get(r)]}return t},t.compareByField=function(e,t,r){var n=t.field(e),i=r.field(e);return null!==n&&null!==i?n.compareTo(i):fail("Trying to compare documents on fields that don't exist")},t}(MaybeDocument),NoDocument=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}return tslib.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(MaybeDocument),UnknownDocument=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(MaybeDocument),ObjectMap=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(var n=0,i=r;n<i.length;n++){var o=i[n],a=o[0],s=o[1];if(a.isEqual(e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var r=this.mapKeyFn(e),n=this.inner[r];if(void 0!==n){for(var i=0;i<n.length;i++)if(n[i][0].isEqual(e))return void(n[i]=[e,t]);n.push([e,t])}else this.inner[r]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(var n=0;n<r.length;n++)if(r[n][0].isEqual(e))return 1===r.length?delete this.inner[t]:r.splice(n,1),!0;return!1},e.prototype.forEach=function(e){forEach(this.inner,function(t,r){for(var n=0,i=r;n<i.length;n++){var o=i[n],a=o[0],s=o[1];e(a,s)}})},e.prototype.isEmpty=function(){return isEmpty(this.inner)},e}(),RemoteDocumentChangeBuffer=function(){function e(){this.changes=new ObjectMap(function(e){return e.toString()}),this.changesApplied=!1}return Object.defineProperty(e.prototype,"readTime",{get:function(){return assert(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(e){assert(void 0===this._readTime||this._readTime.isEqual(e),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=e},enumerable:!0,configurable:!0}),e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.readTime=t,this.changes.set(e.key,e)},e.prototype.removeEntry=function(e,t){this.assertNotApplied(),t&&(this.readTime=t),this.changes.set(e,null)},e.prototype.getEntry=function(e,t){this.assertNotApplied();var r=this.changes.get(t);return void 0!==r?PersistencePromise.resolve(r):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){assert(!this.changesApplied,"Changes have already been applied.")},e}(),IndexedDbRemoteDocumentCache=function(){function e(e,t){this.serializer=e,this.indexManager=t}return e.prototype.addEntry=function(e,t,r){return remoteDocumentsStore(e).put(dbKey(t),r)},e.prototype.removeEntry=function(e,t){var r=remoteDocumentsStore(e),n=dbKey(t);return r.delete(n)},e.prototype.updateMetadata=function(e,t){var r=this;return this.getMetadata(e).next(function(n){return n.byteSize+=t,r.setMetadata(e,n)})},e.prototype.getEntry=function(e,t){var r=this;return remoteDocumentsStore(e).get(dbKey(t)).next(function(e){return r.maybeDecodeDocument(e)})},e.prototype.getSizedEntry=function(e,t){var r=this;return remoteDocumentsStore(e).get(dbKey(t)).next(function(e){var t=r.maybeDecodeDocument(e);return t?{maybeDocument:t,size:dbDocumentSize(e)}:null})},e.prototype.getEntries=function(e,t){var r=this,n=nullableMaybeDocumentMap();return this.forEachDbEntry(e,t,function(e,t){var i=r.maybeDecodeDocument(t);n=n.insert(e,i)}).next(function(){return n})},e.prototype.getSizedEntries=function(e,t){var r=this,n=nullableMaybeDocumentMap(),i=new SortedMap(DocumentKey.comparator);return this.forEachDbEntry(e,t,function(e,t){var o=r.maybeDecodeDocument(t);o?(n=n.insert(e,o),i=i.insert(e,dbDocumentSize(t))):(n=n.insert(e,null),i=i.insert(e,0))}).next(function(){return{maybeDocuments:n,sizeMap:i}})},e.prototype.forEachDbEntry=function(e,t,r){if(t.isEmpty())return PersistencePromise.resolve();var n=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return remoteDocumentsStore(e).iterate({range:n},function(e,t,n){for(var a=DocumentKey.fromSegments(e);o&&DocumentKey.comparator(o,a)<0;)r(o,null),o=i.getNext();o&&o.isEqual(a)&&(r(o,t),o=i.hasNext()?i.getNext():null),o?n.skip(o.path.toArray()):n.done()}).next(function(){for(;o;)r(o,null),o=i.hasNext()?i.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(e,t,r){var n=this;assert(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=documentMap(),o=t.path.length+1,a={};if(r.isEqual(SnapshotVersion.MIN)){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),c=this.serializer.toDbTimestampKey(r);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=DbRemoteDocument.collectionReadTimeIndex}return remoteDocumentsStore(e).iterate(a,function(e,r,a){if(e.length===o){var s=n.serializer.fromDbRemoteDocument(r);t.path.isPrefixOf(s.key.path)?s instanceof Document&&t.matches(s)&&(i=i.insert(s.key,s)):a.done()}}).next(function(){return i})},e.prototype.getNewDocumentChanges=function(e,t){var r=this,n=maybeDocumentMap(),i=this.serializer.toDbTimestampKey(t),o=remoteDocumentsStore(e),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:DbRemoteDocument.readTimeIndex,range:a},function(e,t){var o=r.serializer.fromDbRemoteDocument(t);n=n.insert(o.key,o),i=t.readTime}).next(function(){return{changedDocs:n,readTime:r.serializer.fromDbTimestampKey(i)}})},e.prototype.getLastDocumentChange=function(e){var t,r=this,n=remoteDocumentsStore(e),i=SnapshotVersion.MIN;return n.iterate({index:DbRemoteDocument.readTimeIndex,reverse:!0},function(e,n,o){t=r.serializer.fromDbRemoteDocument(n),n.readTime&&(i=r.serializer.fromDbTimestampKey(n.readTime)),o.done()}).next(function(){return{changedDoc:t,readTime:i}})},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this,!!t&&t.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},e.prototype.getMetadata=function(e){return documentGlobalStore(e).get(DbRemoteDocumentGlobal.key).next(function(e){return assert(!!e,"Missing document cache metadata"),e})},e.prototype.setMetadata=function(e,t){return documentGlobalStore(e).put(DbRemoteDocumentGlobal.key,t)},e.prototype.maybeDecodeDocument=function(e){if(e){var t=this.serializer.fromDbRemoteDocument(e);return t instanceof NoDocument&&t.version.isEqual(SnapshotVersion.forDeletedDoc())?null:t}return null},e.RemoteDocumentChangeBuffer=function(e){function t(t,r){var n=e.call(this)||this;return n.documentCache=t,n.trackRemovals=r,n.documentSizes=new ObjectMap(function(e){return e.toString()}),n}return tslib.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,r=[],n=0,i=new SortedSet(function(e,t){return primitiveComparator(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(o,a){var s=t.documentSizes.get(o);if(assert(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){assert(!t.readTime.isEqual(SnapshotVersion.MIN),"Cannot add a document with a read time of zero");var u=t.documentCache.serializer.toDbRemoteDocument(a,t.readTime);i=i.add(o.path.popLast());var c=dbDocumentSize(u);n+=c-s,r.push(t.documentCache.addEntry(e,o,u))}else if(n-=s,t.trackRemovals){var l=t.documentCache.serializer.toDbRemoteDocument(new NoDocument(o,SnapshotVersion.forDeletedDoc()),t.readTime);r.push(t.documentCache.addEntry(e,o,l))}else r.push(t.documentCache.removeEntry(e,o))}),i.forEach(function(n){r.push(t.documentCache.indexManager.addToCollectionParentIndex(e,n))}),r.push(this.documentCache.updateMetadata(e,n)),PersistencePromise.waitFor(r)},t.prototype.getFromCache=function(e,t){var r=this;return this.documentCache.getSizedEntry(e,t).next(function(e){return null===e?(r.documentSizes.set(t,0),null):(r.documentSizes.set(t,e.size),e.maybeDocument)})},t.prototype.getAllFromCache=function(e,t){var r=this;return this.documentCache.getSizedEntries(e,t).next(function(e){var t=e.maybeDocuments;return e.sizeMap.forEach(function(e,t){r.documentSizes.set(e,t)}),t})},t}(RemoteDocumentChangeBuffer),e}();function documentGlobalStore(e){return IndexedDbPersistence.getStore(e,DbRemoteDocumentGlobal.store)}function remoteDocumentsStore(e){return IndexedDbPersistence.getStore(e,DbRemoteDocument.store)}function dbKey(e){return e.path.toArray()}function dbDocumentSize(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw fail("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var MemoryIndexManager=function(){function e(){this.collectionParentIndex=new MemoryCollectionParentIndex}return e.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),PersistencePromise.resolve()},e.prototype.getCollectionParents=function(e,t){return PersistencePromise.resolve(this.collectionParentIndex.getEntries(t))},e}(),MemoryCollectionParentIndex=function(){function e(){this.index={}}return e.prototype.add=function(e){assert(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new SortedSet(ResourcePath.comparator),i=!n.has(r);return this.index[t]=n.add(r),i},e.prototype.has=function(e){var t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)},e.prototype.getEntries=function(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()},e}(),SCHEMA_VERSION=9,SchemaConverter=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,r,n){var i=this;assert(r<n&&r>=0&&n<=SCHEMA_VERSION,"Unexpected schema upgrade from v"+r+" to v{toVersion}.");var o=new SimpleDbTransaction(t);r<1&&n>=1&&(createPrimaryClientStore(e),createMutationQueue(e),createQueryCache(e),createRemoteDocumentCache(e));var a=PersistencePromise.resolve();return r<3&&n>=3&&(0!==r&&(dropQueryCache(e),createQueryCache(e)),a=a.next(function(){return writeEmptyTargetGlobalEntry(o)})),r<4&&n>=4&&(0!==r&&(a=a.next(function(){return upgradeMutationBatchSchemaAndMigrateData(e,o)})),a=a.next(function(){createClientMetadataStore(e)})),r<5&&n>=5&&(a=a.next(function(){return i.removeAcknowledgedMutations(o)})),r<6&&n>=6&&(a=a.next(function(){return createDocumentGlobalStore(e),i.addDocumentGlobal(o)})),r<7&&n>=7&&(a=a.next(function(){return i.ensureSequenceNumbers(o)})),r<8&&n>=8&&(a=a.next(function(){return i.createCollectionParentIndex(e,o)})),r<9&&n>=9&&(a=a.next(function(){dropRemoteDocumentChangesStore(e),createRemoteDocumentReadTimeIndex(t)})),a},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store(DbRemoteDocument.store).iterate(function(e,r){t+=dbDocumentSize(r)}).next(function(){var r=new DbRemoteDocumentGlobal(t);return e.store(DbRemoteDocumentGlobal.store).put(DbRemoteDocumentGlobal.key,r)})},e.prototype.removeAcknowledgedMutations=function(e){var t=this,r=e.store(DbMutationQueue.store),n=e.store(DbMutationBatch.store);return r.loadAll().next(function(r){return PersistencePromise.forEach(r,function(r){var i=IDBKeyRange.bound([r.userId,BATCHID_UNKNOWN],[r.userId,r.lastAcknowledgedBatchId]);return n.loadAll(DbMutationBatch.userMutationsIndex,i).next(function(n){return PersistencePromise.forEach(n,function(n){assert(n.userId===r.userId,"Cannot process batch "+n.batchId+" from unexpected user");var i=t.serializer.fromDbMutationBatch(n);return removeMutationBatch(e,r.userId,i).next(function(){})})})})})},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(DbTargetDocument.store),r=e.store(DbRemoteDocument.store);return getHighestListenSequenceNumber(e).next(function(e){var n=[];return r.iterate(function(r,i){var o=new ResourcePath(r),a=sentinelKey(o);n.push(t.get(a).next(function(r){return r?PersistencePromise.resolve():function(r){return t.put(new DbTargetDocument(0,encode(r),e))}(o)}))}).next(function(){return PersistencePromise.waitFor(n)})})},e.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(DbCollectionParent.store,{keyPath:DbCollectionParent.keyPath});var r=t.store(DbCollectionParent.store),n=new MemoryCollectionParentIndex,i=function(e){if(n.add(e)){var t=e.lastSegment(),i=e.popLast();return r.put({collectionId:t,parent:encode(i)})}};return t.store(DbRemoteDocument.store).iterate({keysOnly:!0},function(e,t){var r=new ResourcePath(e);return i(r.popLast())}).next(function(){return t.store(DbDocumentMutation.store).iterate({keysOnly:!0},function(e,t){e[0];var r=e[1],n=(e[2],decode(r));return i(n.popLast())})})},e}();function sentinelKey(e){return[0,encode(e)]}var DbTimestamp=function(){return function(e,t){this.seconds=e,this.nanoseconds=t}}(),DbPrimaryClient=function(){function e(e,t,r){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=r}return e.store="owner",e.key="owner",e}();function createPrimaryClientStore(e){e.createObjectStore(DbPrimaryClient.store)}var DbMutationQueue=function(){function e(e,t,r){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=r}return e.store="mutationQueues",e.keyPath="userId",e}(),DbMutationBatch=function(){function e(e,t,r,n,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=r,this.baseMutations=n,this.mutations=i}return e.store="mutations",e.keyPath="batchId",e.userMutationsIndex="userMutationsIndex",e.userMutationsKeyPath=["userId","batchId"],e}();function createMutationQueue(e){e.createObjectStore(DbMutationQueue.store,{keyPath:DbMutationQueue.keyPath}),e.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0}).createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0}),e.createObjectStore(DbDocumentMutation.store)}function upgradeMutationBatchSchemaAndMigrateData(e,t){return t.store(DbMutationBatch.store).loadAll().next(function(r){e.deleteObjectStore(DbMutationBatch.store),e.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0}).createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0});var n=t.store(DbMutationBatch.store),i=r.map(function(e){return n.put(e)});return PersistencePromise.waitFor(i)})}var DbDocumentMutation=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,encode(t)]},e.key=function(e,t,r){return[e,encode(t),r]},e.store="documentMutations",e.PLACEHOLDER=new e,e}();function createRemoteDocumentCache(e){e.createObjectStore(DbRemoteDocument.store)}var DbNoDocument=function(){return function(e,t){this.path=e,this.readTime=t}}(),DbUnknownDocument=function(){return function(e,t){this.path=e,this.version=t}}(),DbRemoteDocument=function(){function e(e,t,r,n,i,o){this.unknownDocument=e,this.noDocument=t,this.document=r,this.hasCommittedMutations=n,this.readTime=i,this.parentPath=o}return e.store="remoteDocuments",e.readTimeIndex="readTimeIndex",e.readTimeIndexPath="readTime",e.collectionReadTimeIndex="collectionReadTimeIndex",e.collectionReadTimeIndexPath=["parentPath","readTime"],e}(),DbRemoteDocumentGlobal=function(){function e(e){this.byteSize=e}return e.store="remoteDocumentGlobal",e.key="remoteDocumentGlobalKey",e}();function createDocumentGlobalStore(e){e.createObjectStore(DbRemoteDocumentGlobal.store)}var DbTarget=function(){function e(e,t,r,n,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=r,this.resumeToken=n,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),DbTargetDocument=function(){function e(e,t,r){this.targetId=e,this.path=t,this.sequenceNumber=r,assert(0===e==(void 0!==r),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),DbTargetGlobal=function(){function e(e,t,r,n){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=r,this.targetCount=n}return e.key="targetGlobalKey",e.store="targetGlobal",e}(),DbCollectionParent=function(){function e(e,t){this.collectionId=e,this.parent=t}return e.store="collectionParents",e.keyPath=["collectionId","parent"],e}();function createQueryCache(e){e.createObjectStore(DbTargetDocument.store,{keyPath:DbTargetDocument.keyPath}).createIndex(DbTargetDocument.documentTargetsIndex,DbTargetDocument.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(DbTarget.store,{keyPath:DbTarget.keyPath}).createIndex(DbTarget.queryTargetsIndexName,DbTarget.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(DbTargetGlobal.store)}function dropQueryCache(e){e.deleteObjectStore(DbTargetDocument.store),e.deleteObjectStore(DbTarget.store),e.deleteObjectStore(DbTargetGlobal.store)}function dropRemoteDocumentChangesStore(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}function writeEmptyTargetGlobalEntry(e){var t=e.store(DbTargetGlobal.store),r=new DbTargetGlobal(0,0,SnapshotVersion.MIN.toTimestamp(),0);return t.put(DbTargetGlobal.key,r)}function createRemoteDocumentReadTimeIndex(e){var t=e.objectStore(DbRemoteDocument.store);t.createIndex(DbRemoteDocument.readTimeIndex,DbRemoteDocument.readTimeIndexPath,{unique:!1}),t.createIndex(DbRemoteDocument.collectionReadTimeIndex,DbRemoteDocument.collectionReadTimeIndexPath,{unique:!1})}var DbClientMetadata=function(){function e(e,t,r,n){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=r,this.inForeground=n}return e.store="clientMetadata",e.keyPath="clientId",e}();function createClientMetadataStore(e){e.createObjectStore(DbClientMetadata.store,{keyPath:DbClientMetadata.keyPath})}var TargetPurpose,V1_STORES=[DbMutationQueue.store,DbMutationBatch.store,DbDocumentMutation.store,DbRemoteDocument.store,DbTarget.store,DbPrimaryClient.store,DbTargetGlobal.store,DbTargetDocument.store],V3_STORES=V1_STORES,V4_STORES=tslib.__spreadArrays(V3_STORES,[DbClientMetadata.store]),V6_STORES=tslib.__spreadArrays(V4_STORES,[DbRemoteDocumentGlobal.store]),V8_STORES=tslib.__spreadArrays(V6_STORES,[DbCollectionParent.store]),ALL_STORES=V8_STORES,IndexedDbIndexManager=function(){function e(){this.collectionParentsCache=new MemoryCollectionParentIndex}return e.prototype.addToCollectionParentIndex=function(e,t){var r=this;if(assert(t.length%2==1,"Expected a collection path."),!this.collectionParentsCache.has(t)){var n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){r.collectionParentsCache.add(t)});var o={collectionId:n,parent:encode(i)};return collectionParentsStore(e).put(o)}return PersistencePromise.resolve()},e.prototype.getCollectionParents=function(e,t){var r=[],n=IDBKeyRange.bound([t,""],[immediateSuccessor(t),""],!1,!0);return collectionParentsStore(e).loadAll(n).next(function(e){for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.collectionId!==t)break;r.push(decode(o.parent))}return r})},e}();function collectionParentsStore(e){return IndexedDbPersistence.getStore(e,DbCollectionParent.store)}!function(e){e[e.Listen=0]="Listen",e[e.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",e[e.LimboResolution=2]="LimboResolution"}(TargetPurpose||(TargetPurpose={}));var TargetData=function(){function e(e,t,r,n,i,o,a){void 0===i&&(i=SnapshotVersion.MIN),void 0===o&&(o=SnapshotVersion.MIN),void 0===a&&(a=emptyByteString()),this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,r){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(e.lastLimboFreeSnapshotVersion)&&this.resumeToken===e.resumeToken&&this.target.isEqual(e.target)},e}(),LocalSerializer=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=DocumentKey.fromSegments(e.noDocument.path),r=this.fromDbTimestamp(e.noDocument.readTime);return new NoDocument(t,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){t=DocumentKey.fromSegments(e.unknownDocument.path),r=this.fromDbTimestamp(e.unknownDocument.version);return new UnknownDocument(t,r)}return fail("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e,t){var r=this.toDbTimestampKey(t),n=e.key.path.popLast().toArray();if(e instanceof Document){var i=e.proto?e.proto:this.remoteSerializer.toDocument(e),o=e.hasCommittedMutations;return new DbRemoteDocument(null,null,i,o,r,n)}if(e instanceof NoDocument){var a=e.key.path.toArray(),s=this.toDbTimestamp(e.version);o=e.hasCommittedMutations;return new DbRemoteDocument(null,new DbNoDocument(a,s),null,o,r,n)}if(e instanceof UnknownDocument){a=e.key.path.toArray();var u=this.toDbTimestamp(e.version);return new DbRemoteDocument(new DbUnknownDocument(a,u),null,null,!0,r,n)}return fail("Unexpected MaybeDocument")},e.prototype.toDbTimestampKey=function(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]},e.prototype.fromDbTimestampKey=function(e){var t=new Timestamp(e[0],e[1]);return SnapshotVersion.fromTimestamp(t)},e.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new DbTimestamp(t.seconds,t.nanoseconds)},e.prototype.fromDbTimestamp=function(e){var t=new Timestamp(e.seconds,e.nanoseconds);return SnapshotVersion.fromTimestamp(t)},e.prototype.toDbMutationBatch=function(e,t){var r=this,n=t.baseMutations.map(function(e){return r.remoteSerializer.toMutation(e)}),i=t.mutations.map(function(e){return r.remoteSerializer.toMutation(e)});return new DbMutationBatch(e,t.batchId,t.localWriteTime.toMillis(),n,i)},e.prototype.fromDbMutationBatch=function(e){var t=this,r=(e.baseMutations||[]).map(function(e){return t.remoteSerializer.fromMutation(e)}),n=e.mutations.map(function(e){return t.remoteSerializer.fromMutation(e)}),i=Timestamp.fromMillis(e.localWriteTimeMs);return new MutationBatch(e.batchId,i,r,n)},e.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach(function(e){t.push(encode(e.path))}),t},e.prototype.fromDbResourcePaths=function(e){for(var t=documentKeySet(),r=0,n=e;r<n.length;r++){var i=n[r];t=t.add(new DocumentKey(decode(i)))}return t},e.prototype.fromDbTarget=function(e){var t,r=this.fromDbTimestamp(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(e.lastLimboFreeSnapshotVersion):SnapshotVersion.MIN,i=e.resumeToken;return t=isDocumentQuery(e.query)?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new TargetData(t,e.targetId,TargetPurpose.Listen,e.lastListenSequenceNumber,r,n,i)},e.prototype.toDbTarget=function(e){assert(TargetPurpose.Listen===e.purpose,"Only queries with purpose "+TargetPurpose.Listen+" may be stored, got "+e.purpose);var t,r,n=this.toDbTimestamp(e.snapshotVersion),i=this.toDbTimestamp(e.lastLimboFreeSnapshotVersion);return t=e.target.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.target):this.remoteSerializer.toQueryTarget(e.target),e.resumeToken instanceof Uint8Array?(assert(SimpleDb.isMockPersistence(),"Persisting non-string stream tokens is only supported with mock persistence ."),r=e.resumeToken.toString()):r=e.resumeToken,new DbTarget(e.targetId,e.target.canonicalId(),n,r,e.sequenceNumber,i,t)},e}();function isDocumentQuery(e){return void 0!==e.documents}function bufferEntryComparator(e,t){var r=e[0],n=e[1],i=t[0],o=t[1],a=primitiveComparator(r,i);return 0===a?primitiveComparator(n,o):a}var RollingSequenceNumberBuffer=function(){function e(e){this.maxElements=e,this.buffer=new SortedSet(bufferEntryComparator),this.previousIndex=0}return e.prototype.nextIndex=function(){return++this.previousIndex},e.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var r=this.buffer.last();bufferEntryComparator(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),e}(),GC_DID_NOT_RUN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},LruParams=function(){function e(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e.COLLECTION_DISABLED=-1,e.MINIMUM_CACHE_SIZE_BYTES=1048576,e.DEFAULT_CACHE_SIZE_BYTES=41943040,e.DEFAULT_COLLECTION_PERCENTILE=10,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,e.DEFAULT=new e(e.DEFAULT_CACHE_SIZE_BYTES,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),e.DISABLED=new e(e.COLLECTION_DISABLED,0,0),e}(),INITIAL_GC_DELAY_MS=6e4,REGULAR_GC_DELAY_MS=3e5,LruScheduler=function(){function e(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.hasRun=!1,this.gcTask=null}return e.prototype.start=function(){assert(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==LruParams.COLLECTION_DISABLED&&this.scheduleGC()},e.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),e.prototype.scheduleGC=function(){var e=this;assert(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?REGULAR_GC_DELAY_MS:INITIAL_GC_DELAY_MS;debug("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(TimerId.LruGarbageCollection,t,function(){return e.gcTask=null,e.hasRun=!0,e.localStore.collectGarbage(e.garbageCollector).then(function(){return e.scheduleGC()}).catch(ignoreIfPrimaryLeaseLoss)})},e}(),LruGarbageCollector=function(){function e(e,t){this.delegate=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next(function(e){return Math.floor(t/100*e)})},e.prototype.nthSequenceNumber=function(e,t){var r=this;if(0===t)return PersistencePromise.resolve(ListenSequence.INVALID);var n=new RollingSequenceNumberBuffer(t);return this.delegate.forEachTarget(e,function(e){return n.addElement(e.sequenceNumber)}).next(function(){return r.delegate.forEachOrphanedDocumentSequenceNumber(e,function(e){return n.addElement(e)})}).next(function(){return n.maxValue})},e.prototype.removeTargets=function(e,t,r){return this.delegate.removeTargets(e,t,r)},e.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var r=this;return this.params.cacheSizeCollectionThreshold===LruParams.COLLECTION_DISABLED?(debug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(GC_DID_NOT_RUN)):this.getCacheSize(e).next(function(n){return n<r.params.cacheSizeCollectionThreshold?(debug("LruGarbageCollector","Garbage collection skipped; Cache size "+n+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),GC_DID_NOT_RUN):r.runGarbageCollection(e,t)})},e.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},e.prototype.runGarbageCollection=function(e,t){var r,n,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>c.params.maximumSequenceNumbersToCollect?(debug("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),n=c.params.maximumSequenceNumbersToCollect):n=t,o=Date.now(),c.nthSequenceNumber(e,n)}).next(function(n){return r=n,a=Date.now(),c.removeTargets(e,r,t)}).next(function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,r)}).next(function(e){(u=Date.now(),getLogLevel()<=LogLevel.DEBUG)&&debug("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+n+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms");return PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:i,documentsRemoved:e})})},e}(),PersistenceTransaction=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},e}(),LOG_TAG$1="IndexedDbPersistence",MAX_CLIENT_AGE_MS=18e5,MAX_PRIMARY_ELIGIBLE_AGE_MS=5e3,CLIENT_METADATA_REFRESH_INTERVAL_MS=4e3,PRIMARY_LEASE_LOST_ERROR_MSG="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",UNSUPPORTED_PLATFORM_ERROR_MSG="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",ZOMBIED_CLIENTS_KEY_PREFIX="firestore_zombie",IndexedDbTransaction=function(e){function t(t,r){var n=e.call(this)||this;return n.simpleDbTransaction=t,n.currentSequenceNumber=r,n}return tslib.__extends(t,e),t}(PersistenceTransaction),IndexedDbPersistence=function(){function e(t,r,n,i,o,a,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=r,this.clientId=n,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},this.referenceDelegate=new IndexedDbLruDelegate(this,o),this.dbName=r+e.MAIN_DATABASE,this.serializer=new LocalSerializer(s),this.document=i.document,this.targetCache=new IndexedDbTargetCache(this.referenceDelegate,this.serializer),this.indexManager=new IndexedDbIndexManager,this.remoteDocumentCache=new IndexedDbRemoteDocumentCache(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new FirestoreError(Code.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return e.getStore=function(e,t){if(e instanceof IndexedDbTransaction)return SimpleDb.getStore(e.simpleDbTransaction,t);throw fail("IndexedDbPersistence must use instances of IndexedDbTransaction")},e.createIndexedDbPersistence=function(t){return tslib.__awaiter(this,void 0,void 0,function(){var r;return tslib.__generator(this,function(n){switch(n.label){case 0:if(!e.isAvailable())throw new FirestoreError(Code.UNIMPLEMENTED,UNSUPPORTED_PLATFORM_ERROR_MSG);return[4,(r=new e(t.allowTabSynchronization,t.persistenceKey,t.clientId,t.platform,t.lruParams,t.queue,t.serializer,t.sequenceNumberSyncer)).start()];case 1:return n.sent(),[2,r]}})})},e.prototype.start=function(){var e=this;return assert(!this.started,"IndexedDbPersistence double-started!"),assert(null!==this.window,"Expected 'window' to be defined"),SimpleDb.openOrCreate(this.dbName,SCHEMA_VERSION,new SchemaConverter(this.serializer)).then(function(t){return e.simpleDb=t,e.updateClientMetadataAndTryBecomePrimary()}).then(function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.scheduleClientMetadataAndPrimaryLeaseRefreshes(),e.simpleDb.runTransaction("readonly-idempotent",[DbTargetGlobal.store],function(e){return getHighestListenSequenceNumber(e)})}).then(function(t){e.listenSequence=new ListenSequence(t,e.sequenceNumberSyncer)}).then(function(){e._started=!0}).catch(function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)})},e.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(r){return tslib.__awaiter(t,void 0,void 0,function(){return tslib.__generator(this,function(t){return this.started?[2,e(r)]:[2]})})},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.simpleDb.setVersionChangeListener(function(r){return tslib.__awaiter(t,void 0,void 0,function(){return tslib.__generator(this,function(t){switch(t.label){case 0:return null!==r.newVersion?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(function(){return tslib.__awaiter(t,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},e.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite-idempotent",ALL_STORES,function(t){return clientMetadataStore(t).put(new DbClientMetadata(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next(function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget(function(){return e.primaryStateListener(!1)}))})}).next(function(){return e.canActAsPrimary(t)}).next(function(r){return e.isPrimary&&!r?e.releasePrimaryLeaseIfHeld(t).next(function(){return!1}):!!r&&e.acquireOrExtendPrimaryLease(t).next(function(){return!0})})}).catch(function(t){if(!e.allowTabSynchronization)throw t;return debug(LOG_TAG$1,"Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.queue.enqueueAndForget(function(){return e.primaryStateListener(t)}),e.isPrimary=t})},e.prototype.verifyPrimaryLease=function(e){var t=this;return primaryClientStore(e).get(DbPrimaryClient.key).next(function(e){return PersistencePromise.resolve(t.isLocalClient(e))})},e.prototype.removeClientMetadata=function(e){return clientMetadataStore(e).delete(this.clientId)},e.prototype.maybeGarbageCollectMultiClientState=function(){return tslib.__awaiter(this,void 0,void 0,function(){var t=this;return tslib.__generator(this,function(r){switch(r.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,MAX_CLIENT_AGE_MS)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",function(r){var n=e.getStore(r,DbClientMetadata.store);return n.loadAll().next(function(e){var r=t.filterActiveClients(e,MAX_CLIENT_AGE_MS),i=e.filter(function(e){return-1===r.indexOf(e)});return PersistencePromise.forEach(i,function(e){return n.delete(e.clientId)}).next(function(){return i})})})]);case 1:r.sent().forEach(function(e){t.window.localStorage.removeItem(t.zombiedClientLocalStorageKey(e.clientId))}),r.label=2;case 2:return[2]}})})},e.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(TimerId.ClientMetadataRefresh,CLIENT_METADATA_REFRESH_INTERVAL_MS,function(){return e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.maybeGarbageCollectMultiClientState()}).then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},e.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.canActAsPrimary=function(e){var t=this;return primaryClientStore(e).get(DbPrimaryClient.key).next(function(r){if(null!==r&&t.isWithinAge(r.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!t.isClientZombied(r.ownerId)){if(t.isLocalClient(r)&&t.networkEnabled)return!0;if(!t.isLocalClient(r)){if(!r.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG);return!1}}return!(!t.networkEnabled||!t.inForeground)||clientMetadataStore(e).loadAll().next(function(e){return void 0===t.filterActiveClients(e,MAX_PRIMARY_ELIGIBLE_AGE_MS).find(function(e){if(t.clientId!==e.clientId){var r=!t.networkEnabled&&e.networkEnabled,n=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(r||n&&i)return!0}return!1})})}).next(function(e){return t.isPrimary!==e&&debug(LOG_TAG$1,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},e.prototype.shutdown=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e=this;return tslib.__generator(this,function(t){switch(t.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[DbPrimaryClient.store,DbClientMetadata.store],function(t){return e.releasePrimaryLeaseIfHeld(t).next(function(){return e.removeClientMetadata(t)})})];case 1:return t.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},e.prototype.filterActiveClients=function(e,t){var r=this;return e.filter(function(e){return r.isWithinAge(e.updateTimeMs,t)&&!r.isClientZombied(e.clientId)})},e.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly-idempotent",[DbClientMetadata.store],function(t){return clientMetadataStore(t).loadAll().next(function(t){return e.filterActiveClients(t,MAX_CLIENT_AGE_MS).map(function(e){return e.clientId})})})},e.clearPersistence=function(t){return tslib.__awaiter(this,void 0,void 0,function(){var r;return tslib.__generator(this,function(n){switch(n.label){case 0:return e.isAvailable()?(r=t+e.MAIN_DATABASE,[4,SimpleDb.delete(r)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getMutationQueue=function(e){return assert(this.started,"Cannot initialize MutationQueue before persistence is started."),IndexedDbMutationQueue.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},e.prototype.getTargetCache=function(){return assert(this.started,"Cannot initialize TargetCache before persistence is started."),this.targetCache},e.prototype.getRemoteDocumentCache=function(){return assert(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},e.prototype.getIndexManager=function(){return assert(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},e.prototype.runTransaction=function(e,t,r){var n=this;debug(LOG_TAG$1,"Starting transaction:",e);var i,o=t.endsWith("idempotent"),a=t.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.simpleDb.runTransaction(a,ALL_STORES,function(o){return i=new IndexedDbTransaction(o,n.listenSequence.next()),"readwrite-primary"===t||"readwrite-primary-idempotent"===t?n.verifyPrimaryLease(o).next(function(e){return!!e||n.canActAsPrimary(o)}).next(function(t){if(!t)throw error("Failed to obtain primary lease for action '"+e+"'."),n.isPrimary=!1,n.queue.enqueueAndForget(function(){return n.primaryStateListener(!1)}),new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_LOST_ERROR_MSG);return r(i)}).next(function(e){return n.acquireOrExtendPrimaryLease(o).next(function(){return e})}):n.verifyAllowTabSynchronization(o).next(function(){return r(i)})}).then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.verifyAllowTabSynchronization=function(e){var t=this;return primaryClientStore(e).get(DbPrimaryClient.key).next(function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG)})},e.prototype.acquireOrExtendPrimaryLease=function(e){var t=new DbPrimaryClient(this.clientId,this.allowTabSynchronization,Date.now());return primaryClientStore(e).put(DbPrimaryClient.key,t)},e.isAvailable=function(){return SimpleDb.isAvailable()},e.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},e.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,r=primaryClientStore(e);return r.get(DbPrimaryClient.key).next(function(e){return t.isLocalClient(e)?(debug(LOG_TAG$1,"Releasing primary lease."),r.delete(DbPrimaryClient.key)):PersistencePromise.resolve()})},e.prototype.isWithinAge=function(e,t){var r=Date.now();return!(e<r-t)&&(!(e>r)||(error("Detected an update time that is in the future: "+e+" > "+r),!1))},e.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},e.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(assert(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},e.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},e.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(assert("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},e.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return debug(LOG_TAG$1,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(e){return error(LOG_TAG$1,"Failed to get zombied client id.",e),!1}},e.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){error("Failed to set zombie client id.",e)}},e.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},e.prototype.zombiedClientLocalStorageKey=function(e){return ZOMBIED_CLIENTS_KEY_PREFIX+"_"+this.persistenceKey+"_"+e},e.MAIN_DATABASE="main",e}();function isPrimaryLeaseLostError(e){return e.code===Code.FAILED_PRECONDITION&&e.message===PRIMARY_LEASE_LOST_ERROR_MSG}function ignoreIfPrimaryLeaseLoss(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){if(!isPrimaryLeaseLostError(e))throw e;return debug(LOG_TAG$1,"Unexpectedly lost primary lease"),[2]})})}function primaryClientStore(e){return e.store(DbPrimaryClient.store)}function clientMetadataStore(e){return e.store(DbClientMetadata.store)}var IndexedDbLruDelegate=function(){function e(e,t){this.db=e,this.inMemoryPins=null,this.garbageCollector=new LruGarbageCollector(this,t)}return e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,function(e,r){return t(r)})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return writeSentinelKey(e,t)},e.prototype.removeReference=function(e,t){return writeSentinelKey(e,t)},e.prototype.removeTargets=function(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)},e.prototype.removeMutationReference=function(e,t){return writeSentinelKey(e,t)},e.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?PersistencePromise.resolve(!0):mutationQueuesContainKey(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var r=this,n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(e,function(a,s){if(s<=t){var u=r.isPinned(e,a).next(function(t){if(!t)return o++,n.getEntry(e,a).next(function(){return n.removeEntry(a),documentTargetStore(e).delete(sentinelKey$1(a))})});i.push(u)}}).next(function(){return PersistencePromise.waitFor(i)}).next(function(){return n.apply(e)}).next(function(){return o})},e.prototype.removeTarget=function(e,t){var r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)},e.prototype.updateLimboDocument=function(e,t){return writeSentinelKey(e,t)},e.prototype.forEachOrphanedDocument=function(e,t){var r,n=documentTargetStore(e),i=ListenSequence.INVALID;return n.iterate({index:DbTargetDocument.documentTargetsIndex},function(e,n){var o=e[0],a=(e[1],n.path),s=n.sequenceNumber;0===o?(i!==ListenSequence.INVALID&&t(new DocumentKey(decode(r)),i),i=s,r=a):i=ListenSequence.INVALID}).next(function(){i!==ListenSequence.INVALID&&t(new DocumentKey(decode(r)),i)})},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function sentinelKey$1(e){return[0,encode(e.path)]}function sentinelRow(e,t){return new DbTargetDocument(0,encode(e.path),t)}function writeSentinelKey(e,t){return documentTargetStore(e).put(sentinelRow(t,e.currentSequenceNumber))}var NumberAsAny=Number,MIN_SAFE_INTEGER=NumberAsAny.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),MAX_SAFE_INTEGER=NumberAsAny.MAX_SAFE_INTEGER||Math.pow(2,53)-1,isInteger=NumberAsAny.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function isNullOrUndefined(e){return null==e}function isSafeInteger(e){return isInteger(e)&&e<=MAX_SAFE_INTEGER&&e>=MIN_SAFE_INTEGER}var LimitType,Target=function(){function e(e,t,r,n,i,o,a){void 0===t&&(t=null),void 0===r&&(r=[]),void 0===n&&(n=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}return e.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();null!==this.collectionGroup&&(e+="|cg:"+this.collectionGroup),e+="|f:";for(var t=0,r=this.filters;t<r.length;t++){e+=r[t].canonicalId(),e+=","}e+="|ob:";for(var n=0,i=this.orderBy;n<i.length;n++){e+=i[n].canonicalId(),e+=","}isNullOrUndefined(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},e.prototype.toString=function(){var e=this.path.canonicalString();return null!==this.collectionGroup&&(e+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(e+=", filters: ["+this.filters.join(", ")+"]"),isNullOrUndefined(this.limit)||(e+=", limit: "+this.limit),this.orderBy.length>0&&(e+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),"Target("+e+")"},e.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return this.collectionGroup===e.collectionGroup&&(!!this.path.isEqual(e.path)&&(!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)))},e.prototype.isDocumentQuery=function(){return DocumentKey.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},e}();!function(e){e.First="F",e.Last="L"}(LimitType||(LimitType={}));var Query=function(){function e(e,t,r,n,i,o,a,s){void 0===t&&(t=null),void 0===r&&(r=[]),void 0===n&&(n=[]),void 0===i&&(i=null),void 0===o&&(o=LimitType.First),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.memoizedOrderBy=null,this.memoizedTarget=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return e.atPath=function(t){return new e(t)},Object.defineProperty(e.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)e.isKeyField()?this.memoizedOrderBy=[KEY_ORDERING_ASC]:this.memoizedOrderBy=[new OrderBy(e),KEY_ORDERING_ASC];else{assert(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var r=!1,n=0,i=this.explicitOrderBy;n<i.length;n++){var o=i[n];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(r=!0)}if(!r){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Direction.ASCENDING;this.memoizedOrderBy.push(a===Direction.ASCENDING?KEY_ORDERING_ASC:KEY_ORDERING_DESC)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),e.prototype.addFilter=function(t){assert(null==this.getInequalityFilterField()||!(t instanceof FieldFilter)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),assert(!this.isDocumentQuery(),"No filtering allowed for document query");var r=this.filters.concat([t]);return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),r,this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.addOrderBy=function(t){assert(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var r=this.explicitOrderBy.concat([t]);return new e(this.path,this.collectionGroup,r,this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.withLimitToFirst=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,LimitType.First,this.startAt,this.endAt)},e.prototype.withLimitToLast=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,LimitType.Last,this.startAt,this.endAt)},e.prototype.withStartAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,t,this.endAt)},e.prototype.withEndAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,t)},e.prototype.asCollectionQueryAtPath=function(t){return new e(t,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.limitType,this.startAt,this.endAt)},e.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},e.prototype.canonicalId=function(){return this.toTarget().canonicalId()+"|lt:"+this.limitType},e.prototype.toString=function(){return"Query(target="+this.toTarget().toString()+"; limitType="+this.limitType+")"},e.prototype.isEqual=function(e){return this.toTarget().isEqual(e.toTarget())&&this.limitType===e.limitType},e.prototype.docComparator=function(e,t){for(var r=!1,n=0,i=this.orderBy;n<i.length;n++){var o=i[n],a=o.compare(e,t);if(0!==a)return a;r=r||o.field.isKeyField()}return assert(r,"orderBy used that doesn't compare on key field"),0},e.prototype.matches=function(e){return this.matchesPathAndCollectionGroup(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},e.prototype.hasLimitToFirst=function(){return!isNullOrUndefined(this.limit)&&this.limitType===LimitType.First},e.prototype.hasLimitToLast=function(){return!isNullOrUndefined(this.limit)&&this.limitType===LimitType.Last},e.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},e.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var r=t[e];if(r instanceof FieldFilter&&r.isInequality())return r.field}return null},e.prototype.findFilterOperator=function(e){for(var t=0,r=this.filters;t<r.length;t++){var n=r[t];if(n instanceof FieldFilter&&e.indexOf(n.op)>=0)return n.op}return null},e.prototype.isDocumentQuery=function(){return this.toTarget().isDocumentQuery()},e.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},e.prototype.toTarget=function(){if(!this.memoizedTarget)if(this.limitType===LimitType.First)this.memoizedTarget=new Target(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var e=[],t=0,r=this.orderBy;t<r.length;t++){var n=r[t],i=n.dir===Direction.DESCENDING?Direction.ASCENDING:Direction.DESCENDING;e.push(new OrderBy(n.field,i))}var o=this.endAt?new Bound(this.endAt.position,!this.endAt.before):null,a=this.startAt?new Bound(this.startAt.position,!this.startAt.before):null;this.memoizedTarget=new Target(this.path,this.collectionGroup,e,this.filters,this.limit,o,a)}return this.memoizedTarget},e.prototype.matchesPathAndCollectionGroup=function(e){var t=e.key.path;return null!==this.collectionGroup?e.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(t):DocumentKey.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isImmediateParentOf(t)},e.prototype.matchesOrderBy=function(e){for(var t=0,r=this.explicitOrderBy;t<r.length;t++){var n=r[t];if(!n.field.isKeyField()&&null===e.field(n.field))return!1}return!0},e.prototype.matchesFilters=function(e){for(var t=0,r=this.filters;t<r.length;t++){if(!r[t].matches(e))return!1}return!0},e.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,e))},e.prototype.assertValidBound=function(e){assert(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},e}(),Filter=function(){return function(){}}(),Operator=function(){function e(e){this.name=e}return e.fromString=function(t){switch(t){case"<":return e.LESS_THAN;case"<=":return e.LESS_THAN_OR_EQUAL;case"==":return e.EQUAL;case">=":return e.GREATER_THAN_OR_EQUAL;case">":return e.GREATER_THAN;case"array-contains":return e.ARRAY_CONTAINS;case"in":return e.IN;case"array-contains-any":return e.ARRAY_CONTAINS_ANY;default:return fail("Unknown FieldFilter operator: "+t)}},e.prototype.toString=function(){return this.name},e.prototype.isEqual=function(e){return this.name===e.name},e.LESS_THAN=new e("<"),e.LESS_THAN_OR_EQUAL=new e("<="),e.EQUAL=new e("=="),e.GREATER_THAN=new e(">"),e.GREATER_THAN_OR_EQUAL=new e(">="),e.ARRAY_CONTAINS=new e("array-contains"),e.IN=new e("in"),e.ARRAY_CONTAINS_ANY=new e("array-contains-any"),e}(),FieldFilter=function(e){function t(t,r,n){var i=e.call(this)||this;return i.field=t,i.op=r,i.value=n,i}return tslib.__extends(t,e),t.create=function(e,r,n){if(e.isKeyField())return r===Operator.IN?(assert(n instanceof ArrayValue,"Comparing on key with IN, but filter value not an ArrayValue"),assert(n.internalValue.every(function(e){return e instanceof RefValue}),"Comparing on key with IN, but an array value was not a RefValue"),new KeyFieldInFilter(e,n)):(assert(n instanceof RefValue,"Comparing on key, but filter value not a RefValue"),assert(r!==Operator.ARRAY_CONTAINS&&r!==Operator.ARRAY_CONTAINS_ANY,"'"+r.toString()+"' queries don't make sense on document keys."),new KeyFieldFilter(e,r,n));if(n.isEqual(NullValue.INSTANCE)){if(r!==Operator.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new t(e,r,n)}if(n.isEqual(DoubleValue.NAN)){if(r!==Operator.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new t(e,r,n)}return r===Operator.ARRAY_CONTAINS?new ArrayContainsFilter(e,n):r===Operator.IN?(assert(n instanceof ArrayValue,"IN filter has invalid value: "+n.toString()),new InFilter(e,n)):r===Operator.ARRAY_CONTAINS_ANY?(assert(n instanceof ArrayValue,"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new ArrayContainsAnyFilter(e,n)):new t(e,r,n)},t.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case Operator.LESS_THAN:return e<0;case Operator.LESS_THAN_OR_EQUAL:return e<=0;case Operator.EQUAL:return 0===e;case Operator.GREATER_THAN:return e>0;case Operator.GREATER_THAN_OR_EQUAL:return e>=0;default:return fail("Unknown FieldFilter operator: "+this.op)}},t.prototype.isInequality=function(){return[Operator.LESS_THAN,Operator.LESS_THAN_OR_EQUAL,Operator.GREATER_THAN,Operator.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&(this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value))},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(Filter),KeyFieldFilter=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.matches=function(e){var t=this.value,r=DocumentKey.comparator(e.key,t.key);return this.matchesComparison(r)},t}(FieldFilter),KeyFieldInFilter=function(e){function t(t,r){var n=e.call(this,t,Operator.IN,r)||this;return n.value=r,n}return tslib.__extends(t,e),t.prototype.matches=function(e){return this.value.internalValue.some(function(t){return e.key.isEqual(t.key)})},t}(FieldFilter),ArrayContainsFilter=function(e){function t(t,r){return e.call(this,t,Operator.ARRAY_CONTAINS,r)||this}return tslib.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return t instanceof ArrayValue&&t.contains(this.value)},t}(FieldFilter),InFilter=function(e){function t(t,r){var n=e.call(this,t,Operator.IN,r)||this;return n.value=r,n}return tslib.__extends(t,e),t.prototype.matches=function(e){var t=this.value,r=e.field(this.field);return null!==r&&t.contains(r)},t}(FieldFilter),ArrayContainsAnyFilter=function(e){function t(t,r){var n=e.call(this,t,Operator.ARRAY_CONTAINS_ANY,r)||this;return n.value=r,n}return tslib.__extends(t,e),t.prototype.matches=function(e){var t=this,r=e.field(this.field);return r instanceof ArrayValue&&r.internalValue.some(function(e){return t.value.contains(e)})},t}(FieldFilter),Direction=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),Bound=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,r=this.position;t<r.length;t++){e+=r[t].toString()}return e},e.prototype.sortsBeforeDocument=function(e,t){assert(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var r=0,n=0;n<this.position.length;n++){var i=e[n],o=this.position[n];if(i.field.isKeyField())assert(o instanceof RefValue,"Bound has a non-key value where the key path is being used."),r=DocumentKey.comparator(o.key,t.key);else{var a=t.field(i.field);assert(null!==a,"Field should exist since document matched the orderBy already."),r=o.compareTo(a)}if(i.dir===Direction.DESCENDING&&(r*=-1),0!==r)break}return this.before?r<=0:r<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++){var r=this.position[t],n=e.position[t];if(!r.isEqual(n))return!1}return!0},e}(),OrderBy=function(){function e(e,t){this.field=e,void 0===t&&(t=Direction.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var r=this.isKeyOrderBy?Document.compareByKey(e,t):Document.compareByField(this.field,e,t);switch(this.dir){case Direction.ASCENDING:return r;case Direction.DESCENDING:return-1*r;default:return fail("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),KEY_ORDERING_ASC=new OrderBy(FieldPath.keyField(),Direction.ASCENDING),KEY_ORDERING_DESC=new OrderBy(FieldPath.keyField(),Direction.DESCENDING),IndexFreeQueryEngine=function(){function e(){}return e.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},e.prototype.getDocumentsMatchingQuery=function(e,t,r,n){var i=this;return assert(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),t.matchesAllDocuments()?this.executeFullCollectionScan(e,t):r.isEqual(SnapshotVersion.MIN)?this.executeFullCollectionScan(e,t):this.localDocumentsView.getDocuments(e,n).next(function(o){var a=i.applyQuery(t,o);return(t.hasLimitToFirst()||t.hasLimitToLast())&&i.needsRefill(t.limitType,a,n,r)?i.executeFullCollectionScan(e,t):(getLogLevel()<=LogLevel.DEBUG&&debug("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),t.toString()),i.localDocumentsView.getDocumentsMatchingQuery(e,t,r).next(function(e){return a.forEach(function(t){e=e.insert(t.key,t)}),e}))})},e.prototype.applyQuery=function(e,t){var r=new SortedSet(function(t,r){return e.docComparator(t,r)});return t.forEach(function(t,n){n instanceof Document&&e.matches(n)&&(r=r.add(n))}),r},e.prototype.needsRefill=function(e,t,r,n){if(r.size!==t.size)return!0;var i=e===LimitType.First?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(n)>0)},e.prototype.executeFullCollectionScan=function(e,t){return getLogLevel()<=LogLevel.DEBUG&&debug("IndexFreeQueryEngine","Using full collection scan to execute query: %s",t.toString()),this.localDocumentsView.getDocumentsMatchingQuery(e,t,SnapshotVersion.MIN)},e}(),LocalDocumentsView=function(){function e(e,t,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=r}return e.prototype.getDocument=function(e,t){var r=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(n){return r.getDocumentInternal(e,t,n)})},e.prototype.getDocumentInternal=function(e,t,r){return this.remoteDocumentCache.getEntry(e,t).next(function(e){for(var n=0,i=r;n<i.length;n++){e=i[n].applyToLocalView(t,e)}return e})},e.prototype.applyLocalMutationsToDocuments=function(e,t,r){var n=nullableMaybeDocumentMap();return t.forEach(function(e,t){for(var i=0,o=r;i<o.length;i++){t=o[i].applyToLocalView(e,t)}n=n.insert(e,t)}),n},e.prototype.getDocuments=function(e,t){var r=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return r.getLocalViewOfDocuments(e,t)})},e.prototype.getLocalViewOfDocuments=function(e,t){var r=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(n){var i=r.applyLocalMutationsToDocuments(e,t,n),o=maybeDocumentMap();return i.forEach(function(e,t){t||(t=new NoDocument(e,SnapshotVersion.forDeletedDoc())),o=o.insert(e,t)}),o})},e.prototype.getDocumentsMatchingQuery=function(e,t,r){return t.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(e,t.path):t.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new DocumentKey(t)).next(function(e){var t=documentMap();return e instanceof Document&&(t=t.insert(e.key,e)),t})},e.prototype.getDocumentsMatchingCollectionGroupQuery=function(e,t,r){var n=this;assert(t.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=t.collectionGroup,o=documentMap();return this.indexManager.getCollectionParents(e,i).next(function(a){return PersistencePromise.forEach(a,function(a){var s=t.asCollectionQueryAtPath(a.child(i));return n.getDocumentsMatchingCollectionQuery(e,s,r).next(function(e){e.forEach(function(e,t){o=o.insert(e,t)})})}).next(function(){return o})})},e.prototype.getDocumentsMatchingCollectionQuery=function(e,t,r){var n,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r).next(function(r){return n=r,o.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return i=t,o.addMissingBaseDocuments(e,i,n).next(function(e){n=e;for(var t=0,r=i;t<r.length;t++)for(var o=r[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=n.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);n=h instanceof Document?n.insert(c,h):n.remove(c)}})}).next(function(){return n.forEach(function(e,r){t.matches(r)||(n=n.remove(e))}),n})},e.prototype.addMissingBaseDocuments=function(e,t,r){for(var n=documentKeySet(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof PatchMutation&&null===r.get(u.key)&&(n=n.add(u.key))}var c=r;return this.remoteDocumentCache.getEntries(e,n).next(function(e){return e.forEach(function(e,t){null!==t&&t instanceof Document&&(c=c.insert(e,t))}),c})},e}(),ReferenceSet=function(){function e(){this.refsByKey=new SortedSet(DocReference.compareByKey),this.refsByTarget=new SortedSet(DocReference.compareByTargetId)}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var r=new DocReference(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)},e.prototype.addReferences=function(e,t){var r=this;e.forEach(function(e){return r.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.removeRef(new DocReference(e,t))},e.prototype.removeReferences=function(e,t){var r=this;e.forEach(function(e){return r.removeReference(e,t)})},e.prototype.removeReferencesForId=function(e){var t=this,r=DocumentKey.EMPTY,n=new DocReference(r,e),i=new DocReference(r,e+1),o=[];return this.refsByTarget.forEachInRange([n,i],function(e){t.removeRef(e),o.push(e.key)}),o},e.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach(function(t){return e.removeRef(t)})},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},e.prototype.referencesForId=function(e){var t=DocumentKey.EMPTY,r=new DocReference(t,e),n=new DocReference(t,e+1),i=documentKeySet();return this.refsByTarget.forEachInRange([r,n],function(e){i=i.add(e.key)}),i},e.prototype.containsKey=function(e){var t=new DocReference(e,0),r=this.refsByKey.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)},e}(),DocReference=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return DocumentKey.comparator(e.key,t.key)||primitiveComparator(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return primitiveComparator(e.targetOrBatchId,t.targetOrBatchId)||DocumentKey.comparator(e.key,t.key)},e}(),LOG_TAG$2="LocalStore",LocalStore=function(){function e(e,t,r){this.persistence=e,this.queryEngine=t,this.localViewReferences=new ReferenceSet,this.targetDataByTarget=new SortedMap(primitiveComparator),this.targetIdByTarget=new ObjectMap(function(e){return e.canonicalId()}),this.lastDocumentChangeReadTime=SnapshotVersion.MIN,assert(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(r),this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.localDocuments=new LocalDocumentsView(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return e.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},e.prototype.handleUserChange=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n,i=this;return tslib.__generator(this,function(o){switch(o.label){case 0:return t=this.mutationQueue,r=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",function(n){var o;return i.mutationQueue.getAllMutationBatches(n).next(function(a){return o=a,t=i.persistence.getMutationQueue(e),r=new LocalDocumentsView(i.remoteDocuments,t,i.persistence.getIndexManager()),t.getAllMutationBatches(n)}).next(function(e){for(var t=[],i=[],a=documentKeySet(),s=0,u=o;s<u.length;s++){var c=u[s];t.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var d=h[l];a=a.add(d.key)}}for(var f=0,p=e;f<p.length;f++){c=p[f];i.push(c.batchId);for(var m=0,y=c.mutations;m<y.length;m++){d=y[m];a=a.add(d.key)}}return r.getDocuments(n,a).next(function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:i}})})})];case 1:return n=o.sent(),this.mutationQueue=t,this.localDocuments=r,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,n]}})})},e.prototype.localWrite=function(e){var t,r=this,n=Timestamp.now(),i=e.reduce(function(e,t){return e.add(t.key)},documentKeySet());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",function(o){return r.localDocuments.getDocuments(o,i).next(function(i){t=i;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=c.extractBaseValue(t.get(c.key));null!=l&&a.push(new PatchMutation(c.key,l,l.fieldMask(),Precondition.exists(!0)))}return r.mutationQueue.addMutationBatch(o,n,a,e)})}).then(function(e){var r=e.applyToLocalDocumentSet(t);return{batchId:e.batchId,changes:r}})},e.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",function(r){return t.mutationQueue.lookupMutationKeys(r,e).next(function(e){return e?t.localDocuments.getDocuments(r,e):PersistencePromise.resolve(null)})})},e.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",function(r){var n=e.batch.keys(),i=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return t.mutationQueue.acknowledgeBatch(r,e.batch,e.streamToken).next(function(){return t.applyWriteToRemoteDocuments(r,e,i)}).next(function(){return i.apply(r)}).next(function(){return t.mutationQueue.performConsistencyCheck(r)}).next(function(){return t.localDocuments.getDocuments(r,n)})})},e.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",function(r){var n;return t.mutationQueue.lookupMutationBatch(r,e).next(function(e){return assert(null!==e,"Attempt to reject nonexistent batch!"),n=e.keys(),t.mutationQueue.removeMutationBatch(r,e)}).next(function(){return t.mutationQueue.performConsistencyCheck(r)}).next(function(){return t.localDocuments.getDocuments(r,n)})})},e.prototype.getHighestUnacknowledgedBatchId=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",function(t){return e.mutationQueue.getHighestUnacknowledgedBatchId(t)})},e.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",function(t){return e.mutationQueue.getLastStreamToken(t)})},e.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",function(r){return t.mutationQueue.setLastStreamToken(r,e)})},e.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",function(t){return e.targetCache.getLastRemoteSnapshotVersion(t)})},e.prototype.applyRemoteEvent=function(t){var r=this,n=t.snapshotVersion,i=this.targetDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",function(o){var a=r.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=r.targetDataByTarget;var s=[];forEachNumber(t.targetChanges,function(t,a){var u=i.get(t);if(u){s.push(r.targetCache.removeMatchingKeys(o,a.removedDocuments,t).next(function(){return r.targetCache.addMatchingKeys(o,a.addedDocuments,t)}));var c=a.resumeToken;if(c.length>0){var l=u.withResumeToken(c,n).withSequenceNumber(o.currentSequenceNumber);i=i.insert(t,l),e.shouldPersistTargetData(u,l,a)&&s.push(r.targetCache.updateTargetData(o,l))}}});var u=maybeDocumentMap(),c=documentKeySet();if(t.documentUpdates.forEach(function(e,t){c=c.add(e)}),s.push(a.getEntries(o,c).next(function(e){t.documentUpdates.forEach(function(i,c){var l=e.get(i);c instanceof NoDocument&&c.version.isEqual(SnapshotVersion.MIN)?(a.removeEntry(i,n),u=u.insert(i,c)):null==l||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(assert(!SnapshotVersion.MIN.isEqual(n),"Cannot add a document when the remote version is zero"),a.addEntry(c,n),u=u.insert(i,c)):debug(LOG_TAG$2,"Ignoring outdated watch update for ",i,". Current version:",l.version," Watch version:",c.version),t.resolvedLimboDocuments.has(i)&&s.push(r.persistence.referenceDelegate.updateLimboDocument(o,i))})})),!n.isEqual(SnapshotVersion.MIN)){var l=r.targetCache.getLastRemoteSnapshotVersion(o).next(function(e){return assert(n.compareTo(e)>=0,"Watch stream reverted to previous snapshot?? "+n+" < "+e),r.targetCache.setTargetsMetadata(o,o.currentSequenceNumber,n)});s.push(l)}return PersistencePromise.waitFor(s).next(function(){return a.apply(o)}).next(function(){return r.localDocuments.getLocalViewOfDocuments(o,u)})}).then(function(e){return r.targetDataByTarget=i,e})},e.shouldPersistTargetData=function(e,t,r){return assert(t.resumeToken.length>0,"Attempted to persist target data with no resume token"),0===e.resumeToken.length||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0)},e.prototype.notifyLocalViewChanges=function(e){for(var t=this,r=0,n=e;r<n.length;r++){var i=n[r],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.targetDataByTarget.get(o);assert(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.snapshotVersion,u=a.withLastLimboFreeSnapshotVersion(s);this.targetDataByTarget=this.targetDataByTarget.insert(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",function(r){return PersistencePromise.forEach(e,function(e){return PersistencePromise.forEach(e.removedKeys,function(e){return t.persistence.referenceDelegate.removeReference(r,e)})})})},e.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",function(r){return void 0===e&&(e=BATCHID_UNKNOWN),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)})},e.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly-idempotent",function(r){return t.localDocuments.getDocument(r,e)})},e.prototype.allocateTarget=function(e){var t=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",function(r){var n;return t.targetCache.getTargetData(r,e).next(function(i){return i?(n=i,PersistencePromise.resolve(n)):t.targetCache.allocateTargetId(r).next(function(i){return n=new TargetData(e,i,TargetPurpose.Listen,r.currentSequenceNumber),t.targetCache.addTargetData(r,n).next(function(){return n})})})}).then(function(r){return null===t.targetDataByTarget.get(r.targetId)&&(t.targetDataByTarget=t.targetDataByTarget.insert(r.targetId,r),t.targetIdByTarget.set(e,r.targetId)),r})},e.prototype.getTargetData=function(e,t){var r=this.targetIdByTarget.get(t);return void 0!==r?PersistencePromise.resolve(this.targetDataByTarget.get(r)):this.targetCache.getTargetData(e,t)},e.prototype.releaseTarget=function(e,t){var r=this,n=this.targetDataByTarget.get(e);assert(null!==n,"Tried to release nonexistent target: "+e);var i=t?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,function(i){var o=r.localViewReferences.removeReferencesForId(e);return t?PersistencePromise.resolve():PersistencePromise.forEach(o,function(e){return r.persistence.referenceDelegate.removeReference(i,e)}).next(function(){r.persistence.referenceDelegate.removeTarget(i,n)})}).then(function(){r.targetDataByTarget=r.targetDataByTarget.remove(e),r.targetIdByTarget.delete(n.target)})},e.prototype.executeQuery=function(e,t){var r=this,n=SnapshotVersion.MIN,i=documentKeySet();return this.persistence.runTransaction("Execute query","readonly-idempotent",function(o){return r.getTargetData(o,e.toTarget()).next(function(e){if(e)return n=e.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(o,e.targetId).next(function(e){i=e})}).next(function(){return r.queryEngine.getDocumentsMatchingQuery(o,e,t?n:SnapshotVersion.MIN,t?i:documentKeySet())}).next(function(e){return{documents:e,remoteKeys:i}})})},e.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",function(r){return t.targetCache.getMatchingKeysForTargetId(r,e)})},e.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},e.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},e.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},e.prototype.applyWriteToRemoteDocuments=function(e,t,r){var n=this,i=t.batch,o=i.keys(),a=PersistencePromise.resolve();return o.forEach(function(n){a=a.next(function(){return r.getEntry(e,n)}).next(function(e){var o=e,a=t.docVersions.get(n);assert(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(n,o,t))?r.addEntry(o,t.commitVersion):assert(!e,"Mutation batch "+i+" applied to document "+e+" resulted in null"))})}),a.next(function(){return n.mutationQueue.removeMutationBatch(e,i)})},e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",function(r){return e.collect(r,t.targetDataByTarget)})},e.prototype.getTarget=function(e){var t=this,r=this.targetDataByTarget.get(e);return r?Promise.resolve(r.target):this.persistence.runTransaction("Get target data","readonly-idempotent",function(r){return t.targetCache.getTargetDataForTarget(r,e).next(function(e){return e?e.target:null})})},e.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",function(t){return e.remoteDocuments.getNewDocumentChanges(t,e.lastDocumentChangeReadTime)}).then(function(t){var r=t.changedDocs,n=t.readTime;return e.lastDocumentChangeReadTime=n,r})},e.prototype.synchronizeLastDocumentChangeReadTime=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e,t=this;return tslib.__generator(this,function(r){return this.remoteDocuments instanceof IndexedDbRemoteDocumentCache?(e=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",function(t){return e.getLastDocumentChange(t)}).then(function(e){var r=e.readTime;t.lastDocumentChangeReadTime=r})]):[2]})})},e.RESUME_TOKEN_MAX_AGE_MICROS=3e8,e}(),MemoryMutationQueue=function(){function e(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=emptyByteString(),this.batchesByDocumentKey=new SortedSet(DocReference.compareByKey)}return e.prototype.checkEmpty=function(e){return PersistencePromise.resolve(0===this.mutationQueue.length)},e.prototype.acknowledgeBatch=function(e,t,r){var n=t.batchId,i=this.indexOfExistingBatchId(n,"acknowledged");assert(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return assert(n===o.batchId,"Queue ordering failure: expected batch "+n+", got batch "+o.batchId),this.lastStreamToken=r,PersistencePromise.resolve()},e.prototype.getLastStreamToken=function(e){return PersistencePromise.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,PersistencePromise.resolve()},e.prototype.addMutationBatch=function(e,t,r,n){assert(0!==n.length,"Mutation batches should not be empty");var i=this.nextBatchId;(this.nextBatchId++,this.mutationQueue.length>0)&&assert(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new MutationBatch(i,t,r,n);this.mutationQueue.push(o);for(var a=0,s=n;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new DocReference(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}return PersistencePromise.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return PersistencePromise.resolve(this.findMutationBatch(t))},e.prototype.lookupMutationKeys=function(e,t){var r=this.findMutationBatch(t);return assert(null!=r,"Failed to find local mutation batch."),PersistencePromise.resolve(r.keys())},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var r=t+1,n=this.indexOfBatchId(r),i=n<0?0:n;return PersistencePromise.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return PersistencePromise.resolve(0===this.mutationQueue.length?BATCHID_UNKNOWN:this.nextBatchId-1)},e.prototype.getAllMutationBatches=function(e){return PersistencePromise.resolve(this.mutationQueue.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var r=this,n=new DocReference(t,0),i=new DocReference(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([n,i],function(e){assert(t.isEqual(e.key),"Should only iterate over a single key's batches");var n=r.findMutationBatch(e.targetOrBatchId);assert(null!==n,"Batches in the index must exist in the main table"),o.push(n)}),PersistencePromise.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var r=this,n=new SortedSet(primitiveComparator);return t.forEach(function(e){var t=new DocReference(e,0),i=new DocReference(e,Number.POSITIVE_INFINITY);r.batchesByDocumentKey.forEachInRange([t,i],function(t){assert(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),n=n.add(t.targetOrBatchId)})}),PersistencePromise.resolve(this.findMutationBatches(n))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){assert(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=t.path,n=r.length+1,i=r;DocumentKey.isDocumentKey(i)||(i=i.child(""));var o=new DocReference(new DocumentKey(i),0),a=new SortedSet(primitiveComparator);return this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(a=a.add(e.targetOrBatchId)),!0)},o),PersistencePromise.resolve(this.findMutationBatches(a))},e.prototype.findMutationBatches=function(e){var t=this,r=[];return e.forEach(function(e){var n=t.findMutationBatch(e);null!==n&&r.push(n)}),r},e.prototype.removeMutationBatch=function(e,t){var r=this;assert(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var n=this.batchesByDocumentKey;return PersistencePromise.forEach(t.mutations,function(i){var o=new DocReference(i.key,t.batchId);return n=n.delete(o),r.referenceDelegate.removeMutationReference(e,i.key)}).next(function(){r.batchesByDocumentKey=n})},e.prototype.removeCachedMutationKeys=function(e){},e.prototype.containsKey=function(e,t){var r=new DocReference(t,0),n=this.batchesByDocumentKey.firstAfterOrEqual(r);return PersistencePromise.resolve(t.isEqual(n&&n.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&assert(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),PersistencePromise.resolve()},e.prototype.indexOfExistingBatchId=function(e,t){var r=this.indexOfBatchId(e);return assert(r>=0&&r<this.mutationQueue.length,"Batches must exist to be "+t),r},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var r=this.mutationQueue[t];return assert(r.batchId===e,"If found batch must match"),r},e}();function documentEntryMap(){return new SortedMap(DocumentKey.comparator)}var PersistentStreamState,MemoryRemoteDocumentCache=function(){function e(e,t){this.indexManager=e,this.sizer=t,this.docs=documentEntryMap(),this.size=0}return e.prototype.addEntry=function(e,t,r){assert(!r.isEqual(SnapshotVersion.MIN),"Cannot add a document with a read time of zero");var n=t.key,i=this.docs.get(n),o=i?i.size:0,a=this.sizer(t);return this.docs=this.docs.insert(n,{maybeDocument:t,size:a,readTime:r}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var r=this.docs.get(t);return PersistencePromise.resolve(r?r.maybeDocument:null)},e.prototype.getEntries=function(e,t){var r=this,n=nullableMaybeDocumentMap();return t.forEach(function(e){var t=r.docs.get(e);n=n.insert(e,t?t.maybeDocument:null)}),PersistencePromise.resolve(n)},e.prototype.getDocumentsMatchingQuery=function(e,t,r){assert(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=documentMap(),i=new DocumentKey(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.maybeDocument,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(r)<=0||c instanceof Document&&t.matches(c)&&(n=n.insert(c.key,c))}return PersistencePromise.resolve(n)},e.prototype.forEachDocumentKey=function(e,t){return PersistencePromise.forEach(this.docs,function(e){return t(e)})},e.prototype.getNewDocumentChanges=function(e,t){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this)},e.prototype.getSize=function(e){return PersistencePromise.resolve(this.size)},e.RemoteDocumentChangeBuffer=function(e){function t(t){var r=e.call(this)||this;return r.documentCache=t,r}return tslib.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,r=[];return this.changes.forEach(function(n,i){i?r.push(t.documentCache.addEntry(e,i,t.readTime)):t.documentCache.removeEntry(n)}),PersistencePromise.waitFor(r)},t.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},t}(RemoteDocumentChangeBuffer),e}(),MemoryTargetCache=function(){function e(e){this.persistence=e,this.targets=new ObjectMap(function(e){return e.canonicalId()}),this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ReferenceSet,this.targetCount=0,this.targetIdGenerator=TargetIdGenerator.forTargetCache()}return e.prototype.forEachTarget=function(e,t){return this.targets.forEach(function(e,r){return t(r)}),PersistencePromise.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return PersistencePromise.resolve(this.highestSequenceNumber)},e.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,PersistencePromise.resolve(t)},e.prototype.setTargetsMetadata=function(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),PersistencePromise.resolve()},e.prototype.saveTargetData=function(e){this.targets.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return assert(!this.targets.has(t.target),"Adding a target that already exists"),this.saveTargetData(t),this.targetCount+=1,PersistencePromise.resolve()},e.prototype.updateTargetData=function(e,t){return assert(this.targets.has(t.target),"Updating a non-existent target"),this.saveTargetData(t),PersistencePromise.resolve()},e.prototype.removeTargetData=function(e,t){return assert(this.targetCount>0,"Removing a target from an empty cache"),assert(this.targets.has(t.target),"Removing a non-existent target from the cache"),this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,PersistencePromise.resolve()},e.prototype.removeTargets=function(e,t,r){var n=this,i=0,o=[];return this.targets.forEach(function(a,s){s.sequenceNumber<=t&&null===r.get(s.targetId)&&(n.targets.delete(a),o.push(n.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),PersistencePromise.waitFor(o).next(function(){return i})},e.prototype.getTargetCount=function(e){return PersistencePromise.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var r=this.targets.get(t)||null;return PersistencePromise.resolve(r)},e.prototype.getTargetDataForTarget=function(e,t){return fail("Not yet implemented.")},e.prototype.addMatchingKeys=function(e,t,r){this.references.addReferences(t,r);var n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(function(t){i.push(n.addReference(e,t))}),PersistencePromise.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,r){this.references.removeReferences(t,r);var n=this.persistence.referenceDelegate,i=[];return n&&t.forEach(function(t){i.push(n.removeReference(e,t))}),PersistencePromise.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),PersistencePromise.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var r=this.references.referencesForId(t);return PersistencePromise.resolve(r)},e.prototype.containsKey=function(e,t){return PersistencePromise.resolve(this.references.containsKey(t))},e}(),LOG_TAG$3="MemoryPersistence",MemoryPersistence=function(){function e(e,t){var r=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new ListenSequence(0),this._started=!1,this._started=!0,this.referenceDelegate=t(this),this.targetCache=new MemoryTargetCache(this);this.indexManager=new MemoryIndexManager,this.remoteDocumentCache=new MemoryRemoteDocumentCache(this.indexManager,function(e){return r.referenceDelegate.documentSize(e)})}return e.createLruPersistence=function(t,r,n){return new e(t,function(e){return new MemoryLruDelegate(e,new LocalSerializer(r),n)})},e.createEagerPersistence=function(t){return new e(t,function(e){return new MemoryEagerDelegate(e)})},e.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getActiveClients=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){return[2,[this.clientId]]})})},e.prototype.setPrimaryStateListener=function(e){return e(!0)},e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(e){},e.prototype.getIndexManager=function(){return this.indexManager},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new MemoryMutationQueue(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.targetCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,r){var n=this;debug(LOG_TAG$3,"Starting transaction:",e);var i=new MemoryTransaction(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(function(e){return n.referenceDelegate.onTransactionCommitted(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.mutationQueuesContainKey=function(e,t){return PersistencePromise.or(values(this.mutationQueues).map(function(r){return function(){return r.containsKey(e,t)}}))},e}(),MemoryTransaction=function(e){function t(t){var r=e.call(this)||this;return r.currentSequenceNumber=t,r}return tslib.__extends(t,e),t}(PersistenceTransaction),MemoryEagerDelegate=function(){function e(e){this.persistence=e,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(e.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw fail("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),PersistencePromise.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),PersistencePromise.resolve()},e.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),PersistencePromise.resolve()},e.prototype.removeTarget=function(e,t){var r=this,n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return r.orphanedDocuments.add(e)})}).next(function(){return n.removeTargetData(e,t)})},e.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},e.prototype.onTransactionCommitted=function(e){var t=this,r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.orphanedDocuments,function(n){return t.isReferenced(e,n).next(function(e){e||r.removeEntry(n)})}).next(function(){return t._orphanedDocuments=null,r.apply(e)})},e.prototype.updateLimboDocument=function(e,t){var r=this;return this.isReferenced(e,t).next(function(e){e?r.orphanedDocuments.delete(t):r.orphanedDocuments.add(t)})},e.prototype.documentSize=function(e){return 0},e.prototype.isReferenced=function(e,t){var r=this;return PersistencePromise.or([function(){return r.persistence.getTargetCache().containsKey(e,t)},function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return PersistencePromise.resolve(r.inMemoryPins.containsKey(t))}])},e}(),MemoryLruDelegate=function(){function e(e,t,r){this.persistence=e,this.serializer=t,this.inMemoryPins=null,this.orphanedSequenceNumbers=new ObjectMap(function(e){return encode(e.path)}),this.garbageCollector=new LruGarbageCollector(this,r)}return e.prototype.onTransactionStarted=function(){},e.prototype.onTransactionCommitted=function(e){return PersistencePromise.resolve()},e.prototype.forEachTarget=function(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)},e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var r=this;return PersistencePromise.forEach(this.orphanedSequenceNumbers,function(n,i){return r.isPinned(e,n,i).next(function(e){return e?PersistencePromise.resolve():t(i)})})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.removeTargets=function(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)},e.prototype.removeOrphanedDocuments=function(e,t){var r=this,n=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(e,function(i){return r.isPinned(e,i,t).next(function(e){e||(n++,o.removeEntry(i))})}).next(function(){return o.apply(e)}).next(function(){return n})},e.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),PersistencePromise.resolve()},e.prototype.removeTarget=function(e,t){var r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)},e.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),PersistencePromise.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),PersistencePromise.resolve()},e.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),PersistencePromise.resolve()},e.prototype.documentSize=function(e){var t,r=this.serializer.toDbRemoteDocument(e,e.version);if(r.document)t=r.document;else if(r.unknownDocument)t=r.unknownDocument;else{if(!r.noDocument)throw fail("Unknown remote document type");t=r.noDocument}return JSON.stringify(t).length},e.prototype.isPinned=function(e,t,r){var n=this;return PersistencePromise.or([function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return PersistencePromise.resolve(n.inMemoryPins.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){var e=n.orphanedSequenceNumbers.get(t);return PersistencePromise.resolve(void 0!==e&&e>r)}])},e.prototype.getCacheSize=function(e){return this.persistence.getRemoteDocumentCache().getSize(e)},e}(),LOG_TAG$4="ExponentialBackoff",DEFAULT_BACKOFF_INITIAL_DELAY_MS=1e3,DEFAULT_BACKOFF_FACTOR=1.5,DEFAULT_BACKOFF_MAX_DELAY_MS=6e4,ExponentialBackoff=function(){function e(e,t,r,n,i){void 0===r&&(r=DEFAULT_BACKOFF_INITIAL_DELAY_MS),void 0===n&&(n=DEFAULT_BACKOFF_FACTOR),void 0===i&&(i=DEFAULT_BACKOFF_MAX_DELAY_MS),this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=n,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){var t=this;this.cancel();var r=Math.floor(this.currentBaseMs+this.jitterDelayMs()),n=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,r-n);this.currentBaseMs>0&&debug(LOG_TAG$4,"Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+r+" ms, last attempt: "+n+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return t.lastAttemptTime=Date.now(),e()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}(),LOG_TAG$5="PersistentStream";!function(e){e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.Open=2]="Open",e[e.Error=3]="Error",e[e.Backoff=4]="Backoff"}(PersistentStreamState||(PersistentStreamState={}));var OnlineState,OnlineStateSource,IDLE_TIMEOUT_MS=6e4,PersistentStream=function(){function e(e,t,r,n,i,o){this.queue=e,this.idleTimerId=r,this.connection=n,this.credentialsProvider=i,this.listener=o,this.state=PersistentStreamState.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ExponentialBackoff(e,t)}return e.prototype.isStarted=function(){return this.state===PersistentStreamState.Starting||this.state===PersistentStreamState.Open||this.state===PersistentStreamState.Backoff},e.prototype.isOpen=function(){return this.state===PersistentStreamState.Open},e.prototype.start=function(){this.state!==PersistentStreamState.Error?(assert(this.state===PersistentStreamState.Initial,"Already started"),this.auth()):this.performBackoff()},e.prototype.stop=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(PersistentStreamState.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.inhibitBackoff=function(){assert(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=PersistentStreamState.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,IDLE_TIMEOUT_MS,function(){return e.handleIdleCloseTimer()}))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){return this.isOpen()?[2,this.close(PersistentStreamState.Initial)]:[2]})})},e.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},e.prototype.close=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(r){switch(r.label){case 0:return assert(this.isStarted(),"Only started streams should be closed."),assert(e===PersistentStreamState.Error||isNullOrUndefined(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==PersistentStreamState.Error?this.backoff.reset():t&&t.code===Code.RESOURCE_EXHAUSTED?(error(t.toString()),error("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===Code.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return r.sent(),[2]}})})},e.prototype.tearDown=function(){},e.prototype.auth=function(){var e=this;assert(this.state===PersistentStreamState.Initial,"Must be in initial state to auth"),this.state=PersistentStreamState.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),r=this.closeCount;this.credentialsProvider.getToken().then(function(t){e.closeCount===r&&e.startStream(t)},function(r){t(function(){var t=new FirestoreError(Code.UNKNOWN,"Fetching auth token failed: "+r.message);return e.handleStreamClose(t)})})},e.prototype.startStream=function(e){var t=this;assert(this.state===PersistentStreamState.Starting,"Trying to start stream in a non-starting state");var r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen(function(){r(function(){return assert(t.state===PersistentStreamState.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=PersistentStreamState.Open,t.listener.onOpen()})}),this.stream.onClose(function(e){r(function(){return t.handleStreamClose(e)})}),this.stream.onMessage(function(e){r(function(){return t.onMessage(e)})})},e.prototype.performBackoff=function(){var e=this;assert(this.state===PersistentStreamState.Error,"Should only perform backoff when in Error state"),this.state=PersistentStreamState.Backoff,this.backoff.backoffAndRun(function(){return tslib.__awaiter(e,void 0,void 0,function(){return tslib.__generator(this,function(e){return assert(this.state===PersistentStreamState.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=PersistentStreamState.Initial,this.start(),assert(this.isStarted(),"PersistentStream should have started"),[2]})})})},e.prototype.handleStreamClose=function(e){return assert(this.isStarted(),"Can't handle server close on non-started stream"),debug(LOG_TAG$5,"close with error: "+e),this.stream=null,this.close(PersistentStreamState.Error,e)},e.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(r){t.queue.enqueueAndForget(function(){return t.closeCount===e?r():(debug(LOG_TAG$5,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),PersistentListenStream=function(e){function t(t,r,n,i,o){var a=e.call(this,t,TimerId.ListenStreamConnectionBackoff,TimerId.ListenStreamIdle,r,n,o)||this;return a.serializer=i,a}return tslib.__extends(t,e),t.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},t.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),r=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,r)},t.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var r=this.serializer.toListenRequestLabels(e);r&&(t.labels=r),this.sendRequest(t)},t.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},t}(PersistentStream),PersistentWriteStream=function(e){function t(t,r,n,i,o){var a=e.call(this,t,TimerId.WriteStreamConnectionBackoff,TimerId.WriteStreamIdle,r,n,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=emptyByteString(),a}return tslib.__extends(t,e),Object.defineProperty(t.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.handshakeComplete_=!1,e.prototype.start.call(this)},t.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},t.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},t.prototype.onMessage=function(e){if(assert(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),r=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(r,t)}return assert(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},t.prototype.writeHandshake=function(){assert(this.isOpen(),"Writing handshake requires an opened stream"),assert(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},t.prototype.writeMutations=function(e){var t=this;assert(this.isOpen(),"Writing mutations requires an opened stream"),assert(this.handshakeComplete_,"Handshake must be complete before writing mutations"),assert(this.lastStreamToken.length>0,"Trying to write mutation without a token");var r={streamToken:this.lastStreamToken,writes:e.map(function(e){return t.serializer.toMutation(e)})};this.sendRequest(r)},t}(PersistentStream),Datastore=function(){function e(e,t,r,n){this.queue=e,this.connection=t,this.credentials=r,this.serializer=n}return e.prototype.newPersistentWriteStream=function(e){return new PersistentWriteStream(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.newPersistentWatchStream=function(e){return new PersistentListenStream(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.commit=function(e){var t=this,r={database:this.serializer.encodedDatabaseId,writes:e.map(function(e){return t.serializer.toMutation(e)})};return this.invokeRPC("Commit",r).then(function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)})},e.prototype.lookup=function(e){var t=this,r={database:this.serializer.encodedDatabaseId,documents:e.map(function(e){return t.serializer.toName(e)})};return this.invokeStreamingRPC("BatchGetDocuments",r).then(function(r){var n=maybeDocumentMap();r.forEach(function(e){var r=t.serializer.fromMaybeDocument(e);n=n.insert(r.key,r)});var i=[];return e.forEach(function(e){var t=n.get(e);assert(!!t,"Missing entity in write response for "+e),i.push(t)}),i})},e.prototype.invokeRPC=function(e,t){var r=this;return this.credentials.getToken().then(function(n){return r.connection.invokeRPC(e,t,n)}).catch(function(e){throw e.code===Code.UNAUTHENTICATED&&r.credentials.invalidateToken(),e})},e.prototype.invokeStreamingRPC=function(e,t){var r=this;return this.credentials.getToken().then(function(n){return r.connection.invokeStreamingRPC(e,t,n)}).catch(function(e){throw e.code===Code.UNAUTHENTICATED&&r.credentials.invalidateToken(),e})},e}(),Transaction=function(){function e(e){this.datastore=e,this.readVersions=documentVersionMap(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r=this;return tslib.__generator(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(e)];case 1:return(t=n.sent()).forEach(function(e){e instanceof NoDocument||e instanceof Document?r.recordVersion(e):fail("Document in a transaction was a "+e.constructor.name)}),[2,t]}})})},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e)},e.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e)},e.prototype.delete=function(e){this.write([new DeleteMutation(e,this.precondition(e))]),this.writtenDocs.add(e)},e.prototype.commit=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e,t=this;return tslib.__generator(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(e,r){t.mutations.push(new VerifyMutation(e,t.precondition(e)))}),[4,this.datastore.commit(this.mutations)];case 1:return r.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(e){var t;if(e instanceof Document)t=e.version;else{if(!(e instanceof NoDocument))throw fail("Document in a transaction was a "+e.constructor.name);t=SnapshotVersion.forDeletedDoc()}var r=this.readVersions.get(e.key);if(null!==r){if(!t.isEqual(r))throw new FirestoreError(Code.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return!this.writtenDocs.has(e)&&t?Precondition.updateTime(t):Precondition.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(!this.writtenDocs.has(e)&&t){if(t.isEqual(SnapshotVersion.forDeletedDoc()))throw new FirestoreError(Code.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Precondition.updateTime(t)}return Precondition.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},e.prototype.ensureCommitNotCalled=function(){assert(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Offline=2]="Offline"}(OnlineState||(OnlineState={})),function(e){e[e.RemoteStore=0]="RemoteStore",e[e.SharedClientState=1]="SharedClientState"}(OnlineStateSource||(OnlineStateSource={}));var RpcCode,LOG_TAG$6="OnlineStateTracker",MAX_WATCH_STREAM_FAILURES=1,ONLINE_STATE_TIMEOUT_MS=1e4,OnlineStateTracker=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=OnlineState.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(OnlineState.Unknown),assert(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(TimerId.OnlineStateTimeout,ONLINE_STATE_TIMEOUT_MS,function(){return e.onlineStateTimer=null,assert(e.state===OnlineState.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within "+ONLINE_STATE_TIMEOUT_MS/1e3+" seconds."),e.setAndBroadcast(OnlineState.Offline),Promise.resolve()}))},e.prototype.handleWatchStreamFailure=function(e){this.state===OnlineState.Online?(this.setAndBroadcast(OnlineState.Unknown),assert(0===this.watchStreamFailures,"watchStreamFailures must be 0"),assert(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=MAX_WATCH_STREAM_FAILURES&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed "+MAX_WATCH_STREAM_FAILURES+" times. Most recent error: "+e.toString()),this.setAndBroadcast(OnlineState.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===OnlineState.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(error(t),this.shouldWarnClientIsOffline=!1):debug(LOG_TAG$6,t)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}();function isPermanentError(e){switch(e){case Code.OK:return fail("Treated status OK as error");case Code.CANCELLED:case Code.UNKNOWN:case Code.DEADLINE_EXCEEDED:case Code.RESOURCE_EXHAUSTED:case Code.INTERNAL:case Code.UNAVAILABLE:case Code.UNAUTHENTICATED:return!1;case Code.INVALID_ARGUMENT:case Code.NOT_FOUND:case Code.ALREADY_EXISTS:case Code.PERMISSION_DENIED:case Code.FAILED_PRECONDITION:case Code.ABORTED:case Code.OUT_OF_RANGE:case Code.UNIMPLEMENTED:case Code.DATA_LOSS:return!0;default:return fail("Unknown status code: "+e)}}function isPermanentWriteError(e){return isPermanentError(e)&&e!==Code.ABORTED}function mapCodeFromRpcStatus(e){var t=RpcCode[e];if(void 0!==t)return mapCodeFromRpcCode(t)}function mapCodeFromRpcCode(e){if(void 0===e)return error("GRPC error has no .code"),Code.UNKNOWN;switch(e){case RpcCode.OK:return Code.OK;case RpcCode.CANCELLED:return Code.CANCELLED;case RpcCode.UNKNOWN:return Code.UNKNOWN;case RpcCode.DEADLINE_EXCEEDED:return Code.DEADLINE_EXCEEDED;case RpcCode.RESOURCE_EXHAUSTED:return Code.RESOURCE_EXHAUSTED;case RpcCode.INTERNAL:return Code.INTERNAL;case RpcCode.UNAVAILABLE:return Code.UNAVAILABLE;case RpcCode.UNAUTHENTICATED:return Code.UNAUTHENTICATED;case RpcCode.INVALID_ARGUMENT:return Code.INVALID_ARGUMENT;case RpcCode.NOT_FOUND:return Code.NOT_FOUND;case RpcCode.ALREADY_EXISTS:return Code.ALREADY_EXISTS;case RpcCode.PERMISSION_DENIED:return Code.PERMISSION_DENIED;case RpcCode.FAILED_PRECONDITION:return Code.FAILED_PRECONDITION;case RpcCode.ABORTED:return Code.ABORTED;case RpcCode.OUT_OF_RANGE:return Code.OUT_OF_RANGE;case RpcCode.UNIMPLEMENTED:return Code.UNIMPLEMENTED;case RpcCode.DATA_LOSS:return Code.DATA_LOSS;default:return fail("Unknown status code: "+e)}}function mapRpcCodeFromCode(e){if(void 0===e)return RpcCode.OK;switch(e){case Code.OK:return RpcCode.OK;case Code.CANCELLED:return RpcCode.CANCELLED;case Code.UNKNOWN:return RpcCode.UNKNOWN;case Code.DEADLINE_EXCEEDED:return RpcCode.DEADLINE_EXCEEDED;case Code.RESOURCE_EXHAUSTED:return RpcCode.RESOURCE_EXHAUSTED;case Code.INTERNAL:return RpcCode.INTERNAL;case Code.UNAVAILABLE:return RpcCode.UNAVAILABLE;case Code.UNAUTHENTICATED:return RpcCode.UNAUTHENTICATED;case Code.INVALID_ARGUMENT:return RpcCode.INVALID_ARGUMENT;case Code.NOT_FOUND:return RpcCode.NOT_FOUND;case Code.ALREADY_EXISTS:return RpcCode.ALREADY_EXISTS;case Code.PERMISSION_DENIED:return RpcCode.PERMISSION_DENIED;case Code.FAILED_PRECONDITION:return RpcCode.FAILED_PRECONDITION;case Code.ABORTED:return RpcCode.ABORTED;case Code.OUT_OF_RANGE:return RpcCode.OUT_OF_RANGE;case Code.UNIMPLEMENTED:return RpcCode.UNIMPLEMENTED;case Code.DATA_LOSS:return RpcCode.DATA_LOSS;default:return fail("Unknown status code: "+e)}}function mapCodeFromHttpResponseErrorStatus(e){var t=e.toLowerCase().replace("_","-");return Object.values(Code).indexOf(t)>=0?t:Code.UNKNOWN}!function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"}(RpcCode||(RpcCode={}));var ChangeType,SyncState,DocumentSet=function(){function e(e){this.comparator=e?function(t,r){return e(t,r)||DocumentKey.comparator(t.key,r.key)}:function(e,t){return DocumentKey.comparator(e.key,t.key)},this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(t,r){return e(t),!1})},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();r.hasNext();){var i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,r){var n=new e;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n},e}();!function(e){e[e.Added=0]="Added",e[e.Removed=1]="Removed",e[e.Modified=2]="Modified",e[e.Metadata=3]="Metadata"}(ChangeType||(ChangeType={})),function(e){e[e.Local=0]="Local",e[e.Synced=1]="Synced"}(SyncState||(SyncState={}));var WatchTargetChangeState,DocumentChangeSet=function(){function e(){this.changeMap=new SortedMap(DocumentKey.comparator)}return e.prototype.track=function(e){var t=e.doc.key,r=this.changeMap.get(t);r?e.type!==ChangeType.Added&&r.type===ChangeType.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===ChangeType.Metadata&&r.type!==ChangeType.Removed?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):e.type===ChangeType.Modified&&r.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Modified,doc:e.doc}):e.type===ChangeType.Modified&&r.type===ChangeType.Added?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Added,doc:e.doc}):e.type===ChangeType.Removed&&r.type===ChangeType.Added?this.changeMap=this.changeMap.remove(t):e.type===ChangeType.Removed&&r.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Removed,doc:r.doc}):e.type===ChangeType.Added&&r.type===ChangeType.Removed?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Modified,doc:e.doc}):fail("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(r)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal(function(t,r){e.push(r)}),e},e}(),ViewSnapshot=function(){function e(e,t,r,n,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,r,n,i){var o=[];return r.forEach(function(e){o.push({type:ChangeType.Added,doc:e})}),new e(t,r,DocumentSet.emptySet(r),o,n,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(t[n].type!==r[n].type||!t[n].doc.isEqual(r[n].doc))return!1;return!0},e}(),RemoteEvent=function(){function e(e,t,r,n,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,r){var n,i=((n={})[t]=TargetChange.createSynthesizedTargetChangeForCurrentChange(t,r),n);return new e(SnapshotVersion.MIN,i,targetIdSet(),maybeDocumentMap(),documentKeySet())},e}(),TargetChange=function(){function e(e,t,r,n,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,r){return new e(emptyByteString(),r,documentKeySet(),documentKeySet(),documentKeySet())},e}(),DocumentWatchChange=function(){return function(e,t,r,n){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=n}}(),ExistenceFilterChange=function(){return function(e,t){this.targetId=e,this.existenceFilter=t}}();!function(e){e[e.NoChange=0]="NoChange",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Current=3]="Current",e[e.Reset=4]="Reset"}(WatchTargetChangeState||(WatchTargetChangeState={}));var WatchTargetChange=function(){return function(e,t,r,n){void 0===r&&(r=emptyByteString()),void 0===n&&(n=null),this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}(),TargetState=function(){function e(){this.pendingResponses=0,this.documentChanges=snapshotChangesMap(),this._resumeToken=emptyByteString(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),e.prototype.updateResumeToken=function(e){e.length>0&&(this._hasPendingChanges=!0,this._resumeToken=e)},e.prototype.toTargetChange=function(){var e=documentKeySet(),t=documentKeySet(),r=documentKeySet();return this.documentChanges.forEach(function(n,i){switch(i){case ChangeType.Added:e=e.add(n);break;case ChangeType.Modified:t=t.add(n);break;case ChangeType.Removed:r=r.add(n);break;default:fail("Encountered invalid change type: "+i)}}),new TargetChange(this._resumeToken,this._current,e,t,r)},e.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=snapshotChangesMap()},e.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},e.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},e.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},e.prototype.recordTargetResponse=function(){this.pendingResponses-=1},e.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},e}(),LOG_TAG$7="WatchChangeAggregator",WatchChangeAggregator=function(){function e(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator)}return e.prototype.handleDocumentChange=function(e){for(var t=0,r=e.updatedTargetIds;t<r.length;t++){var n=r[t];e.newDoc instanceof Document?this.addDocumentToTarget(n,e.newDoc):e.newDoc instanceof NoDocument&&this.removeDocumentFromTarget(n,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++){n=o[i];this.removeDocumentFromTarget(n,e.key,e.newDoc)}},e.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,function(r){var n=t.ensureTargetState(r);switch(e.state){case WatchTargetChangeState.NoChange:t.isActiveTarget(r)&&n.updateResumeToken(e.resumeToken);break;case WatchTargetChangeState.Added:n.recordTargetResponse(),n.isPending||n.clearPendingChanges(),n.updateResumeToken(e.resumeToken);break;case WatchTargetChangeState.Removed:n.recordTargetResponse(),n.isPending||t.removeTarget(r),assert(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case WatchTargetChangeState.Current:t.isActiveTarget(r)&&(n.markCurrent(),n.updateResumeToken(e.resumeToken));break;case WatchTargetChangeState.Reset:t.isActiveTarget(r)&&(t.resetTarget(r),n.updateResumeToken(e.resumeToken));break;default:fail("Unknown target watch change state: "+e.state)}})},e.prototype.forEachTarget=function(e,t){e.targetIds.length>0?e.targetIds.forEach(t):forEachNumber(this.targetStates,t)},e.prototype.handleExistenceFilter=function(e){var t=e.targetId,r=e.existenceFilter.count,n=this.targetDataForActiveTarget(t);if(n){var i=n.target;if(i.isDocumentQuery())if(0===r){var o=new DocumentKey(i.path);this.removeDocumentFromTarget(t,o,new NoDocument(o,SnapshotVersion.forDeletedDoc()))}else assert(1===r,"Single document existence filter with count: "+r);else this.getCurrentDocumentCountForTarget(t)!==r&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},e.prototype.createRemoteEvent=function(e){var t=this,r={};forEachNumber(this.targetStates,function(n,i){var o=t.targetDataForActiveTarget(n);if(o){if(i.current&&o.target.isDocumentQuery()){var a=new DocumentKey(o.target.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(n,a)||t.removeDocumentFromTarget(n,a,new NoDocument(a,e))}i.hasPendingChanges&&(r[n]=i.toTargetChange(),i.clearPendingChanges())}});var n=documentKeySet();this.pendingDocumentTargetMapping.forEach(function(e,r){var i=!0;r.forEachWhile(function(e){var r=t.targetDataForActiveTarget(e);return!r||r.purpose===TargetPurpose.LimboResolution||(i=!1,!1)}),i&&(n=n.add(e))});var i=new RemoteEvent(e,r,this.pendingTargetResets,this.pendingDocumentUpdates,n);return this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator),i},e.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var r=this.targetContainsDocument(e,t.key)?ChangeType.Modified:ChangeType.Added;this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},e.prototype.removeDocumentFromTarget=function(e,t,r){if(this.isActiveTarget(e)){var n=this.ensureTargetState(e);this.targetContainsDocument(e,t)?n.addDocumentChange(t,ChangeType.Removed):n.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}},e.prototype.removeTarget=function(e){delete this.targetStates[e]},e.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},e.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new TargetState),this.targetStates[e]},e.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new SortedSet(primitiveComparator),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},e.prototype.isActiveTarget=function(e){var t=null!==this.targetDataForActiveTarget(e);return t||debug(LOG_TAG$7,"Detected inactive target",e),t},e.prototype.targetDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)},e.prototype.resetTarget=function(e){var t=this;assert(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new TargetState,this.metadataProvider.getRemoteKeysForTarget(e).forEach(function(r){t.removeDocumentFromTarget(e,r,null)})},e.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},e}();function documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}var LOG_TAG$8="RemoteStore",MAX_PENDING_WRITES=10,RemoteStore=function(){function e(e,t,r,n,i){var o=this;this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(e){r.enqueueAndForget(function(){return tslib.__awaiter(o,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.canUseNetwork()?(debug(LOG_TAG$8,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new OnlineStateTracker(r,n),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.enableNetwork=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e;return tslib.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(OnlineState.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},e.prototype.disableNetwork=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(OnlineState.Offline),[2]}})})},e.prototype.disableNetworkInternal=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),this.writePipeline.length>0&&(debug(LOG_TAG$8,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},e.prototype.shutdown=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return debug(LOG_TAG$8,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(OnlineState.Unknown),[2]}})})},e.prototype.listen=function(e){contains(this.listenTargets,e.targetId)||(this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e))},e.prototype.unlisten=function(e){assert(contains(this.listenTargets,e),"unlisten called on target no currently watched: "+e),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),isEmpty(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(OnlineState.Unknown))},e.prototype.getTargetDataForTarget=function(e){return this.listenTargets[e]||null},e.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},e.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.startWatchStream=function(){assert(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new WatchChangeAggregator(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!isEmpty(this.listenTargets)},e.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},e.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},e.prototype.onWatchStreamOpen=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e=this;return tslib.__generator(this,function(t){return forEachNumber(this.listenTargets,function(t,r){e.sendWatchRequest(r)}),[2]})})},e.prototype.onWatchStreamClose=function(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){return void 0===e&&assert(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(OnlineState.Unknown),[2]})})},e.prototype.onWatchStreamChange=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r;return tslib.__generator(this,function(n){switch(n.label){case 0:return this.onlineStateTracker.set(OnlineState.Online),e instanceof WatchTargetChange&&e.state===WatchTargetChangeState.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof DocumentWatchChange?this.watchChangeAggregator.handleDocumentChange(e):e instanceof ExistenceFilterChange?this.watchChangeAggregator.handleExistenceFilter(e):(assert(e instanceof WatchTargetChange,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(SnapshotVersion.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return r=n.sent(),t.compareTo(r)>=0?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.raiseWatchSnapshot=function(e){var t=this;assert(!e.isEqual(SnapshotVersion.MIN),"Can't raise event for unknown SnapshotVersion");var r=this.watchChangeAggregator.createRemoteEvent(e);return forEachNumber(r.targetChanges,function(r,n){if(n.resumeToken.length>0){var i=t.listenTargets[r];i&&(t.listenTargets[r]=i.withResumeToken(n.resumeToken,e))}}),r.targetMismatches.forEach(function(e){var r=t.listenTargets[e];if(r){t.listenTargets[e]=r.withResumeToken(emptyByteString(),r.snapshotVersion),t.sendUnwatchRequest(e);var n=new TargetData(r.target,e,TargetPurpose.ExistenceFilterMismatch,r.sequenceNumber);t.sendWatchRequest(n)}}),this.syncEngine.applyRemoteEvent(r)},e.prototype.handleTargetError=function(e){var t=this;assert(!!e.cause,"Handling target error without a cause");var r=e.cause,n=Promise.resolve();return e.targetIds.forEach(function(e){n=n.then(function(){return tslib.__awaiter(t,void 0,void 0,function(){return tslib.__generator(this,function(t){return contains(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,r)]):[2]})})})}),n},e.prototype.fillWritePipeline=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e,t;return tslib.__generator(this,function(r){switch(r.label){case 0:return this.canAddToWritePipeline()?(e=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:BATCHID_UNKNOWN,[4,this.localStore.nextMutationBatch(e)]):[3,4];case 1:return null!==(t=r.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(t),[4,this.fillWritePipeline()];case 3:r.sent(),r.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},e.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<MAX_PENDING_WRITES},e.prototype.outstandingWrites=function(){return this.writePipeline.length},e.prototype.addToWritePipeline=function(e){assert(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},e.prototype.startWriteStream=function(){assert(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},e.prototype.onWriteStreamOpen=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){return this.writeStream.writeHandshake(),[2]})})},e.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var t=0,r=e.writePipeline;t<r.length;t++){var n=r[t];e.writeStream.writeMutations(n.mutations)}}).catch(ignoreIfPrimaryLeaseLoss)},e.prototype.onMutationResult=function(e,t){var r=this;assert(this.writePipeline.length>0,"Got result for empty write pipeline");var n=this.writePipeline.shift(),i=MutationBatchResult.from(n,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return r.fillWritePipeline()})},e.prototype.onWriteStreamClose=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t=this;return tslib.__generator(this,function(r){return void 0===e&&assert(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&this.writePipeline.length>0?(void 0,[2,(this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e)).then(function(){t.shouldStartWriteStream()&&t.startWriteStream()})]):[2]})})},e.prototype.handleHandshakeError=function(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){return isPermanentError(e.code)?(debug(LOG_TAG$8,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=emptyByteString(),[2,this.localStore.setLastStreamToken(emptyByteString()).catch(ignoreIfPrimaryLeaseLoss)]):[2]})})},e.prototype.handleWriteError=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r=this;return tslib.__generator(this,function(n){return isPermanentWriteError(e.code)?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then(function(){return r.fillWritePipeline()})]):[2]})})},e.prototype.createTransaction=function(){return new Transaction(this.datastore)},e.prototype.restartNetwork=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[4,this.enableNetwork()];case 2:return e.sent(),[2]}})})},e.prototype.handleCredentialChange=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.canUseNetwork()?(debug(LOG_TAG$8,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.applyPrimaryState=function(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){switch(t.label){case 0:return this.isPrimary=e,e&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(OnlineState.Unknown),t.label=4;case 4:return[2]}})})},e}(),GeoPoint=function(){function e(e,t){if(validateExactNumberOfArgs("GeoPoint",arguments,2),validateArgType("GeoPoint","number",1,e),validateArgType("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new FirestoreError(Code.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new FirestoreError(Code.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return primitiveComparator(this._lat,e._lat)||primitiveComparator(this._long,e._long)},e}(),ServerTimestampTransform=function(){function e(){}return e.prototype.applyToLocalView=function(e,t){return new ServerTimestampValue(t,e)},e.prototype.applyToRemoteDocument=function(e,t){return t},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e},e.instance=new e,e}(),ArrayUnionTransformOperation=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=coercedFieldValuesArray(e),r=function(e){t.find(function(t){return t.isEqual(e)})||t.push(e)},n=0,i=this.elements;n<i.length;n++){r(i[n])}return new ArrayValue(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&arrayEquals(t.elements,this.elements)},e}(),ArrayRemoveTransformOperation=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=coercedFieldValuesArray(e),r=function(e){t=t.filter(function(t){return!t.isEqual(e)})},n=0,i=this.elements;n<i.length;n++){r(i[n])}return new ArrayValue(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&arrayEquals(t.elements,this.elements)},e}(),NumericIncrementTransformOperation=function(){function e(e){this.operand=e}return e.prototype.applyToLocalView=function(e,t){var r=this.computeBaseValue(e);if(r instanceof IntegerValue&&this.operand instanceof IntegerValue){var n=r.internalValue+this.operand.internalValue;return new IntegerValue(n)}n=r.internalValue+this.operand.internalValue;return new DoubleValue(n)},e.prototype.applyToRemoteDocument=function(e,t){return assert(null!==t,"Didn't receive transformResult for NUMERIC_ADD transform"),t},e.prototype.computeBaseValue=function(e){return e instanceof NumberValue?e:new IntegerValue(0)},e.prototype.isEqual=function(t){return t instanceof e&&this.operand.isEqual(t.operand)},e}();function coercedFieldValuesArray(e){return e instanceof ArrayValue?e.internalValue.slice():[]}var ExistenceFilter=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}(),DIRECTIONS=function(){var e={};return e[Direction.ASCENDING.name]="ASCENDING",e[Direction.DESCENDING.name]="DESCENDING",e}(),OPERATORS=function(){var e={};return e[Operator.LESS_THAN.name]="LESS_THAN",e[Operator.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",e[Operator.GREATER_THAN.name]="GREATER_THAN",e[Operator.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",e[Operator.EQUAL.name]="EQUAL",e[Operator.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",e[Operator.IN.name]="IN",e[Operator.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",e}(),ISO_REG_EXP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function assertPresent(e,t){assert(!isNullOrUndefined(e),t+" is missing")}function parseInt64(e){return"number"==typeof e?e:"string"==typeof e?Number(e):fail("can't parse "+e)}var JsonProtoSerializer=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?Code.UNKNOWN:mapCodeFromRpcCode(e.code);return new FirestoreError(t,e.message||"")},e.prototype.toInt32Value=function(e){return this.options.useProto3Json||isNullOrUndefined(e)?e:{value:e}},e.prototype.fromInt32Value=function(e){var t;return isNullOrUndefined(t="object"==typeof e?e.value:e)?null:t},e.prototype.toTimestamp=function(e){return this.options.useProto3Json?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);assert(!!e,"Cannot deserialize null or undefined timestamp.");var t=parseInt64(e.seconds||"0"),r=e.nanos||0;return new Timestamp(t,r)},e.prototype.fromIso8601String=function(e){var t=0,r=ISO_REG_EXP.exec(e);if(assert(!!r,"invalid timestamp: "+e),r[1]){var n=r[1];n=(n+"000000000").substr(0,9),t=Number(n)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new Timestamp(o,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(assert(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Blob.fromBase64String(e)):(assert(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Blob.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return assert(!!e,"Trying to deserialize version that isn't set"),SnapshotVersion.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=ResourcePath.fromString(e);return assert(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return assert(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),assert(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new DocumentKey(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?ResourcePath.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new ResourcePath(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new ResourcePath(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return assert(e.length>4&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof NullValue)return{nullValue:"NULL_VALUE"};if(e instanceof BooleanValue)return{booleanValue:e.value()};if(e instanceof IntegerValue)return{integerValue:""+e.value()};if(e instanceof DoubleValue){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof StringValue?{stringValue:e.value()}:e instanceof ObjectValue?{mapValue:this.toMapValue(e)}:e instanceof ArrayValue?{arrayValue:this.toArrayValue(e)}:e instanceof TimestampValue?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof GeoPointValue?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof BlobValue?{bytesValue:this.toBytes(e.value())}:e instanceof RefValue?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:fail("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this;if("nullValue"in e)return NullValue.INSTANCE;if("booleanValue"in e)return BooleanValue.of(e.booleanValue);if("integerValue"in e)return new IntegerValue(parseInt64(e.integerValue));if("doubleValue"in e){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return DoubleValue.NAN;if("Infinity"===e.doubleValue)return DoubleValue.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return DoubleValue.NEGATIVE_INFINITY}return new DoubleValue(e.doubleValue)}if("stringValue"in e)return new StringValue(e.stringValue);if("mapValue"in e)return this.fromFields(e.mapValue.fields||{});if("arrayValue"in e){assertPresent(e.arrayValue,"arrayValue");var r=e.arrayValue.values||[];return new ArrayValue(r.map(function(e){return t.fromValue(e)}))}if("timestampValue"in e)return assertPresent(e.timestampValue,"timestampValue"),new TimestampValue(this.fromTimestamp(e.timestampValue));if("geoPointValue"in e){assertPresent(e.geoPointValue,"geoPointValue");var n=e.geoPointValue.latitude||0,i=e.geoPointValue.longitude||0;return new GeoPointValue(new GeoPoint(n,i))}if("bytesValue"in e){assertPresent(e.bytesValue,"bytesValue");var o=this.fromBlob(e.bytesValue);return new BlobValue(o)}if("referenceValue"in e){assertPresent(e.referenceValue,"referenceValue");var a=this.fromResourceName(e.referenceValue),s=new DatabaseId(a.get(1),a.get(3)),u=new DocumentKey(this.extractLocalPathFromResourceName(a));return new RefValue(s,u)}return fail("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return assert(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e,t){var r=this,n=this.fromName(e.name),i=this.fromVersion(e.updateTime);return new Document(n,i,{hasCommittedMutations:!!t},void 0,e,function(e){return r.fromValue(e)})},e.prototype.toFields=function(e){var t=this,r={};return e.forEach(function(e,n){r[e]=t.toValue(n)}),r},e.prototype.fromFields=function(e){var t=this,r=e,n=ObjectValue.EMPTY;return forEach(r,function(e,r){n=n.set(new FieldPath([e]),t.fromValue(r))}),n},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,r=[];return e.forEach(function(e){r.push(t.toValue(e))}),{values:r}},e.prototype.fromFound=function(e){var t=this;assert(!!e.found,"Tried to deserialize a found document from a missing document."),assertPresent(e.found.name,"doc.found.name"),assertPresent(e.found.updateTime,"doc.found.updateTime");var r=this.fromName(e.found.name),n=this.fromVersion(e.found.updateTime);return new Document(r,n,{},void 0,e.found,function(e){return t.fromValue(e)})},e.prototype.fromMissing=function(e){assert(!!e.missing,"Tried to deserialize a missing document from a found document."),assert(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),r=this.fromVersion(e.readTime);return new NoDocument(t,r)},e.prototype.fromMaybeDocument=function(e){return"found"in e?this.fromFound(e):"missing"in e?this.fromMissing(e):fail("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case WatchTargetChangeState.Added:return"ADD";case WatchTargetChangeState.Current:return"CURRENT";case WatchTargetChangeState.NoChange:return"NO_CHANGE";case WatchTargetChangeState.Removed:return"REMOVE";case WatchTargetChangeState.Reset:return"RESET";default:return fail("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof ExistenceFilterChange)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof DocumentWatchChange){if(e.newDoc instanceof Document){var t=e.newDoc;return{documentChange:{document:{name:this.toName(t.key),fields:this.toFields(t.data()),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}}}if(e.newDoc instanceof NoDocument){t=e.newDoc;return{documentDelete:{document:this.toName(t.key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}}}if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof WatchTargetChange){var r=void 0;return e.cause&&(r={code:mapRpcCodeFromCode(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:r}}}return fail("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,r=this;if("targetChange"in e){assertPresent(e.targetChange,"targetChange");var n=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new WatchTargetChange(n,i,o,s||null)}else if("documentChange"in e){assertPresent(e.documentChange,"documentChange");var u=e.documentChange;assertPresent(u.document,"documentChange.name"),assertPresent(u.document.name,"documentChange.document.name"),assertPresent(u.document.updateTime,"documentChange.document.updateTime");var c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=new Document(c,l,{},void 0,u.document,function(e){return r.fromValue(e)}),d=u.targetIds||[],f=u.removedTargetIds||[];t=new DocumentWatchChange(d,f,h.key,h)}else if("documentDelete"in e){assertPresent(e.documentDelete,"documentDelete");var p=e.documentDelete;assertPresent(p.document,"documentDelete.document");c=this.fromName(p.document),l=p.readTime?this.fromVersion(p.readTime):SnapshotVersion.forDeletedDoc(),h=new NoDocument(c,l),f=p.removedTargetIds||[];t=new DocumentWatchChange([],f,h.key,h)}else if("documentRemove"in e){assertPresent(e.documentRemove,"documentRemove");var m=e.documentRemove;assertPresent(m.document,"documentRemove");c=this.fromName(m.document),f=m.removedTargetIds||[];t=new DocumentWatchChange([],f,c,null)}else{if(!("filter"in e))return fail("Unknown change type "+JSON.stringify(e));assertPresent(e.filter,"filter");var y=e.filter;assertPresent(y.targetId,"filter.targetId");var g=y.count||0,v=new ExistenceFilter(g),b=y.targetId;t=new ExistenceFilterChange(b,v)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?WatchTargetChangeState.NoChange:"ADD"===e?WatchTargetChangeState.Added:"REMOVE"===e?WatchTargetChangeState.Removed:"CURRENT"===e?WatchTargetChangeState.Current:"RESET"===e?WatchTargetChangeState.Reset:fail("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!("targetChange"in e))return SnapshotVersion.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?SnapshotVersion.MIN:t.readTime?this.fromVersion(t.readTime):SnapshotVersion.MIN},e.prototype.toMutation=function(e){var t,r=this;if(e instanceof SetMutation)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof DeleteMutation)t={delete:this.toName(e.key)};else if(e instanceof PatchMutation)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else if(e instanceof TransformMutation)t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map(function(e){return r.toFieldTransform(e)})}};else{if(!(e instanceof VerifyMutation))return fail("Unknown mutation type "+e.type);t={verify:this.toName(e.key)}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,r=e.currentDocument?this.fromPrecondition(e.currentDocument):Precondition.NONE;if(e.update){assertPresent(e.update.name,"name");var n=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new PatchMutation(n,i,o,r)}return new SetMutation(n,i,r)}if(e.delete){n=this.fromName(e.delete);return new DeleteMutation(n,r)}if(e.transform){n=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map(function(e){return t.fromFieldTransform(e)});return assert(!0===r.exists,'Transforms only support precondition "exists == true"'),new TransformMutation(n,a)}if(e.verify){n=this.fromName(e.verify);return new VerifyMutation(n,r)}return fail("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return assert(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:fail("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?Precondition.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?Precondition.exists(e.exists):Precondition.NONE},e.prototype.fromWriteResult=function(e,t){var r=this,n=e.updateTime?this.fromVersion(e.updateTime):this.fromVersion(t);n.isEqual(SnapshotVersion.MIN)&&(n=this.fromVersion(t));var i=null;return e.transformResults&&e.transformResults.length>0&&(i=e.transformResults.map(function(e){return r.fromValue(e)})),new MutationResult(n,i)},e.prototype.fromWriteResults=function(e,t){var r=this;return e&&e.length>0?(assert(void 0!==t,"Received a write result without a commit time"),e.map(function(e){return r.fromWriteResult(e,t)})):[]},e.prototype.toFieldTransform=function(e){var t=this,r=e.transform;if(r instanceof ServerTimestampTransform)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof ArrayUnionTransformOperation)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:r.elements.map(function(e){return t.toValue(e)})}};if(r instanceof ArrayRemoveTransformOperation)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:r.elements.map(function(e){return t.toValue(e)})}};if(r instanceof NumericIncrementTransformOperation)return{fieldPath:e.field.canonicalString(),increment:this.toValue(r.operand)};throw fail("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,r=null;if("setToServerValue"in e)assert("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),r=ServerTimestampTransform.instance;else if("appendMissingElements"in e){var n=e.appendMissingElements.values||[];r=new ArrayUnionTransformOperation(n.map(function(e){return t.fromValue(e)}))}else if("removeAllFromArray"in e){n=e.removeAllFromArray.values||[];r=new ArrayRemoveTransformOperation(n.map(function(e){return t.fromValue(e)}))}else if("increment"in e){var i=this.fromValue(e.increment);assert(i instanceof NumberValue,"NUMERIC_ADD transform requires a NumberValue"),r=new NumericIncrementTransformOperation(i)}else fail("Unknown transform proto: "+JSON.stringify(e));var o=FieldPath.fromServerFormat(e.fieldPath);return new FieldTransform(o,r)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;assert(1===t,"DocumentsTarget contained other than 1 document: "+t);var r=e.documents[0];return Query.atPath(this.fromQueryPath(r)).toTarget()},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(assert(r.length%2==0,"Collection Group queries should be within a document path or root."),t.parent=this.toQueryPath(r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(assert(r.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);var n=this.toFilter(e.filters);n&&(t.structuredQuery.where=n);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),r=e.structuredQuery,n=r.from?r.from.length:0,i=null;if(n>0){assert(1===n,"StructuredQuery.from with more than one collection is not supported.");var o=r.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];r.where&&(a=this.fromFilter(r.where));var s=[];r.orderBy&&(s=this.fromOrder(r.orderBy));var u=null;r.limit&&(u=this.fromInt32Value(r.limit));var c=null;r.startAt&&(c=this.fromCursor(r.startAt));var l=null;return r.endAt&&(l=this.fromCursor(r.endAt)),new Query(t,i,s,a,u,LimitType.First,c,l).toTarget()},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case TargetPurpose.Listen:return null;case TargetPurpose.ExistenceFilterMismatch:return"existence-filter-mismatch";case TargetPurpose.LimboResolution:return"limbo-document";default:return fail("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,r=e.target;return(t=r.isDocumentQuery()?{documents:this.toDocumentsTarget(r)}:{query:this.toQueryTarget(r)}).targetId=e.targetId,e.resumeToken.length>0&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var r=e.map(function(e){return e instanceof FieldFilter?t.toUnaryOrFieldFilter(e):fail("Unrecognized filter: "+JSON.stringify(e))});return 1===r.length?r[0]:{compositeFilter:{op:"AND",filters:r}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromFieldFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t.fromFilter(e)}).reduce(function(e,t){return e.concat(t)}):fail("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map(function(e){return t.toPropertyOrder(e)})},e.prototype.fromOrder=function(e){var t=this;return e.map(function(e){return t.fromPropertyOrder(e)})},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map(function(e){return t.toValue(e)})}},e.prototype.fromCursor=function(e){var t=this,r=!!e.before,n=e.values.map(function(e){return t.fromValue(e)});return new Bound(n,r)},e.prototype.toDirection=function(e){return DIRECTIONS[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return Direction.ASCENDING;case"DESCENDING":return Direction.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return OPERATORS[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return Operator.EQUAL;case"GREATER_THAN":return Operator.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Operator.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Operator.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Operator.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Operator.ARRAY_CONTAINS;case"IN":return Operator.IN;case"ARRAY_CONTAINS_ANY":return Operator.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return fail("Unspecified operator");default:return fail("Unknown operator")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return FieldPath.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new OrderBy(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.fromFieldFilter=function(e){return FieldFilter.create(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryOrFieldFilter=function(e){if(e.op===Operator.EQUAL){if(e.value.isEqual(DoubleValue.NAN))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}};if(e.value.isEqual(NullValue.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(t,Operator.EQUAL,DoubleValue.NAN);case"IS_NULL":var r=this.fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(r,Operator.EQUAL,NullValue.INSTANCE);case"OPERATOR_UNSPECIFIED":return fail("Unspecified filter");default:return fail("Unknown filter")}},e.prototype.toDocumentMask=function(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map(function(e){return FieldPath.fromServerFormat(e)});return FieldMask.fromArray(t)},e}(),QueryListenersInfo=function(){return function(){this.viewSnap=null,this.targetId=0,this.listeners=[]}}(),EventManager=function(){function e(e){this.syncEngine=e,this.queries=new ObjectMap(function(e){return e.canonicalId()}),this.onlineState=OnlineState.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return e.prototype.listen=function(e){var t=e.query,r=!1,n=this.queries.get(t);(n||(r=!0,n=new QueryListenersInfo,this.queries.set(t,n)),n.listeners.push(e),assert(!e.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),n.viewSnap)&&(e.onViewSnapshot(n.viewSnap)&&this.raiseSnapshotsInSyncEvent());return r?this.syncEngine.listen(t).then(function(e){return n.targetId=e,e}):Promise.resolve(n.targetId)},e.prototype.unlisten=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n,i;return tslib.__generator(this,function(o){return t=e.query,r=!1,(n=this.queries.get(t))&&(i=n.listeners.indexOf(e))>=0&&(n.listeners.splice(i,1),r=0===n.listeners.length),r?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]})})},e.prototype.onWatchChange=function(e){for(var t=!1,r=0,n=e;r<n.length;r++){var i=n[r],o=i.query,a=this.queries.get(o);if(a){for(var s=0,u=a.listeners;s<u.length;s++){u[s].onViewSnapshot(i)&&(t=!0)}a.viewSnap=i}}t&&this.raiseSnapshotsInSyncEvent()},e.prototype.onWatchError=function(e,t){var r=this.queries.get(e);if(r)for(var n=0,i=r.listeners;n<i.length;n++){i[n].onError(t)}this.queries.delete(e)},e.prototype.onOnlineStateChange=function(e){this.onlineState=e;var t=!1;this.queries.forEach(function(r,n){for(var i=0,o=n.listeners;i<o.length;i++){o[i].applyOnlineStateChange(e)&&(t=!0)}}),t&&this.raiseSnapshotsInSyncEvent()},e.prototype.addSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.add(e),e.next()},e.prototype.removeSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.delete(e)},e.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach(function(e){e.next()})},e}(),QueryListener=function(){function e(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=OnlineState.Unknown,this.options=r||{}}return e.prototype.onViewSnapshot=function(e){if(assert(e.docChanges.length>0||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],r=0,n=e.docChanges;r<n.length;r++){var i=n[r];i.type!==ChangeType.Metadata&&t.push(i)}e=new ViewSnapshot(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},e.prototype.onError=function(e){this.queryObserver.error(e)},e.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},e.prototype.shouldRaiseInitialEvent=function(e,t){if(assert(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var r=t!==OnlineState.Offline;return this.options.waitForSyncWhenOnline&&r?(assert(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===OnlineState.Offline},e.prototype.shouldRaiseEvent=function(e){if(e.docChanges.length>0)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},e.prototype.raiseInitialEvent=function(e){assert(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},e}(),LocalViewChanges=function(){function e(e,t,r,n){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=n}return e.fromSnapshot=function(t,r){for(var n=documentKeySet(),i=documentKeySet(),o=0,a=r.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case ChangeType.Added:n=n.add(s.doc.key);break;case ChangeType.Removed:i=i.add(s.doc.key)}}return new e(t,r.fromCache,n,i)},e}(),AddedLimboDocument=function(){return function(e){this.key=e}}(),RemovedLimboDocument=function(){return function(e){this.key=e}}(),View=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=documentKeySet(),this.mutatedKeys=documentKeySet(),this.documentSet=new DocumentSet(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var r=this,n=t?t.changeSet:new DocumentChangeSet,i=t?t.documentSet:this.documentSet,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimitToFirst()&&i.size===this.query.limit?i.last():null,c=this.query.hasLimitToLast()&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=t instanceof Document?t:null;h&&(assert(e.isEqual(h.key),"Mismatching keys found in document changes: "+e+" != "+h.key),h=r.query.matches(h)?h:null);var d=!!l&&r.mutatedKeys.has(l.key),f=!!h&&(h.hasLocalMutations||r.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data().isEqual(h.data())?d!==f&&(n.track({type:ChangeType.Metadata,doc:h}),p=!0):r.shouldWaitForSyncedDocument(l,h)||(n.track({type:ChangeType.Modified,doc:h}),p=!0,(u&&r.query.docComparator(h,u)>0||c&&r.query.docComparator(h,c)<0)&&(s=!0)):!l&&h?(n.track({type:ChangeType.Added,doc:h}),p=!0):l&&!h&&(n.track({type:ChangeType.Removed,doc:l}),p=!0,(u||c)&&(s=!0));p&&(h?(a=a.add(h),o=f?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))}),this.query.hasLimitToFirst()||this.query.hasLimitToLast())for(;a.size>this.query.limit;){var l=this.query.hasLimitToFirst()?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),n.track({type:ChangeType.Removed,doc:l})}return assert(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:n,needsRefill:s,mutatedKeys:o}},e.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,r){var n=this;assert(!e.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var o=e.changeSet.getChanges();o.sort(function(e,t){return compareChangeType(e.type,t.type)||n.query.docComparator(e.doc,t.doc)}),this.applyTargetChange(r);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?SyncState.Synced:SyncState.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new ViewSnapshot(this.query,e.documentSet,i,o,e.mutatedKeys,s===SyncState.Local,u,!1),limboChanges:a}:{limboChanges:a}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===OnlineState.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new DocumentChangeSet,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&(!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations)},e.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.add(e)}),e.modifiedDocuments.forEach(function(e){return assert(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")}),e.removedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)}),this.current=e.current)},e.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=documentKeySet(),this.documentSet.forEach(function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))});var r=[];return t.forEach(function(t){e.limboDocuments.has(t)||r.push(new RemovedLimboDocument(t))}),this.limboDocuments.forEach(function(e){t.has(e)||r.push(new AddedLimboDocument(e))}),r},e.prototype.synchronizeWithPersistedState=function(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=documentKeySet();var t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)},e.prototype.computeInitialSnapshot=function(){return ViewSnapshot.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===SyncState.Local)},e}();function compareChangeType(e,t){var r=function(e){switch(e){case ChangeType.Added:return 1;case ChangeType.Modified:case ChangeType.Metadata:return 2;case ChangeType.Removed:return 0;default:return fail("Unknown ChangeType: "+e)}};return r(e)-r(t)}var RETRY_COUNT=5,TransactionRunner=function(){function e(e,t,r,n){this.asyncQueue=e,this.remoteStore=t,this.updateFunction=r,this.deferred=n,this.retries=RETRY_COUNT,this.backoff=new ExponentialBackoff(this.asyncQueue,TimerId.RetryTransaction)}return e.prototype.run=function(){this.runWithBackOff()},e.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun(function(){return tslib.__awaiter(e,void 0,void 0,function(){var e,t,r=this;return tslib.__generator(this,function(n){return e=this.remoteStore.createTransaction(),(t=this.tryRunUpdateFunction(e))&&t.then(function(t){r.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){r.deferred.resolve(t)}).catch(function(e){r.handleTransactionError(e)})})}).catch(function(e){r.handleTransactionError(e)}),[2]})})})},e.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!isNullOrUndefined(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},e.prototype.handleTransactionError=function(e){var t=this;this.retries>0&&this.isRetryableTransactionError(e)?(this.retries-=1,this.asyncQueue.enqueueAndForget(function(){return t.runWithBackOff(),Promise.resolve()})):this.deferred.reject(e)},e.prototype.isRetryableTransactionError=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!isPermanentError(t)}return!1},e}(),LOG_TAG$9="SyncEngine",QueryView=function(){return function(e,t,r){this.query=e,this.targetId=t,this.view=r}}(),LimboResolution=function(){return function(e){this.key=e,this.receivedDocument=!1}}(),SyncEngine=function(){function e(e,t,r,n){this.localStore=e,this.remoteStore=t,this.sharedClientState=r,this.currentUser=n,this.syncEngineListener=null,this.queryViewsByQuery=new ObjectMap(function(e){return e.canonicalId()}),this.queriesByTarget={},this.limboTargetsByKey=new SortedMap(DocumentKey.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ReferenceSet,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=TargetIdGenerator.forSyncEngine(),this.isPrimary=void 0,this.onlineState=OnlineState.Unknown}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){assert(null!==e,"SyncEngine listener cannot be null"),assert(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},e.prototype.listen=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n,i,o;return tslib.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(n=this.queryViewsByQuery.get(e))?(t=n.targetId,this.sharedClientState.addLocalQueryTarget(t),r=n.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateTarget(e.toTarget())];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),t=i.targetId,[4,this.initializeViewAndComputeSnapshot(e,t,"current"===o)];case 3:r=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([r]),[2,t]}})})},e.prototype.initializeViewAndComputeSnapshot=function(e,t,r){return tslib.__awaiter(this,void 0,void 0,function(){var n,i,o,a,s,u;return tslib.__generator(this,function(c){switch(c.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return n=c.sent(),i=new View(e,n.remoteKeys),o=i.computeDocChanges(n.documents),a=TargetChange.createSynthesizedTargetChangeForCurrentChange(t,r&&this.onlineState!==OnlineState.Offline),assert(0===(s=i.applyChanges(o,!0===this.isPrimary,a)).limboChanges.length,"View returned limbo docs before target ack from the server."),assert(!!s.snapshot,"applyChanges for new view should always return a snapshot"),u=new QueryView(e,t,i),this.queryViewsByQuery.set(e,u),this.queriesByTarget[t]||(this.queriesByTarget[t]=[]),this.queriesByTarget[t].push(e),[2,s.snapshot]}})})},e.prototype.synchronizeViewAndComputeSnapshot=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r;return tslib.__generator(this,function(n){switch(n.label){case 0:return[4,this.localStore.executeQuery(e.query,!0)];case 1:return t=n.sent(),r=e.view.synchronizeWithPersistedState(t),this.isPrimary&&this.updateTrackedLimbos(e.targetId,r.limboChanges),[2,r]}})})},e.prototype.unlisten=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n=this;return tslib.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),assert(!!(t=this.queryViewsByQuery.get(e)),"Trying to unlisten on query not found:"+e),(r=this.queriesByTarget[t.targetId]).length>1?(this.queriesByTarget[t.targetId]=r.filter(function(t){return!t.isEqual(e)}),this.queryViewsByQuery.delete(e),[2]):this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.sharedClientState.isActiveQueryTarget(t.targetId)?[3,2]:[4,this.localStore.releaseTarget(t.targetId,!1).then(function(){n.sharedClientState.clearQueryState(t.targetId),n.remoteStore.unlisten(t.targetId),n.removeAndCleanupTarget(t.targetId)}).catch(ignoreIfPrimaryLeaseLoss)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupTarget(t.targetId),[4,this.localStore.releaseTarget(t.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},e.prototype.write=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r;return tslib.__generator(this,function(n){switch(n.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(e)];case 1:return r=n.sent(),this.sharedClientState.addPendingMutation(r.batchId),this.addMutationCallback(r.batchId,t),[4,this.emitNewSnapsAndNotifyLocalStore(r.changes)];case 2:return n.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return n.sent(),[2]}})})},e.prototype.runTransaction=function(e,t,r){new TransactionRunner(e,this.remoteStore,t,r).run()},e.prototype.applyRemoteEvent=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r=this;return tslib.__generator(this,function(n){switch(n.label){case 0:this.assertSubscribed("applyRemoteEvent()"),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(e)];case 2:return t=n.sent(),forEach(e.targetChanges,function(e,t){var n=r.limboResolutionsByTarget[Number(e)];n&&(assert(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),t.addedDocuments.size>0?n.receivedDocument=!0:t.modifiedDocuments.size>0?assert(n.receivedDocument,"Received change for limbo target document without add."):t.removedDocuments.size>0&&(assert(n.receivedDocument,"Received remove for limbo target document without add."),n.receivedDocument=!1))}),[4,this.emitNewSnapsAndNotifyLocalStore(t,e)];case 3:return n.sent(),[3,6];case 4:return[4,ignoreIfPrimaryLeaseLoss(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},e.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===OnlineStateSource.RemoteStore||!this.isPrimary&&t===OnlineStateSource.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var r=[];this.queryViewsByQuery.forEach(function(t,n){var i=n.view.applyOnlineStateChange(e);assert(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&r.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(r),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},e.prototype.rejectListen=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r,n,i,o,a,s=this;return tslib.__generator(this,function(u){switch(u.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),r=this.limboResolutionsByTarget[e],(n=r&&r.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(n),delete this.limboResolutionsByTarget[e],i=(i=new SortedMap(DocumentKey.comparator)).insert(n,new NoDocument(n,SnapshotVersion.forDeletedDoc())),o=documentKeySet().add(n),a=new RemoteEvent(SnapshotVersion.MIN,{},new SortedSet(primitiveComparator),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return[4,this.localStore.releaseTarget(e,!1).then(function(){return s.removeAndCleanupTarget(e,t)}).catch(ignoreIfPrimaryLeaseLoss)];case 2:u.sent(),u.label=3;case 3:return[2]}})})},e.prototype.applyBatchState=function(e,t,r){return tslib.__awaiter(this,void 0,void 0,function(){var n;return tslib.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(n=i.sent())?(debug(LOG_TAG$9,"Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,r||null),this.localStore.removeCachedMutationBatchMetadata(e)):fail("Unknown batchState: "+t),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 5:return i.sent(),[2]}})})},e.prototype.applySuccessfulWrite=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r;return tslib.__generator(this,function(n){switch(n.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),t=e.batch.batchId,this.processUserCallback(t,null),this.triggerPendingWritesCallbacks(t),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(e)];case 2:return r=n.sent(),this.sharedClientState.updateMutationState(t,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 3:return n.sent(),[3,6];case 4:return[4,ignoreIfPrimaryLeaseLoss(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},e.prototype.rejectFailedWrite=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r;return tslib.__generator(this,function(n){switch(n.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.triggerPendingWritesCallbacks(e),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(e)];case 2:return r=n.sent(),this.sharedClientState.updateMutationState(e,"rejected",t),[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 3:return n.sent(),[3,6];case 4:return[4,ignoreIfPrimaryLeaseLoss(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},e.prototype.registerPendingWritesCallback=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r;return tslib.__generator(this,function(n){switch(n.label){case 0:return this.remoteStore.canUseNetwork()||debug(LOG_TAG$9,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return(t=n.sent())===BATCHID_UNKNOWN?(e.resolve(),[2]):((r=this.pendingWritesCallbacks.get(t)||[]).push(e),this.pendingWritesCallbacks.set(t,r),[2])}})})},e.prototype.triggerPendingWritesCallbacks=function(e){(this.pendingWritesCallbacks.get(e)||[]).forEach(function(e){e.resolve()}),this.pendingWritesCallbacks.delete(e)},e.prototype.rejectOutstandingPendingWritesCallbacks=function(e){this.pendingWritesCallbacks.forEach(function(t){t.forEach(function(t){t.reject(new FirestoreError(Code.CANCELLED,e))})}),this.pendingWritesCallbacks.clear()},e.prototype.addMutationCallback=function(e,t){var r=this.mutationUserCallbacks[this.currentUser.toKey()];r||(r=new SortedMap(primitiveComparator)),r=r.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=r},e.prototype.processUserCallback=function(e,t){var r=this.mutationUserCallbacks[this.currentUser.toKey()];if(r){var n=r.get(e);n&&(assert(e===r.minKey(),"Mutation callbacks processed out-of-order?"),t?n.reject(t):n.resolve(),r=r.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=r}},e.prototype.removeAndCleanupTarget=function(e,t){var r=this;void 0===t&&(t=null),this.sharedClientState.removeLocalQueryTarget(e),assert(this.queriesByTarget[e]&&0!==this.queriesByTarget[e].length,"There are no queries mapped to target id "+e);for(var n=0,i=this.queriesByTarget[e];n<i.length;n++){var o=i[n];this.queryViewsByQuery.delete(o),t&&this.syncEngineListener.onWatchError(o,t)}if(delete this.queriesByTarget[e],this.isPrimary){var a=this.limboDocumentRefs.referencesForId(e);this.limboDocumentRefs.removeReferencesForId(e),a.forEach(function(e){r.limboDocumentRefs.containsKey(e)||r.removeLimboTarget(e)})}},e.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},e.prototype.updateTrackedLimbos=function(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i instanceof AddedLimboDocument)this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i);else if(i instanceof RemovedLimboDocument){debug(LOG_TAG$9,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)}else fail("Unknown limbo change: "+JSON.stringify(i))}},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){debug(LOG_TAG$9,"New document in limbo: "+t);var r=this.limboTargetIdGenerator.next(),n=Query.atPath(t.path);this.limboResolutionsByTarget[r]=new LimboResolution(t),this.remoteStore.listen(new TargetData(n.toTarget(),r,TargetPurpose.LimboResolution,ListenSequence.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,r)}},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r,n,i,o=this;return tslib.__generator(this,function(a){switch(a.label){case 0:return r=[],n=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var t=s.view.computeDocChanges(e);return t.needsRefill?o.localStore.executeQuery(s.query,!1).then(function(e){var r=e.documents;return s.view.computeDocChanges(r,t)}):t}).then(function(e){var i=t&&t.targetChanges[s.targetId],a=s.view.applyChanges(e,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),r.push(a.snapshot);var u=LocalViewChanges.fromSnapshot(s.targetId,a.snapshot);n.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(r),[4,this.localStore.notifyLocalViewChanges(n)];case 2:return a.sent(),[2]}})})},e.prototype.assertSubscribed=function(e){assert(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleCredentialChange=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r;return tslib.__generator(this,function(n){switch(n.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(e)]):[3,3];case 1:return r=n.sent(),this.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(r.affectedDocuments)];case 2:n.sent(),n.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return n.sent(),[2]}})})},e.prototype.applyPrimaryState=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n,i,o,a,s,u=this;return tslib.__generator(this,function(c){switch(c.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(r=c.sent(),n=0,i=r;n<i.length;n++)o=i[n],this.remoteStore.listen(o);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),forEachNumber(this.queriesByTarget,function(e,t){u.sharedClientState.isLocalQueryTarget(e)?a.push(e):s=s.then(function(){return u.removeAndCleanupTarget(e),u.localStore.releaseTarget(e,!0)}),u.remoteStore.unlisten(e)}),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})},e.prototype.resetLimboDocuments=function(){var e=this;forEachNumber(this.limboResolutionsByTarget,function(t){e.remoteStore.unlisten(t)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new SortedMap(DocumentKey.comparator)},e.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){return tslib.__awaiter(this,void 0,void 0,function(){var t,r,n,i,o,a,s,u,c,l,h,d,f;return tslib.__generator(this,function(p){switch(p.label){case 0:t=[],r=[],n=0,i=e,p.label=1;case 1:return n<i.length?(o=i[n],a=void 0,(s=this.queriesByTarget[o])&&0!==s.length?[4,this.localStore.releaseTarget(o,!0)]:[3,8]):[3,14];case 2:return p.sent(),[4,this.localStore.allocateTarget(s[0].toTarget())];case 3:a=p.sent(),u=0,c=s,p.label=4;case 4:return u<c.length?(l=c[u],assert(!!(h=this.queryViewsByQuery.get(l)),"No query view found for "+l),[4,this.synchronizeViewAndComputeSnapshot(h)]):[3,7];case 5:(d=p.sent()).snapshot&&r.push(d.snapshot),p.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return assert(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.localStore.getTarget(o)];case 9:return assert(!!(f=p.sent()),"Target for id "+o+" not found"),[4,this.localStore.allocateTarget(f)];case 10:return a=p.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(f),o,!1)];case 11:p.sent(),p.label=12;case 12:t.push(a),p.label=13;case 13:return n++,[3,1];case 14:return this.syncEngineListener.onWatchChange(r),[2,t]}})})},e.prototype.synthesizeTargetToQuery=function(e){return new Query(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,LimitType.First,e.startAt,e.endAt)},e.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},e.prototype.applyTargetState=function(e,t,r){return tslib.__awaiter(this,void 0,void 0,function(){var n,i;return tslib.__generator(this,function(o){switch(o.label){case 0:if(this.isPrimary)return debug(LOG_TAG$9,"Ignoring unexpected query state notification."),[2];if(!this.queriesByTarget[e])return[3,7];switch(t){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return n=o.sent(),i=RemoteEvent.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(n,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.localStore.releaseTarget(e,!0)];case 5:return o.sent(),this.removeAndCleanupTarget(e,r),[3,7];case 6:fail("Unexpected target state: "+t),o.label=7;case 7:return[2]}})})},e.prototype.applyActiveTargetsChange=function(e,t){return tslib.__awaiter(this,void 0,void 0,function(){var r,n,i,o,a,s,u,c,l,h=this;return tslib.__generator(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];r=0,n=e,d.label=1;case 1:return r<n.length?(l=n[r],assert(!this.queriesByTarget[l],"Trying to add an already active target"),[4,this.localStore.getTarget(l)]):[3,6];case 2:return assert(!!(i=d.sent()),"Query data for active target "+l+" not found"),[4,this.localStore.allocateTarget(i)];case 3:return o=d.sent(),[4,this.initializeViewAndComputeSnapshot(this.synthesizeTargetToQuery(i),o.targetId,!1)];case 4:d.sent(),this.remoteStore.listen(o),d.label=5;case 5:return r++,[3,1];case 6:a=function(e){return tslib.__generator(this,function(t){switch(t.label){case 0:return s.queriesByTarget[e]?[4,s.localStore.releaseTarget(e,!1).then(function(){h.remoteStore.unlisten(e),h.removeAndCleanupTarget(e)}).catch(ignoreIfPrimaryLeaseLoss)]:[2,"continue"];case 1:return t.sent(),[2]}})},s=this,u=0,c=t,d.label=7;case 7:return u<c.length?(l=c[u],[5,a(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},e.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},e.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},e.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];if(t&&t.receivedDocument)return documentKeySet().add(t.key);var r=documentKeySet(),n=this.queriesByTarget[e];if(!n)return r;for(var i=0,o=n;i<o.length;i++){var a=o[i],s=this.queryViewsByQuery.get(a);assert(!!s,"No query view found for "+a),r=r.unionWith(s.view.syncedDocuments)}return r},e}(),User=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),CLIENT_STATE_KEY_PREFIX="firestore_clients";function createWebStorageClientStateKey(e,t){return assert(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),CLIENT_STATE_KEY_PREFIX+"_"+e+"_"+t}var MUTATION_BATCH_KEY_PREFIX="firestore_mutations";function createWebStorageMutationBatchKey(e,t,r){var n=MUTATION_BATCH_KEY_PREFIX+"_"+e+"_"+r;return t.isAuthenticated()&&(n+="_"+t.uid),n}var QUERY_TARGET_KEY_PREFIX="firestore_targets";function createWebStorageQueryTargetMetadataKey(e,t){return QUERY_TARGET_KEY_PREFIX+"_"+e+"_"+t}var ONLINE_STATE_KEY_PREFIX="firestore_online_state";function createWebStorageOnlineStateKey(e){return ONLINE_STATE_KEY_PREFIX+"_"+e}var SEQUENCE_NUMBER_KEY_PREFIX="firestore_sequence_number";function createWebStorageSequenceNumberKey(e){return SEQUENCE_NUMBER_KEY_PREFIX+"_"+e}var LOG_TAG$a="SharedClientState",MutationMetadata=function(){function e(e,t,r,n){this.user=e,this.batchId=t,this.state=r,this.error=n,assert(void 0!==n==("rejected"===r),"MutationMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,r,n){var i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new FirestoreError(i.error.code,i.error.message)),o?new e(t,r,i.state,a):(error(LOG_TAG$a,"Failed to parse mutation state for ID '"+r+"': "+n),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),QueryTargetMetadata=function(){function e(e,t,r){this.targetId=e,this.state=t,this.error=r,assert(void 0!==r==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,r){var n=JSON.parse(r),i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),o=void 0;return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(o=new FirestoreError(n.error.code,n.error.message)),i?new e(t,n.state,o):(error(LOG_TAG$a,"Failed to parse target state for ID '"+t+"': "+r),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),RemoteClientState=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.fromWebStorageEntry=function(t,r){for(var n=JSON.parse(r),i="object"==typeof n&&n.activeTargetIds instanceof Array,o=targetIdSet(),a=0;i&&a<n.activeTargetIds.length;++a)i=isSafeInteger(n.activeTargetIds[a]),o=o.add(n.activeTargetIds[a]);return i?new e(t,o):(error(LOG_TAG$a,"Failed to parse client data for instance '"+t+"': "+r),null)},e}(),SharedOnlineState=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.fromWebStorageEntry=function(t){var r=JSON.parse(t);return"object"==typeof r&&r.onlineState in OnlineState&&"string"==typeof r.clientId?new e(r.clientId,OnlineState[r.onlineState]):(error(LOG_TAG$a,"Failed to parse online state: "+t),null)},e}(),LocalClientState=function(){function e(){this.activeTargetIds=targetIdSet()}return e.prototype.addQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),WebStorageSharedClientState=function(){function e(t,r,n,i,o){if(this.queue=t,this.platform=r,this.persistenceKey=n,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!e.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=createWebStorageClientStateKey(this.persistenceKey,this.localClientId),this.sequenceNumberKey=createWebStorageSequenceNumberKey(this.persistenceKey),this.activeClients[this.localClientId]=new LocalClientState,this.clientStateKeyRe=new RegExp("^"+CLIENT_STATE_KEY_PREFIX+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+MUTATION_BATCH_KEY_PREFIX+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+QUERY_TARGET_KEY_PREFIX+"_"+a+"_(\\d+)$"),this.onlineStateKey=createWebStorageOnlineStateKey(this.persistenceKey),this.platform.window.addEventListener("storage",this.storageListener)}return e.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},e.prototype.start=function(){return tslib.__awaiter(this,void 0,void 0,function(){var e,t,r,n,i,o,a,s,u,c,l,h=this;return tslib.__generator(this,function(d){switch(d.label){case 0:return assert(!this.started,"WebStorageSharedClientState already started"),assert(null!==this.syncEngine,"syncEngine property must be set before calling start()"),assert(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=d.sent(),t=0,r=e;t<r.length;t++)(n=r[t])!==this.localClientId&&(i=this.getItem(createWebStorageClientStateKey(this.persistenceKey,n)))&&(o=RemoteClientState.fromWebStorageEntry(n,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)l=c[u],this.handleWebStorageEvent(l);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return h.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){var e=targetIdSet();return forEach(this.activeClients,function(t,r){e=e.unionWith(r.activeTargetIds)}),e},e.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},e.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},e.prototype.updateMutationState=function(e,t,r){this.persistMutationState(e,t,r),this.removeMutationState(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var r=this.storage.getItem(createWebStorageQueryTargetMetadataKey(this.persistenceKey,e));if(r){var n=QueryTargetMetadata.fromWebStorageEntry(e,r);n&&(t=n.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},e.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},e.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(createWebStorageQueryTargetMetadataKey(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,r){this.persistQueryTargetState(e,t,r)},e.prototype.handleUserChange=function(e,t,r){var n=this;t.forEach(function(e){n.removeMutationState(e)}),this.currentUser=e,r.forEach(function(e){n.addPendingMutation(e)})},e.prototype.setOnlineState=function(e){this.persistOnlineState(e)},e.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return debug(LOG_TAG$a,"READ",e,t),t},e.prototype.setItem=function(e,t){debug(LOG_TAG$a,"SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){debug(LOG_TAG$a,"REMOVE",e),this.storage.removeItem(e)},e.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(debug(LOG_TAG$a,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void error("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return tslib.__awaiter(t,void 0,void 0,function(){var t,r,n,i,o,a;return tslib.__generator(this,function(s){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return r=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(r,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(n=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(n)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(i=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(o=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(o)]}else e.key===this.sequenceNumberKey&&(assert(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=fromWebStorageSequenceNumber(e.newValue))!==ListenSequence.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(e.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),e.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},e.prototype.persistMutationState=function(e,t,r){var n=new MutationMetadata(this.currentUser,e,t,r),i=createWebStorageMutationBatchKey(this.persistenceKey,this.currentUser,e);this.setItem(i,n.toWebStorageJSON())},e.prototype.removeMutationState=function(e){var t=createWebStorageMutationBatchKey(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.persistOnlineState=function(e){var t={clientId:this.localClientId,onlineState:OnlineState[e]};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))},e.prototype.persistQueryTargetState=function(e,t,r){var n=createWebStorageQueryTargetMetadataKey(this.persistenceKey,e),i=new QueryTargetMetadata(e,t,r);this.setItem(n,i.toWebStorageJSON())},e.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},e.prototype.fromWebStorageClientState=function(e,t){var r=this.fromWebStorageClientStateKey(e);return assert(null!==r,"Cannot parse client state key '"+e+"'"),RemoteClientState.fromWebStorageEntry(r,t)},e.prototype.fromWebStorageMutationMetadata=function(e,t){var r=this.mutationBatchKeyRe.exec(e);assert(null!==r,"Cannot parse mutation batch key '"+e+"'");var n=Number(r[1]),i=void 0!==r[2]?r[2]:null;return MutationMetadata.fromWebStorageEntry(new User(i),n,t)},e.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var r=this.queryTargetKeyRe.exec(e);assert(null!==r,"Cannot parse query target key '"+e+"'");var n=Number(r[1]);return QueryTargetMetadata.fromWebStorageEntry(n,t)},e.prototype.fromWebStorageOnlineState=function(e){return SharedOnlineState.fromWebStorageEntry(e)},e.prototype.handleMutationBatchEvent=function(e){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(t){return e.user.uid!==this.currentUser.uid?(debug(LOG_TAG$a,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]})})},e.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},e.prototype.handleClientStateEvent=function(e,t){var r=this,n=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(e){return tslib.__awaiter(r,void 0,void 0,function(){return tslib.__generator(this,function(t){return n.has(e)||o.push(e),[2]})})}),n.forEach(function(e){return tslib.__awaiter(r,void 0,void 0,function(){return tslib.__generator(this,function(t){return i.has(e)||a.push(e),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},e.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},e}();function fromWebStorageSequenceNumber(e){var t=ListenSequence.INVALID;if(null!=e)try{var r=JSON.parse(e);assert("number"==typeof r,"Found non-numeric sequence number"),t=r}catch(e){error(LOG_TAG$a,"Failed to read sequence number from WebStorage",e)}return t}var MemorySharedClientState=function(){function e(){this.localState=new LocalClientState,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,r){},e.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},e.prototype.updateQueryState=function(e,t,r){this.queryState[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},e.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.queryState[e]},e.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.start=function(){return this.localState=new LocalClientState,Promise.resolve()},e.prototype.handleUserChange=function(e,t,r){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e}(),LOG_TAG$b="FirestoreClient",DOM_EXCEPTION_INVALID_STATE=11,DOM_EXCEPTION_ABORTED=20,DOM_EXCEPTION_QUOTA_EXCEEDED=22,IndexedDbPersistenceSettings=function(){function e(e,t){this.cacheSizeBytes=e,this.synchronizeTabs=t}return e.prototype.lruParams=function(){return LruParams.withCacheSize(this.cacheSizeBytes)},e}(),MemoryPersistenceSettings=function(){return function(){}}(),FirestoreClient=function(){function e(e,t,r,n){this.platform=e,this.databaseInfo=t,this.credentials=r,this.asyncQueue=n,this.clientId=AutoId.newId()}return e.prototype.start=function(e){var t=this;this.verifyNotTerminated();var r=new Deferred,n=new Deferred,i=!1;return this.credentials.setChangeListener(function(o){i?t.asyncQueue.enqueueAndForget(function(){return t.handleCredentialChange(o)}):(i=!0,t.initializePersistence(e,n,o).then(function(e){return t.initializeRest(o,e)}).then(r.resolve,r.reject))}),this.asyncQueue.enqueueAndForget(function(){return r.promise}),n.promise},e.prototype.enableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.syncEngine.enableNetwork()})},e.prototype.initializePersistence=function(e,t,r){var n=this;return e instanceof IndexedDbPersistenceSettings?this.startIndexedDbPersistence(r,e).then(function(e){return t.resolve(),e}).catch(function(e){if(t.reject(e),!n.canFallback(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),n.startMemoryPersistence()}):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e instanceof FirestoreError?e.code===Code.FAILED_PRECONDITION||e.code===Code.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(e.code===DOM_EXCEPTION_QUOTA_EXCEEDED||e.code===DOM_EXCEPTION_ABORTED||e.code===DOM_EXCEPTION_INVALID_STATE)},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new FirestoreError(Code.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.startIndexedDbPersistence=function(e,t){var r=this,n=IndexedDbPersistence.buildStoragePrefix(this.databaseInfo),i=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return tslib.__awaiter(r,void 0,void 0,function(){var r,o;return tslib.__generator(this,function(a){switch(a.label){case 0:if(t.synchronizeTabs&&!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return r=t.lruParams(),this.sharedClientState=t.synchronizeTabs?new WebStorageSharedClientState(this.asyncQueue,this.platform,n,this.clientId,e):new MemorySharedClientState,[4,IndexedDbPersistence.createIndexedDbPersistence({allowTabSynchronization:t.synchronizeTabs,persistenceKey:n,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:r,sequenceNumberSyncer:this.sharedClientState})];case 1:return o=a.sent(),this.persistence=o,[2,o.referenceDelegate.garbageCollector]}})})})},e.prototype.startMemoryPersistence=function(){return this.persistence=MemoryPersistence.createEagerPersistence(this.clientId),this.sharedClientState=new MemorySharedClientState,Promise.resolve(null)},e.prototype.initializeRest=function(e,t){var r=this;return debug(LOG_TAG$b,"Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then(function(n){return tslib.__awaiter(r,void 0,void 0,function(){var r,i,o,a,s,u,c=this;return tslib.__generator(this,function(l){switch(l.label){case 0:return r=new IndexFreeQueryEngine,this.localStore=new LocalStore(this.persistence,r,e),[4,this.localStore.start()];case 1:return l.sent(),t&&(this.lruScheduler=new LruScheduler(t,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),o=this.platform.newSerializer(this.databaseInfo.databaseId),a=new Datastore(this.asyncQueue,n,this.credentials,o),s=function(e){return c.syncEngine.applyOnlineStateChange(e,OnlineStateSource.RemoteStore)},u=function(e){return c.syncEngine.applyOnlineStateChange(e,OnlineStateSource.SharedClientState)},this.remoteStore=new RemoteStore(this.localStore,a,this.asyncQueue,s,i),this.syncEngine=new SyncEngine(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new EventManager(this.syncEngine),[4,this.sharedClientState.start()];case 2:return l.sent(),[4,this.remoteStore.start()];case 3:return l.sent(),[4,this.persistence.setPrimaryStateListener(function(e){return tslib.__awaiter(c,void 0,void 0,function(){return tslib.__generator(this,function(t){switch(t.label){case 0:return[4,this.syncEngine.applyPrimaryState(e)];case 1:return t.sent(),this.lruScheduler&&(e&&!this.lruScheduler.started?this.lruScheduler.start():e||this.lruScheduler.stop()),[2]}})})})];case 4:return l.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return tslib.__awaiter(c,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}})})})];case 5:return l.sent(),[2]}})})})},e.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),debug(LOG_TAG$b,"Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.syncEngine.disableNetwork()})},e.prototype.terminate=function(){var e=this;return this.asyncQueue.enqueueAndInitiateShutdown(function(){return tslib.__awaiter(e,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown()];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}})})})},e.prototype.waitForPendingWrites=function(){var e=this;this.verifyNotTerminated();var t=new Deferred;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.registerPendingWritesCallback(t)}),t.promise},e.prototype.listen=function(e,t,r){var n=this;this.verifyNotTerminated();var i=new QueryListener(e,t,r);return this.asyncQueue.enqueueAndForget(function(){return n.eventMgr.listen(i)}),i},e.prototype.unlisten=function(e){var t=this;this.clientTerminated||this.asyncQueue.enqueueAndForget(function(){return t.eventMgr.unlisten(e)})},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.localStore.readDocument(e)}).then(function(e){if(e instanceof Document)return e;if(e instanceof NoDocument)return null;throw new FirestoreError(Code.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},e.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return tslib.__awaiter(t,void 0,void 0,function(){var t,r,n;return tslib.__generator(this,function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return t=i.sent(),r=new View(e,t.remoteKeys),n=r.computeDocChanges(t.documents),[2,r.applyChanges(n,!1).snapshot]}})})})},e.prototype.write=function(e){var t=this;this.verifyNotTerminated();var r=new Deferred;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.write(e,r)}),r.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.addSnapshotsInSyncListener=function(e){var t=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget(function(){return t.eventMgr.addSnapshotsInSyncListener(e),Promise.resolve()})},e.prototype.removeSnapshotsInSyncListener=function(e){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(e)},Object.defineProperty(e.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.transaction=function(e){var t=this;this.verifyNotTerminated();var r=new Deferred;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.runTransaction(t.asyncQueue,e,r),Promise.resolve()}),r.promise},e}(),AsyncObserver=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var r=this;this.muted||setTimeout(function(){r.muted||e(t)},0)},e}(),FieldPath$1=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateNamedArrayAtLeastNumberOfElements("FieldPath",e,"fieldNames",1);for(var r=0;r<e.length;++r)if(validateArgType("FieldPath","string",r,e[r]),0===e[r].length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath(e)}return e.documentId=function(){return e._DOCUMENT_ID},e.prototype.isEqual=function(t){if(!(t instanceof e))throw invalidClassError("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},e._DOCUMENT_ID=new e(FieldPath.keyField().canonicalString()),e}(),RESERVED=new RegExp("[~\\*/\\[\\]]");function fromDotSeparatedString(e){if(e.search(RESERVED)>=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(FieldPath$1.bind.apply(FieldPath$1,tslib.__spreadArrays([void 0],e.split("."))))}catch(t){throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}var OAuthToken=function(){return function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e}}(),EmptyCredentialsProvider=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){assert(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(User.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){assert(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},e}(),FirebaseCredentialsProvider=function(){function e(e){var t=this;this.tokenListener=null,this.currentUser=User.UNAUTHENTICATED,this.receivedInitialUser=!1,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.tokenListener):(this.tokenListener(null),e.get().then(function(e){t.auth=e,t.tokenListener&&t.auth.addAuthTokenListener(t.tokenListener)},function(){}))}return e.prototype.getToken=function(){var e=this;assert(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(function(r){if(e.tokenCounter!==t)throw new FirestoreError(Code.ABORTED,"getToken aborted due to token change.");return r?(assert("string"==typeof r.accessToken,"Invalid tokenData returned from getToken():"+r),new OAuthToken(r.accessToken,e.currentUser)):null}):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){assert(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},e.prototype.removeChangeListener=function(){assert(null!=this.tokenListener,"removeChangeListener() called twice"),assert(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},e.prototype.getUser=function(){var e=this.auth&&this.auth.getUid();return assert(null===e||"string"==typeof e,"Received invalid UID: "+e),new User(e)},e}(),FirstPartyToken=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=User.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!0,configurable:!0}),e}(),FirstPartyCredentialsProvider=function(){function e(e,t){this.gapi=e,this.sessionIndex=t}return e.prototype.getToken=function(){return Promise.resolve(new FirstPartyToken(this.gapi,this.sessionIndex))},e.prototype.setChangeListener=function(e){e(User.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function makeCredentialsProvider(e){if(!e)return new EmptyCredentialsProvider;switch(e.type){case"gapi":var t=e.client;return assert(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new FirstPartyCredentialsProvider(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new FirestoreError(Code.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function isPartialObserver(e){return implementsAnyMethods(e,["next","error","complete"])}function implementsAnyMethods(e,t){if("object"!=typeof e||null===e)return!1;for(var r=e,n=0,i=t;n<i.length;n++){var o=i[n];if(o in r&&"function"==typeof r[o])return!0}return!1}var UserDataSource,FieldValueImpl=function(){function e(e){this._methodName=e}return e.delete=function(){return validateNoArgs("FieldValue.delete",arguments),DeleteFieldValueImpl.instance},e.serverTimestamp=function(){return validateNoArgs("FieldValue.serverTimestamp",arguments),ServerTimestampFieldValueImpl.instance},e.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return validateAtLeastNumberOfArgs("FieldValue.arrayUnion",arguments,1),new ArrayUnionFieldValueImpl(e)},e.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return validateAtLeastNumberOfArgs("FieldValue.arrayRemove",arguments,1),new ArrayRemoveFieldValueImpl(e)},e.increment=function(e){return validateArgType("FieldValue.increment","number",1,e),validateExactNumberOfArgs("FieldValue.increment",arguments,1),new NumericIncrementFieldValueImpl(e)},e.prototype.isEqual=function(e){return this===e},e}(),DeleteFieldValueImpl=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return tslib.__extends(t,e),t.instance=new t,t}(FieldValueImpl),ServerTimestampFieldValueImpl=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return tslib.__extends(t,e),t.instance=new t,t}(FieldValueImpl),ArrayUnionFieldValueImpl=function(e){function t(t){var r=e.call(this,"FieldValue.arrayUnion")||this;return r._elements=t,r}return tslib.__extends(t,e),t}(FieldValueImpl),ArrayRemoveFieldValueImpl=function(e){function t(t){var r=e.call(this,"FieldValue.arrayRemove")||this;return r._elements=t,r}return tslib.__extends(t,e),t}(FieldValueImpl),NumericIncrementFieldValueImpl=function(e){function t(t){var r=e.call(this,"FieldValue.increment")||this;return r._operand=t,r}return tslib.__extends(t,e),t}(FieldValueImpl),PublicFieldValue=makeConstructorPrivate(FieldValueImpl,"Use FieldValue.<field>() instead."),RESERVED_FIELD_REGEX=/^__.*__$/,ParsedSetData=function(){function e(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}return e.prototype.toMutations=function(e,t){var r=[];return null!==this.fieldMask?r.push(new PatchMutation(e,this.data,this.fieldMask,t)):r.push(new SetMutation(e,this.data,t)),this.fieldTransforms.length>0&&r.push(new TransformMutation(e,this.fieldTransforms)),r},e}(),ParsedUpdateData=function(){function e(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}return e.prototype.toMutations=function(e,t){var r=[new PatchMutation(e,this.data,this.fieldMask,t)];return this.fieldTransforms.length>0&&r.push(new TransformMutation(e,this.fieldTransforms)),r},e}();function isWrite(e){switch(e){case UserDataSource.Set:case UserDataSource.MergeSet:case UserDataSource.Update:return!0;case UserDataSource.Argument:case UserDataSource.ArrayArgument:return!1;default:throw fail("Unexpected case for UserDataSource: "+e)}}!function(e){e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.MergeSet=2]="MergeSet",e[e.Argument=3]="Argument",e[e.ArrayArgument=4]="ArrayArgument"}(UserDataSource||(UserDataSource={}));var ParseContext=function(){function e(e,t,r,n,i,o){this.dataSource=e,this.methodName=t,this.path=r,this.arrayElement=n,void 0===i&&this.validatePath(),this.arrayElement=void 0!==n&&n,this.fieldTransforms=i||[],this.fieldMask=o||[]}return e.prototype.childContextForField=function(t){var r=null==this.path?null:this.path.child(t),n=new e(this.dataSource,this.methodName,r,!1,this.fieldTransforms,this.fieldMask);return n.validatePathSegment(t),n},e.prototype.childContextForFieldPath=function(t){var r=null==this.path?null:this.path.child(t),n=new e(this.dataSource,this.methodName,r,!1,this.fieldTransforms,this.fieldMask);return n.validatePath(),n},e.prototype.childContextForArray=function(t){return new e(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},e.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new FirestoreError(Code.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},e.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},e.prototype.validatePathSegment=function(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(isWrite(this.dataSource)&&RESERVED_FIELD_REGEX.test(e))throw this.createError('Document fields cannot begin and end with "__"')},e}(),DocumentKeyReference=function(){return function(e,t){this.databaseId=e,this.key=t}}(),UserDataConverter=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var r=new ParseContext(UserDataSource.Set,e,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",r,t);var n=this.parseData(t,r);return new ParsedSetData(n,null,r.fieldTransforms)},e.prototype.parseMergeData=function(e,t,r){var n=new ParseContext(UserDataSource.MergeSet,e,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",n,t);var i,o,a=this.parseData(t,n);if(r){for(var s=new SortedSet(FieldPath.comparator),u=0,c=r;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof FieldPath$1)h=l._internalPath;else{if("string"!=typeof l)throw fail("Expected stringOrFieldPath to be a string or a FieldPath");h=fieldPathFromDotSeparatedString(e,l)}if(!n.contains(h))throw new FirestoreError(Code.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=FieldMask.fromSet(s),o=n.fieldTransforms.filter(function(e){return i.covers(e.field)})}else i=FieldMask.fromArray(n.fieldMask),o=n.fieldTransforms;return new ParsedSetData(a,i,o)},e.prototype.parseUpdateData=function(e,t){var r=this,n=new ParseContext(UserDataSource.Update,e,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",n,t);var i=new SortedSet(FieldPath.comparator),o=ObjectValue.EMPTY;forEach(t,function(t,a){var s=fieldPathFromDotSeparatedString(e,t),u=n.childContextForFieldPath(s);if((a=r.runPreConverter(a,u))instanceof DeleteFieldValueImpl)i=i.add(s);else{var c=r.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=FieldMask.fromSet(i);return new ParsedUpdateData(o,a,n.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,r,n){var i=new ParseContext(UserDataSource.Update,e,FieldPath.EMPTY_PATH),o=[fieldPathFromArgument(e,t)],a=[r];if(n.length%2!=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<n.length;s+=2)o.push(fieldPathFromArgument(e,n[s])),a.push(n[s+1]);var u=new SortedSet(FieldPath.comparator),c=ObjectValue.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),d=this.runPreConverter(a[s],h);if(d instanceof DeleteFieldValueImpl)u=u.add(l);else{var f=this.parseData(d,h);null!=f&&(u=u.add(l),c=c.set(l,f))}}var p=FieldMask.fromSet(u);return new ParsedUpdateData(c,p,i.fieldTransforms)},e.prototype.parseQueryValue=function(e,t,r){void 0===r&&(r=!1);var n=new ParseContext(r?UserDataSource.ArrayArgument:UserDataSource.Argument,e,FieldPath.EMPTY_PATH),i=this.parseData(t,n);return assert(null!=i,"Parsed data should not be null."),assert(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),i},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(e){var r=errorMessage(e);throw t.createError(r)}},e.prototype.parseData=function(e,t){if(looksLikeJsonObject(e=this.runPreConverter(e,t)))return validatePlainObject("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof FieldValueImpl)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement&&t.dataSource!==UserDataSource.ArrayArgument)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,t){var r=this,n=new SortedMap(primitiveComparator);return isEmpty(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):forEach(e,function(e,i){var o=r.parseData(i,t.childContextForField(e));null!=o&&(n=n.insert(e,o))}),new ObjectValue(n)},e.prototype.parseArray=function(e,t){for(var r=[],n=0,i=0,o=e;i<o.length;i++){var a=o[i],s=this.parseData(a,t.childContextForArray(n));null==s&&(s=NullValue.INSTANCE),r.push(s),n++}return new ArrayValue(r)},e.prototype.parseSentinelFieldValue=function(e,t){if(!isWrite(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof DeleteFieldValueImpl){if(t.dataSource!==UserDataSource.MergeSet)throw t.dataSource===UserDataSource.Update?(assert(t.path.length>0,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof ServerTimestampFieldValueImpl)t.fieldTransforms.push(new FieldTransform(t.path,ServerTimestampTransform.instance));else if(e instanceof ArrayUnionFieldValueImpl){var r=this.parseArrayTransformElements(e._methodName,e._elements),n=new ArrayUnionTransformOperation(r);t.fieldTransforms.push(new FieldTransform(t.path,n))}else if(e instanceof ArrayRemoveFieldValueImpl){r=this.parseArrayTransformElements(e._methodName,e._elements);var i=new ArrayRemoveTransformOperation(r);t.fieldTransforms.push(new FieldTransform(t.path,i))}else if(e instanceof NumericIncrementFieldValueImpl){var o=this.parseQueryValue("FieldValue.increment",e._operand),a=new NumericIncrementTransformOperation(o);t.fieldTransforms.push(new FieldTransform(t.path,a))}else fail("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return NullValue.INSTANCE;if("number"==typeof e)return isSafeInteger(e)?new IntegerValue(e):new DoubleValue(e);if("boolean"==typeof e)return BooleanValue.of(e);if("string"==typeof e)return new StringValue(e);if(e instanceof Date)return new TimestampValue(Timestamp.fromDate(e));if(e instanceof Timestamp)return new TimestampValue(new Timestamp(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof GeoPoint)return new GeoPointValue(e);if(e instanceof Blob)return new BlobValue(e);if(e instanceof DocumentKeyReference)return new RefValue(e.databaseId,e.key);throw t.createError("Unsupported field value: "+valueDescription(e))},e.prototype.parseArrayTransformElements=function(e,t){var r=this;return t.map(function(t,n){var i=new ParseContext(UserDataSource.Argument,e,FieldPath.EMPTY_PATH);return r.parseData(t,i.childContextForArray(n))})},e}();function looksLikeJsonObject(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Timestamp||e instanceof GeoPoint||e instanceof Blob||e instanceof DocumentKeyReference||e instanceof FieldValueImpl)}function validatePlainObject(e,t,r){if(!looksLikeJsonObject(r)||!isPlainObject(r)){var n=valueDescription(r);throw"an object"===n?t.createError(e+" a custom object"):t.createError(e+" "+n)}}function fieldPathFromArgument(e,t){if(t instanceof FieldPath$1)return t._internalPath;if("string"==typeof t)return fieldPathFromDotSeparatedString(e,t);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function fieldPathFromDotSeparatedString(e,t){try{return fromDotSeparatedString(t)._internalPath}catch(t){var r=errorMessage(t);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+r)}}function errorMessage(e){return e instanceof Error?e.message:e.toString()}var DEFAULT_HOST="firestore.googleapis.com",DEFAULT_SSL=!0,DEFAULT_TIMESTAMPS_IN_SNAPSHOTS=!0,DEFAULT_FORCE_LONG_POLLING=!1,CACHE_SIZE_UNLIMITED=LruParams.COLLECTION_DISABLED,DEFAULT_SYNCHRONIZE_TABS=!1,FirestoreSettings=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new FirestoreError(Code.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=DEFAULT_HOST,this.ssl=DEFAULT_SSL}else validateNamedType("settings","non-empty string","host",e.host),this.host=e.host,validateNamedOptionalType("settings","boolean","ssl",e.ssl),this.ssl=defaulted(e.ssl,DEFAULT_SSL);if(validateOptionNames("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),validateNamedOptionalType("settings","object","credentials",e.credentials),this.credentials=e.credentials,validateNamedOptionalType("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),!0===e.timestampsInSnapshots?error("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===e.timestampsInSnapshots&&error("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=defaulted(e.timestampsInSnapshots,DEFAULT_TIMESTAMPS_IN_SNAPSHOTS),validateNamedOptionalType("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=LruParams.DEFAULT_CACHE_SIZE_BYTES;else{if(e.cacheSizeBytes!==CACHE_SIZE_UNLIMITED&&e.cacheSizeBytes<LruParams.MINIMUM_CACHE_SIZE_BYTES)throw new FirestoreError(Code.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+LruParams.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=e.cacheSizeBytes}validateNamedOptionalType("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.forceLongPolling=void 0===e.experimentalForceLongPolling?DEFAULT_FORCE_LONG_POLLING:e.experimentalForceLongPolling}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.forceLongPolling===e.forceLongPolling},e}(),Firestore=function(){function e(t,r){var n=this;if(this._firebaseApp=null,this._queue=new AsyncQueue,this.INTERNAL={delete:function(){return tslib.__awaiter(n,void 0,void 0,function(){return tslib.__generator(this,function(e){switch(e.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return e.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this._firebaseApp=i,this._databaseId=e.databaseIdFromApp(i),this._persistenceKey=i.name,this._credentials=new FirebaseCredentialsProvider(r)}else{var o=t;if(!o.projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new DatabaseId(o.projectId,o.database),this._persistenceKey="[DEFAULT]",this._credentials=new EmptyCredentialsProvider}this._settings=new FirestoreSettings({}),this._dataConverter=this.createDataConverter(this._databaseId)}return e.prototype.settings=function(e){if(validateExactNumberOfArgs("Firestore.settings",arguments,1),validateArgType("Firestore.settings","object",1,e),contains(e,"persistence"))throw new FirestoreError(Code.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new FirestoreSettings(e);if(this._firestoreClient&&!this._settings.isEqual(t))throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=t,void 0!==t.credentials&&(this._credentials=makeCredentialsProvider(t.credentials))},e.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},e.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},e.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var t=!1;return e&&(void 0!==e.experimentalTabSynchronization&&error("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),t=defaulted(void 0!==e.synchronizeTabs?e.synchronizeTabs:e.experimentalTabSynchronization,DEFAULT_SYNCHRONIZE_TABS)),this.configureClient(new IndexedDbPersistenceSettings(this._settings.cacheSizeBytes,t))},e.prototype.clearPersistence=function(){var e=this,t=IndexedDbPersistence.buildStoragePrefix(this.makeDatabaseInfo()),r=new Deferred;return this._queue.enqueueAndForgetEvenAfterShutdown(function(){return tslib.__awaiter(e,void 0,void 0,function(){var e;return tslib.__generator(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new FirestoreError(Code.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,IndexedDbPersistence.clearPersistence(t)];case 1:return n.sent(),r.resolve(),[3,3];case 2:return e=n.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(e){if(this.ensureClientConfigured(),isPartialObserver(e))return this.onSnapshotsInSyncInternal(e);validateArgType("Firestore.onSnapshotsInSync","function",1,e);var t={next:e};return this.onSnapshotsInSyncInternal(t)},e.prototype.onSnapshotsInSyncInternal=function(e){var t=this,r=new AsyncObserver({next:function(){e.next&&e.next()},error:function(e){throw fail("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(r),function(){r.mute(),t._firestoreClient.removeSnapshotsInSyncListener(r)}},e.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new MemoryPersistenceSettings),this._firestoreClient},e.prototype.makeDatabaseInfo=function(){return new DatabaseInfo(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},e.prototype.configureClient=function(e){assert(!!this._settings.host,"FirestoreSettings.host is not set"),assert(!this._firestoreClient,"configureClient() called multiple times");var t=this.makeDatabaseInfo();return this._firestoreClient=new FirestoreClient(PlatformSupport.getPlatform(),t,this._credentials,this._queue),this._firestoreClient.start(e)},e.prototype.createDataConverter=function(e){return new UserDataConverter(function(t){if(t instanceof DocumentReference){var r=e,n=t.firestore._databaseId;if(!n.isEqual(r))throw new FirestoreError(Code.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+r.projectId+"/"+r.database);return new DocumentKeyReference(e,t._key)}return t})},e.databaseIdFromApp=function(e){var t=e.options;if(!contains(t,"projectId"))throw new FirestoreError(Code.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var r=t.projectId;if(!r||"string"!=typeof r)throw new FirestoreError(Code.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new DatabaseId(r)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this._firebaseApp)throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){return validateExactNumberOfArgs("Firestore.collection",arguments,1),validateArgType("Firestore.collection","non-empty string",1,e),this.ensureClientConfigured(),new CollectionReference(ResourcePath.fromString(e),this)},e.prototype.doc=function(e){return validateExactNumberOfArgs("Firestore.doc",arguments,1),validateArgType("Firestore.doc","non-empty string",1,e),this.ensureClientConfigured(),DocumentReference.forPath(ResourcePath.fromString(e),this)},e.prototype.collectionGroup=function(e){if(validateExactNumberOfArgs("Firestore.collectionGroup",arguments,1),validateArgType("Firestore.collectionGroup","non-empty string",1,e),e.indexOf("/")>=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Query$1(new Query(ResourcePath.EMPTY_PATH,e),this)},e.prototype.runTransaction=function(e){var t=this;return validateExactNumberOfArgs("Firestore.runTransaction",arguments,1),validateArgType("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction(function(r){return e(new Transaction$1(t,r))})},e.prototype.batch=function(){return this.ensureClientConfigured(),new WriteBatch(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(getLogLevel()){case LogLevel.DEBUG:return"debug";case LogLevel.ERROR:return"error";case LogLevel.SILENT:return"silent";default:return fail("Unknown log level: "+getLogLevel())}},enumerable:!0,configurable:!0}),e.setLogLevel=function(e){switch(validateExactNumberOfArgs("Firestore.setLogLevel",arguments,1),validateArgType("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":setLogLevel(LogLevel.DEBUG);break;case"error":setLogLevel(LogLevel.ERROR);break;case"silent":setLogLevel(LogLevel.SILENT);break;default:throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid log level: "+e)}},e.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},e}(),Transaction$1=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var t=this;validateExactNumberOfArgs("Transaction.get",arguments,1);var r=validateReference("Transaction.get",e,this._firestore);return this._transaction.lookup([r._key]).then(function(e){if(!e||1!==e.length)return fail("Mismatch in docs returned from document lookup.");var n=e[0];if(n instanceof NoDocument)return new DocumentSnapshot(t._firestore,r._key,null,!1,!1,r._converter);if(n instanceof Document)return new DocumentSnapshot(t._firestore,r._key,n,!1,!1,r._converter);throw fail("BatchGetDocumentsRequest returned unexpected document type: "+n.constructor.name)})},e.prototype.set=function(e,t,r){validateBetweenNumberOfArgs("Transaction.set",arguments,2,3);var n=validateReference("Transaction.set",e,this._firestore);r=validateSetOptions("Transaction.set",r);var i=applyFirestoreDataConverter(n._converter,t,"Transaction.set"),o=i[0],a=i[1],s=r.merge||r.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,r.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._transaction.set(n._key,s),this},e.prototype.update=function(e,t,r){for(var n,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof t||t instanceof FieldPath$1?(validateAtLeastNumberOfArgs("Transaction.update",arguments,3),n=validateReference("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,r,o)):(validateExactNumberOfArgs("Transaction.update",arguments,2),n=validateReference("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(n._key,i),this},e.prototype.delete=function(e){validateExactNumberOfArgs("Transaction.delete",arguments,1);var t=validateReference("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),WriteBatch=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,r){validateBetweenNumberOfArgs("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var n=validateReference("WriteBatch.set",e,this._firestore);r=validateSetOptions("WriteBatch.set",r);var i=applyFirestoreDataConverter(n._converter,t,"WriteBatch.set"),o=i[0],a=i[1],s=r.merge||r.mergeFields?this._firestore._dataConverter.parseMergeData(a,o,r.mergeFields):this._firestore._dataConverter.parseSetData(a,o);return this._mutations=this._mutations.concat(s.toMutations(n._key,Precondition.NONE)),this},e.prototype.update=function(e,t,r){for(var n,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof t||t instanceof FieldPath$1?(validateAtLeastNumberOfArgs("WriteBatch.update",arguments,3),n=validateReference("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,r,o)):(validateExactNumberOfArgs("WriteBatch.update",arguments,2),n=validateReference("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(i.toMutations(n._key,Precondition.exists(!0))),this},e.prototype.delete=function(e){validateExactNumberOfArgs("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=validateReference("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new DeleteMutation(t._key,Precondition.NONE)),this},e.prototype.commit=function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(e){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new FirestoreError(Code.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),DocumentReference=function(){function e(e,t,r){this._key=e,this.firestore=t,this._converter=r,this._firestoreClient=this.firestore.ensureClientConfigured()}return e.forPath=function(t,r,n){if(t.length%2!=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(new DocumentKey(t),r,n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new CollectionReference(this._key.path.popLast(),this.firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(validateExactNumberOfArgs("DocumentReference.collection",arguments,1),validateArgType("DocumentReference.collection","non-empty string",1,e),!e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=ResourcePath.fromString(e);return new CollectionReference(this._key.path.child(t),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw invalidClassError("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)&&this._converter===t._converter},e.prototype.set=function(e,t){validateBetweenNumberOfArgs("DocumentReference.set",arguments,1,2),t=validateSetOptions("DocumentReference.set",t);var r=applyFirestoreDataConverter(this._converter,e,"DocumentReference.set"),n=r[0],i=r[1],o=t.merge||t.mergeFields?this.firestore._dataConverter.parseMergeData(i,n,t.mergeFields):this.firestore._dataConverter.parseSetData(i,n);return this._firestoreClient.write(o.toMutations(this._key,Precondition.NONE))},e.prototype.update=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return"string"==typeof e||e instanceof FieldPath$1?(validateAtLeastNumberOfArgs("DocumentReference.update",arguments,2),r=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,n)):(validateExactNumberOfArgs("DocumentReference.update",arguments,1),r=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(r.toMutations(this._key,Precondition.exists(!0)))},e.prototype.delete=function(){return validateExactNumberOfArgs("DocumentReference.delete",arguments,0),this._firestoreClient.write([new DeleteMutation(this._key,Precondition.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateBetweenNumberOfArgs("DocumentReference.onSnapshot",arguments,1,4);var r,n={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||isPartialObserver(e[i])||(validateOptionNames("DocumentReference.onSnapshot",n=e[i],["includeMetadataChanges"]),validateNamedOptionalType("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),i++);var o={includeMetadataChanges:n.includeMetadataChanges};return isPartialObserver(e[i])?r=e[i]:(validateArgType("DocumentReference.onSnapshot","function",i,e[i]),validateOptionalArgType("DocumentReference.onSnapshot","function",i+1,e[i+1]),validateOptionalArgType("DocumentReference.onSnapshot","function",i+2,e[i+2]),r={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,r)},e.prototype.onSnapshotInternal=function(e,t){var r=this,n=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(n=t.error.bind(t));var i=new AsyncObserver({next:function(e){if(t.next){assert(e.docs.size<=1,"Too many documents returned on a document query");var n=e.docs.get(r._key);t.next(new DocumentSnapshot(r.firestore,r._key,n,e.fromCache,e.hasPendingWrites,r._converter))}},error:n}),o=this._firestoreClient.listen(Query.atPath(this._key.path),i,e);return function(){i.mute(),r._firestoreClient.unlisten(o)}},e.prototype.get=function(e){var t=this;return validateBetweenNumberOfArgs("DocumentReference.get",arguments,0,1),validateGetOptions("DocumentReference.get",e),new Promise(function(r,n){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then(function(e){r(new DocumentSnapshot(t.firestore,t._key,e,!0,e instanceof Document&&e.hasLocalMutations,t._converter))},n):t.getViaSnapshotListener(r,n,e)})},e.prototype.getViaSnapshotListener=function(e,t,r){var n=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){n(),!i.exists&&i.metadata.fromCache?t(new FirestoreError(Code.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&r&&"server"===r.source?t(new FirestoreError(Code.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(i)},error:t})},e.prototype.withConverter=function(t){return new e(this._key,this.firestore,t)},e}(),SnapshotMetadata=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),DocumentSnapshot=function(){function e(e,t,r,n,i,o){this._firestore=e,this._key=t,this._document=r,this._fromCache=n,this._hasPendingWrites=i,this._converter=o}return e.prototype.data=function(e){if(validateBetweenNumberOfArgs("DocumentSnapshot.data",arguments,0,1),e=validateSnapshotOptions("DocumentSnapshot.data",e),this._document){if(this._converter){var t=new QueryDocumentSnapshot(this._firestore,this._key,this._document,this._fromCache,this._hasPendingWrites);return this._converter.fromFirestore(t,e)}return this.toJSObject(this._document.data(),FieldValueOptions.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},e.prototype.get=function(e,t){if(validateBetweenNumberOfArgs("DocumentSnapshot.get",arguments,1,2),t=validateSnapshotOptions("DocumentSnapshot.get",t),this._document){var r=this._document.data().field(fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==r)return this.toJSValue(r,FieldValueOptions.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new DocumentReference(this._key,this._firestore,this._converter)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new SnapshotMetadata(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw invalidClassError("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))&&this._converter===t._converter},e.prototype.toJSObject=function(e,t){var r=this,n={};return e.forEach(function(e,i){n[e]=r.toJSValue(i,t)}),n},e.prototype.toJSValue=function(e,t){if(e instanceof ObjectValue)return this.toJSObject(e,t);if(e instanceof ArrayValue)return this.toJSArray(e,t);if(e instanceof RefValue){var r=e.value(t),n=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(n)||error("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),new DocumentReference(r,this._firestore,this._converter)}return e.value(t)},e.prototype.toJSArray=function(e,t){var r=this;return e.internalValue.map(function(e){return r.toJSValue(e,t)})},e}(),QueryDocumentSnapshot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tslib.__extends(t,e),t.prototype.data=function(t){var r=e.prototype.data.call(this,t);return assert(void 0!==r,"Document in a QueryDocumentSnapshot should exist"),r},t}(DocumentSnapshot),Query$1=function(){function e(e,t,r){this._query=e,this.firestore=t,this._converter=r}return e.prototype.where=function(t,r,n){validateExactNumberOfArgs("Query.where",arguments,3),validateDefined("Query.where",3,n);var i;validateStringEnum("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,r);var o=fieldPathFromArgument("Query.where",t),a=Operator.fromString(r);if(o.isKeyField()){if(a===Operator.ARRAY_CONTAINS||a===Operator.ARRAY_CONTAINS_ANY)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a.toString()+"' queries on FieldPath.documentId().");if(a===Operator.IN){this.validateDisjunctiveFilterElements(n,a);for(var s=[],u=0,c=n;u<c.length;u++){var l=c[u];s.push(this.parseDocumentIdValue(l))}i=new ArrayValue(s)}else i=this.parseDocumentIdValue(n)}else a!==Operator.IN&&a!==Operator.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(n,a),i=this.firestore._dataConverter.parseQueryValue("Query.where",n,a===Operator.IN);var h=FieldFilter.create(o,a,i);return this.validateNewFilter(h),new e(this._query.addFilter(h),this.firestore,this._converter)},e.prototype.orderBy=function(t,r){var n;if(validateBetweenNumberOfArgs("Query.orderBy",arguments,1,2),validateOptionalArgType("Query.orderBy","non-empty string",2,r),void 0===r||"asc"===r)n=Direction.ASCENDING;else{if("desc"!==r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+r+"', expected 'asc' or 'desc'.");n=Direction.DESCENDING}if(null!==this._query.startAt)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=fieldPathFromArgument("Query.orderBy",t),o=new OrderBy(i,n);return this.validateNewOrderBy(o),new e(this._query.addOrderBy(o),this.firestore,this._converter)},e.prototype.limit=function(t){return validateExactNumberOfArgs("Query.limit",arguments,1),validateArgType("Query.limit","number",1,t),validatePositiveNumber("Query.limit",1,t),new e(this._query.withLimitToFirst(t),this.firestore,this._converter)},e.prototype.limitToLast=function(t){return validateExactNumberOfArgs("Query.limitToLast",arguments,1),validateArgType("Query.limitToLast","number",1,t),validatePositiveNumber("Query.limitToLast",1,t),new e(this._query.withLimitToLast(t),this.firestore,this._converter)},e.prototype.startAt=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",t,r,!0);return new e(this._query.withStartAt(i),this.firestore,this._converter)},e.prototype.startAfter=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",t,r,!1);return new e(this._query.withStartAt(i),this.firestore,this._converter)},e.prototype.endBefore=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",t,r,!0);return new e(this._query.withEndAt(i),this.firestore,this._converter)},e.prototype.endAt=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",t,r,!1);return new e(this._query.withEndAt(i),this.firestore,this._converter)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw invalidClassError("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},e.prototype.withConverter=function(t){return new e(this._query,this.firestore,t)},e.prototype.boundFromDocOrFields=function(e,t,r,n){if(validateDefined(e,1,t),t instanceof DocumentSnapshot){if(r.length>0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new FirestoreError(Code.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,n)}var o=[t].concat(r);return this.boundFromFields(e,o,n)},e.prototype.boundFromDocument=function(e,t,r){for(var n=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())n.push(new RefValue(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(s instanceof ServerTimestampValue)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Bound(n,r)},e.prototype.boundFromFields=function(e,t,r){var n=this._query.explicitOrderBy;if(t.length>n.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(n[o].field.isKeyField()){if("string"!=typeof a)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ResourcePath.fromString(a));if(!DocumentKey.isDocumentKey(s))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new DocumentKey(s);i.push(new RefValue(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(e,a);i.push(c)}}return new Bound(i,r)},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateBetweenNumberOfArgs("Query.onSnapshot",arguments,1,4);var r,n={},i=0;return"object"!=typeof e[i]||isPartialObserver(e[i])||(validateOptionNames("Query.onSnapshot",n=e[i],["includeMetadataChanges"]),validateNamedOptionalType("Query.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),i++),isPartialObserver(e[i])?r=e[i]:(validateArgType("Query.onSnapshot","function",i,e[i]),validateOptionalArgType("Query.onSnapshot","function",i+1,e[i+1]),validateOptionalArgType("Query.onSnapshot","function",i+2,e[i+2]),r={next:e[i],error:e[i+1],complete:e[i+2]}),this.validateHasExplicitOrderByForLimitToLast(this._query),this.onSnapshotInternal(n,r)},e.prototype.onSnapshotInternal=function(e,t){var r=this,n=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(n=t.error.bind(t));var i=new AsyncObserver({next:function(e){t.next&&t.next(new QuerySnapshot(r.firestore,r._query,e,r._converter))},error:n}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},e.prototype.validateHasExplicitOrderByForLimitToLast=function(e){if(e.hasLimitToLast()&&0===e.explicitOrderBy.length)throw new FirestoreError(Code.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},e.prototype.get=function(e){var t=this;return validateBetweenNumberOfArgs("Query.get",arguments,0,1),validateGetOptions("Query.get",e),this.validateHasExplicitOrderByForLimitToLast(this._query),new Promise(function(r,n){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then(function(e){r(new QuerySnapshot(t.firestore,t._query,e,t._converter))},n):t.getViaSnapshotListener(r,n,e)})},e.prototype.getViaSnapshotListener=function(e,t,r){var n=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){n(),i.metadata.fromCache&&r&&"server"===r.source?t(new FirestoreError(Code.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(i)},error:t})},e.prototype.parseDocumentIdValue=function(e){if("string"==typeof e){if(""===e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==e.indexOf("/"))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+e+"' contains a '/' character.");var t=this._query.path.child(ResourcePath.fromString(e));if(!DocumentKey.isDocumentKey(t))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return new RefValue(this.firestore._databaseId,new DocumentKey(t))}if(e instanceof DocumentReference){var r=e;return new RefValue(this.firestore._databaseId,r._key)}throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+valueDescription(e)+".")},e.prototype.validateDisjunctiveFilterElements=function(e,t){if(!Array.isArray(e)||0===e.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if(e.indexOf(null)>=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(e.filter(function(e){return Number.isNaN(e)}).length>0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")},e.prototype.validateNewFilter=function(e){if(e instanceof FieldFilter){var t=[Operator.ARRAY_CONTAINS,Operator.ARRAY_CONTAINS_ANY],r=[Operator.IN,Operator.ARRAY_CONTAINS_ANY],n=t.indexOf(e.op)>=0,i=r.indexOf(e.op)>=0;if(e.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(e.field))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+e.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(e.field,a)}else if(i||n){var s=null;if(i&&(s=this._query.findFilterOperator(r)),null===s&&n&&(s=this._query.findFilterOperator(t)),null!=s)throw s===e.op?new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},e.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},e.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},e}(),QuerySnapshot=function(){function e(e,t,r,n){this._firestore=e,this._originalQuery=t,this._snapshot=r,this._converter=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new SnapshotMetadata(r.hasPendingWrites,r.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var r=this;validateBetweenNumberOfArgs("QuerySnapshot.forEach",arguments,1,2),validateArgType("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach(function(n){e.call(t,r.convertToDocumentImpl(n))})},Object.defineProperty(e.prototype,"query",{get:function(){return new Query$1(this._originalQuery,this._firestore,this._converter)},enumerable:!0,configurable:!0}),e.prototype.docChanges=function(e){e&&(validateOptionNames("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),validateNamedOptionalType("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(Code.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=changesFromSnapshot(this._firestore,t,this._snapshot,this._converter),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e.prototype.isEqual=function(t){if(!(t instanceof e))throw invalidClassError("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)&&this._converter===t._converter},e.prototype.convertToDocumentImpl=function(e){return new QueryDocumentSnapshot(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key),this._converter)},e}();function throwDocChangesMethodError(){throw new FirestoreError(Code.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}var docChangesPropertiesToOverride=tslib.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]);docChangesPropertiesToOverride.forEach(function(e){try{Object.defineProperty(QuerySnapshot.prototype.docChanges,e,{get:function(){return throwDocChangesMethodError()}})}catch(e){}});var CollectionReference=function(e){function t(t,r,n){var i=e.call(this,Query.atPath(t),r,n)||this;if(i._path=t,t.length%2!=1)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return i}return tslib.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new DocumentReference(new DocumentKey(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if(validateBetweenNumberOfArgs("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=AutoId.newId()),validateArgType("CollectionReference.doc","non-empty string",1,e),""===e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=ResourcePath.fromString(e);return DocumentReference.forPath(this._query.path.child(t),this.firestore,this._converter)},t.prototype.add=function(e){validateExactNumberOfArgs("CollectionReference.add",arguments,1),validateArgType("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then(function(){return t})},t.prototype.withConverter=function(e){return new t(this._path,this.firestore,e)},t}(Query$1);function validateSetOptions(e,t){if(void 0===t)return{merge:!1};if(validateOptionNames(e,t,["merge","mergeFields"]),validateNamedOptionalType(e,"boolean","merge",t.merge),validateOptionalArrayElements(e,"mergeFields","a string or a FieldPath",t.mergeFields,function(e){return"string"==typeof e||e instanceof FieldPath$1}),void 0!==t.mergeFields&&void 0!==t.merge)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function validateSnapshotOptions(e,t){return void 0===t?{}:(validateOptionNames(e,t,["serverTimestamps"]),validateNamedOptionalPropertyEquals(e,"options","serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function validateGetOptions(e,t){validateOptionalArgType(e,"object",1,t),t&&(validateOptionNames(e,t,["source"]),validateNamedOptionalPropertyEquals(e,"options","source",t.source,["default","server","cache"]))}function validateReference(e,t,r){if(t instanceof DocumentReference){if(t.firestore!==r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw invalidClassError(e,"DocumentReference",1,t)}function changesFromSnapshot(e,t,r,n){if(r.oldDocs.isEmpty()){var i,o=0;return r.docChanges.map(function(t){var a=new QueryDocumentSnapshot(e,t.doc.key,t.doc,r.fromCache,r.mutatedKeys.has(t.doc.key),n);return assert(t.type===ChangeType.Added,"Invalid event type for first snapshot"),assert(!i||r.query.docComparator(i,t.doc)<0,"Got added events in wrong order"),i=t.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}var a=r.oldDocs;return r.docChanges.filter(function(e){return t||e.type!==ChangeType.Metadata}).map(function(t){var i=new QueryDocumentSnapshot(e,t.doc.key,t.doc,r.fromCache,r.mutatedKeys.has(t.doc.key),n),o=-1,s=-1;return t.type!==ChangeType.Added&&(assert((o=a.indexOf(t.doc.key))>=0,"Index for document not found"),a=a.delete(t.doc.key)),t.type!==ChangeType.Removed&&(s=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:resultChangeType(t.type),doc:i,oldIndex:o,newIndex:s}})}function resultChangeType(e){switch(e){case ChangeType.Added:return"added";case ChangeType.Modified:case ChangeType.Metadata:return"modified";case ChangeType.Removed:return"removed";default:return fail("Unknown change type: "+e)}}function applyFirestoreDataConverter(e,t,r){var n;return e?(n=e.toFirestore(t),r="toFirestore() in "+r):n=t,[n,r]}var PublicFirestore=makeConstructorPrivate(Firestore,"Use firebase.firestore() instead."),PublicTransaction=makeConstructorPrivate(Transaction$1,"Use firebase.firestore().runTransaction() instead."),PublicWriteBatch=makeConstructorPrivate(WriteBatch,"Use firebase.firestore().batch() instead."),PublicDocumentReference=makeConstructorPrivate(DocumentReference,"Use firebase.firestore().doc() instead."),PublicDocumentSnapshot=makeConstructorPrivate(DocumentSnapshot),PublicQueryDocumentSnapshot=makeConstructorPrivate(QueryDocumentSnapshot),PublicQuery=makeConstructorPrivate(Query$1),PublicQuerySnapshot=makeConstructorPrivate(QuerySnapshot),PublicCollectionReference=makeConstructorPrivate(CollectionReference,"Use firebase.firestore().collection() instead."),firestoreNamespace={Firestore:PublicFirestore,GeoPoint:GeoPoint,Timestamp:Timestamp,Blob:PublicBlob,Transaction:PublicTransaction,WriteBatch:PublicWriteBatch,DocumentReference:PublicDocumentReference,DocumentSnapshot:PublicDocumentSnapshot,Query:PublicQuery,QueryDocumentSnapshot:PublicQueryDocumentSnapshot,QuerySnapshot:PublicQuerySnapshot,CollectionReference:PublicCollectionReference,FieldPath:FieldPath$1,FieldValue:PublicFieldValue,setLogLevel:Firestore.setLogLevel,CACHE_SIZE_UNLIMITED:CACHE_SIZE_UNLIMITED};function configureForFirebase(e){e.INTERNAL.registerComponent(new component.Component("firestore",function(e){var t=e.getProvider("app").getImmediate();return new Firestore(t,e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(shallowCopy(firestoreNamespace)))}var NoopConnectivityMonitor=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.shutdown=function(){},e}(),LOG_TAG$c="ConnectivityMonitor",BrowserConnectivityMonitor=function(){function e(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return e.prototype.addCallback=function(e){this.callbacks.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},e.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},e.prototype.onNetworkAvailable=function(){debug(LOG_TAG$c,"Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++){(0,t[e])(0)}},e.prototype.onNetworkUnavailable=function(){debug(LOG_TAG$c,"Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++){(0,t[e])(1)}},e.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),StreamBridge=function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){assert(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){assert(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){assert(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){assert(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){assert(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){assert(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}(),LOG_TAG$d="Connection",RPC_STREAM_SERVICE="google.firestore.v1.Firestore",RPC_URL_VERSION="v1",RPC_NAME_REST_MAPPING={BatchGetDocuments:"batchGet",Commit:"commit"},X_GOOG_API_CLIENT_VALUE="gl-js/ fire/"+SDK_VERSION,XHR_TIMEOUT_SECS=15,WebChannelConnection=function(){function e(e){this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host,this.forceLongPolling=e.forceLongPolling}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var r in t.authHeaders)t.authHeaders.hasOwnProperty(r)&&(e[r]=t.authHeaders[r]);e["X-Goog-Api-Client"]=X_GOOG_API_CLIENT_VALUE},e.prototype.invokeRPC=function(e,t,r){var n=this,i=this.makeUrl(e);return new Promise(function(o,a){var s=new webchannelWrapper.XhrIo;s.listenOnce(webchannelWrapper.EventType.COMPLETE,function(){try{switch(s.getLastErrorCode()){case webchannelWrapper.ErrorCode.NO_ERROR:var t=s.getResponseJson();debug(LOG_TAG$d,"XHR received:",JSON.stringify(t)),o(t);break;case webchannelWrapper.ErrorCode.TIMEOUT:debug(LOG_TAG$d,'RPC "'+e+'" timed out'),a(new FirestoreError(Code.DEADLINE_EXCEEDED,"Request time out"));break;case webchannelWrapper.ErrorCode.HTTP_ERROR:var r=s.getStatus();if(debug(LOG_TAG$d,'RPC "'+e+'" failed with status:',r,"response text:",s.getResponseText()),r>0){var n=s.getResponseJson().error;if(n&&n.status&&n.message){var i=mapCodeFromHttpResponseErrorStatus(n.status);a(new FirestoreError(i,n.message))}else a(new FirestoreError(Code.UNKNOWN,"Server responded with status "+s.getStatus()))}else debug(LOG_TAG$d,'RPC "'+e+'" failed'),a(new FirestoreError(Code.UNAVAILABLE,"Connection failed."));break;default:fail('RPC "'+e+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{debug(LOG_TAG$d,'RPC "'+e+'" completed.')}});var u=tslib.__assign({},t);delete u.database;var c=JSON.stringify(u);debug(LOG_TAG$d,"XHR sending: ",i+" "+c);var l={"Content-Type":"text/plain"};n.modifyHeadersForRequest(l,r),s.send(i,"POST",c,l,XHR_TIMEOUT_SECS)})},e.prototype.invokeStreamingRPC=function(e,t,r){return this.invokeRPC(e,t,r)},e.prototype.openStream=function(e,t){var r=[this.baseUrl,"/",RPC_STREAM_SERVICE,"/",e,"/channel"],n=webchannelWrapper.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,t),util.isReactNative()||util.isElectron()||util.isIE()||util.isUWP()||util.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=r.join("");debug(LOG_TAG$d,"Creating WebChannel: "+o+" "+i);var a=n.createWebChannel(o,i),s=!1,u=!1,c=new StreamBridge({sendFn:function(e){u?debug(LOG_TAG$d,"Not sending because WebChannel is closed:",e):(s||(debug(LOG_TAG$d,"Opening WebChannel transport."),a.open(),s=!0),debug(LOG_TAG$d,"WebChannel sending:",e),a.send(e))},closeFn:function(){return a.close()}}),l=function(e,t){a.listen(e,function(e){try{t(e)}catch(e){setTimeout(function(){throw e},0)}})};return l(webchannelWrapper.WebChannel.EventType.OPEN,function(){u||debug(LOG_TAG$d,"WebChannel transport opened.")}),l(webchannelWrapper.WebChannel.EventType.CLOSE,function(){u||(u=!0,debug(LOG_TAG$d,"WebChannel transport closed"),c.callOnClose())}),l(webchannelWrapper.WebChannel.EventType.ERROR,function(e){u||(u=!0,debug(LOG_TAG$d,"WebChannel transport errored:",e),c.callOnClose(new FirestoreError(Code.UNAVAILABLE,"The operation could not be completed")))}),l(webchannelWrapper.WebChannel.EventType.MESSAGE,function(e){var t;if(!u){var r=e.data[0];assert(!!r,"Got a webchannel message without data.");var n=r,i=n.error||(null===(t=n[0])||void 0===t?void 0:t.error);if(i){debug(LOG_TAG$d,"WebChannel received error:",i);var o=i.status,s=mapCodeFromRpcStatus(o),l=i.message;void 0===s&&(s=Code.INTERNAL,l="Unknown error status: "+o+" with message "+i.message),u=!0,c.callOnClose(new FirestoreError(s,l)),a.close()}else debug(LOG_TAG$d,"WebChannel received:",r),c.callOnMessage(r)}}),setTimeout(function(){c.callOnOpen()},0),c},e.prototype.makeUrl=function(e){var t=RPC_NAME_REST_MAPPING[e];return assert(void 0!==t,"Unknown REST mapping for: "+e),this.baseUrl+"/"+RPC_URL_VERSION+"/projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents:"+t},e}(),BrowserPlatform=function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(e.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),e.prototype.loadConnection=function(e){return Promise.resolve(new WebChannelConnection(e))},e.prototype.newConnectivityMonitor=function(){return BrowserConnectivityMonitor.isAvailable()?new BrowserConnectivityMonitor:new NoopConnectivityMonitor},e.prototype.newSerializer=function(e){return new JsonProtoSerializer(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}();PlatformSupport.setPlatform(new BrowserPlatform);var name="@firebase/firestore",version="1.9.3";function registerFirestore(e){configureForFirebase(e),e.registerVersion(name,version)}registerFirestore(firebase),exports.registerFirestore=registerFirestore;

}).call(this,require('_process'))
},{"@firebase/app":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/app/dist/index.cjs.js","@firebase/component":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/component/dist/index.cjs.js","@firebase/logger":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/logger/dist/index.cjs.js","@firebase/util":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/util/dist/index.cjs.js","@firebase/webchannel-wrapper":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/webchannel-wrapper/dist/index.js","_process":"/Users/rabbit/projects/buntimer2020-github/node_modules/process/browser.js","tslib":"/Users/rabbit/projects/buntimer2020-github/node_modules/tslib/tslib.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/logger/dist/index.cjs.js":[function(require,module,exports){
"use strict";function __spreadArrays(){for(var e=0,o=0,r=arguments.length;o<r;o++)e+=arguments[o].length;var t=Array(e),n=0;for(o=0;o<r;o++)for(var l=arguments[o],a=0,s=l.length;a<s;a++,n++)t[n]=l[a];return t}Object.defineProperty(exports,"__esModule",{value:!0});var instances=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(exports.LogLevel||(exports.LogLevel={}));var defaultLogLevel=exports.LogLevel.INFO,defaultLogHandler=function(e,o){for(var r=[],t=2;t<arguments.length;t++)r[t-2]=arguments[t];if(!(o<e.logLevel)){var n=(new Date).toISOString();switch(o){case exports.LogLevel.DEBUG:case exports.LogLevel.VERBOSE:console.log.apply(console,__spreadArrays(["["+n+"]  "+e.name+":"],r));break;case exports.LogLevel.INFO:console.info.apply(console,__spreadArrays(["["+n+"]  "+e.name+":"],r));break;case exports.LogLevel.WARN:console.warn.apply(console,__spreadArrays(["["+n+"]  "+e.name+":"],r));break;case exports.LogLevel.ERROR:console.error.apply(console,__spreadArrays(["["+n+"]  "+e.name+":"],r));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+o+")")}}},Logger=function(){function e(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,instances.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in exports.LogLevel))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,__spreadArrays([this,exports.LogLevel.DEBUG],e))},e.prototype.log=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,__spreadArrays([this,exports.LogLevel.VERBOSE],e))},e.prototype.info=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,__spreadArrays([this,exports.LogLevel.INFO],e))},e.prototype.warn=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,__spreadArrays([this,exports.LogLevel.WARN],e))},e.prototype.error=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,__spreadArrays([this,exports.LogLevel.ERROR],e))},e}();function setLogLevel(e){instances.forEach(function(o){o.logLevel=e})}exports.Logger=Logger,exports.setLogLevel=setLogLevel;

},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/util/dist/index.cjs.js":[function(require,module,exports){
(function (global){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib=require("tslib"),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},assert=function(e,r){if(!e)throw assertionError(r)},assertionError=function(e){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},stringToByteArray=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):55296==(64512&i)&&o+1<e.length&&56320==(64512&e.charCodeAt(o+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++o)),r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},byteArrayToString=function(e){for(var r=[],t=0,o=0;t<e.length;){var i=e[t++];if(i<128)r[o++]=String.fromCharCode(i);else if(i>191&&i<224){var n=e[t++];r[o++]=String.fromCharCode((31&i)<<6|63&n)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(n=e[t++]))<<12|(63&(a=e[t++]))<<6|63&e[t++])-65536;r[o++]=String.fromCharCode(55296+(s>>10)),r[o++]=String.fromCharCode(56320+(1023&s))}else{n=e[t++];var a=e[t++];r[o++]=String.fromCharCode((15&i)<<12|(63&n)<<6|63&a)}}return r.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],i=0;i<e.length;i+=3){var n=e[i],s=i+1<e.length,a=s?e[i+1]:0,c=i+2<e.length,h=c?e[i+2]:0,f=n>>2,u=(3&n)<<4|a>>4,p=(15&a)<<2|h>>6,d=63&h;c||(d=64,s||(p=64)),o.push(t[f],t[u],t[p],t[d])}return o.join("")},encodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(stringToByteArray(e),r)},decodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):byteArrayToString(this.decodeStringToByteArray(e,r))},decodeStringToByteArray:function(e,r){this.init_();for(var t=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],i=0;i<e.length;){var n=t[e.charAt(i++)],s=i<e.length?t[e.charAt(i)]:0,a=++i<e.length?t[e.charAt(i)]:64,c=++i<e.length?t[e.charAt(i)]:64;if(++i,null==n||null==s||null==a||null==c)throw Error();var h=n<<2|s>>4;if(o.push(h),64!==a){var f=s<<4&240|a>>2;if(o.push(f),64!==c){var u=a<<6&192|c;o.push(u)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},base64Encode=function(e){var r=stringToByteArray(e);return base64.encodeByteArray(r,!0)},base64Decode=function(e){try{return base64.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function deepCopy(e){return deepExtend(void 0,e)}function deepExtend(e,r){if(!(r instanceof Object))return r;switch(r.constructor){case Date:return new Date(r.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return r}for(var t in r)r.hasOwnProperty(t)&&(e[t]=deepExtend(e[t],r[t]));return e}var Deferred=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(r,t){e.resolve=r,e.reject=t})}return e.prototype.wrapCallback=function(e){var r=this;return function(t,o){t?r.reject(t):r.resolve(o),"function"==typeof e&&(r.promise.catch(function(){}),1===e.length?e(t):e(t,o))}},e}();function getUA(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function isMobileCordova(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function isBrowser(){return"object"==typeof self&&self.self===self}function isBrowserExtension(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function isReactNative(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function isElectron(){return getUA().indexOf("Electron/")>=0}function isIE(){var e=getUA();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function isUWP(){return getUA().indexOf("MSAppHost/")>=0}function isNodeSdk(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN}var ERROR_NAME="FirebaseError",FirebaseError=function(e){function r(t,o){var i=e.call(this,o)||this;return i.code=t,i.name=ERROR_NAME,Object.setPrototypeOf(i,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,ErrorFactory.prototype.create),i}return tslib.__extends(r,e),r}(Error),ErrorFactory=function(){function e(e,r,t){this.service=e,this.serviceName=r,this.errors=t}return e.prototype.create=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o=r[0]||{},i=this.service+"/"+e,n=this.errors[e],s=n?replaceTemplate(n,o):"Error",a=this.serviceName+": "+s+" ("+i+").",c=new FirebaseError(i,a),h=0,f=Object.keys(o);h<f.length;h++){var u=f[h];"_"!==u.slice(-1)&&(u in c&&console.warn('Overwriting FirebaseError base field "'+u+'" can cause unexpected behavior.'),c[u]=o[u])}return c},e}();function replaceTemplate(e,r){return e.replace(PATTERN,function(e,t){var o=r[t];return null!=o?o.toString():"<"+t+"?>"})}var PATTERN=/\{\$([^}]+)}/g;function jsonEval(e){return JSON.parse(e)}function stringify(e){return JSON.stringify(e)}var decode=function(e){var r={},t={},o={},i="";try{var n=e.split(".");r=jsonEval(base64Decode(n[0])||""),t=jsonEval(base64Decode(n[1])||""),i=n[2],o=t.d||{},delete t.d}catch(e){}return{header:r,claims:t,data:o,signature:i}},isValidTimestamp=function(e){var r=decode(e).claims,t=Math.floor((new Date).getTime()/1e3),o=0,i=0;return"object"==typeof r&&(r.hasOwnProperty("nbf")?o=r.nbf:r.hasOwnProperty("iat")&&(o=r.iat),i=r.hasOwnProperty("exp")?r.exp:o+86400),!!t&&!!o&&!!i&&t>=o&&t<=i},issuedAtTime=function(e){var r=decode(e).claims;return"object"==typeof r&&r.hasOwnProperty("iat")?r.iat:null},isValidFormat=function(e){var r=decode(e).claims;return!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},isAdmin=function(e){var r=decode(e).claims;return"object"==typeof r&&!0===r.admin};function contains(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function safeGet(e,r){return Object.prototype.hasOwnProperty.call(e,r)?e[r]:void 0}function isEmpty(e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function map(e,r,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=r.call(t,e[i],i,e));return o}function querystring(e){for(var r=[],t=function(e,t){Array.isArray(t)?t.forEach(function(t){r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},o=0,i=Object.entries(e);o<i.length;o++){var n=i[o];t(n[0],n[1])}return r.length?"&"+r.join("&"):""}function querystringDecode(e){var r={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var t=e.split("=");r[t[0]]=t[1]}}),r}var Sha1=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,r){r||(r=0);var t=this.W_;if("string"==typeof e)for(var o=0;o<16;o++)t[o]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(o=0;o<16;o++)t[o]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(o=16;o<80;o++){var i=t[o-3]^t[o-8]^t[o-14]^t[o-16];t[o]=4294967295&(i<<1|i>>>31)}var n,s,a=this.chain_[0],c=this.chain_[1],h=this.chain_[2],f=this.chain_[3],u=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(n=f^c&(h^f),s=1518500249):(n=c^h^f,s=1859775393):o<60?(n=c&h|f&(c|h),s=2400959708):(n=c^h^f,s=3395469782);i=(a<<5|a>>>27)+n+u+s+t[o]&4294967295;u=f,f=h,h=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295},e.prototype.update=function(e,r){if(null!=e){void 0===r&&(r=e.length);for(var t=r-this.blockSize,o=0,i=this.buf_,n=this.inbuf_;o<r;){if(0===n)for(;o<=t;)this.compress_(e,o),o+=this.blockSize;if("string"==typeof e){for(;o<r;)if(i[n]=e.charCodeAt(o),++o,++n===this.blockSize){this.compress_(i),n=0;break}}else for(;o<r;)if(i[n]=e[o],++o,++n===this.blockSize){this.compress_(i),n=0;break}}this.inbuf_=n,this.total_+=r}},e.prototype.digest=function(){var e=[],r=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&r,r/=256;this.compress_(this.buf_);var o=0;for(t=0;t<5;t++)for(var i=24;i>=0;i-=8)e[o]=this.chain_[t]>>i&255,++o;return e},e}();function createSubscribe(e,r){var t=new ObserverProxy(e,r);return t.subscribe.bind(t)}var ObserverProxy=function(){function e(e,r){var t=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){e(t)}).catch(function(e){t.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(r){r.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(r){r.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,r,t){var o,i=this;if(void 0===e&&void 0===r&&void 0===t)throw new Error("Missing Observer.");void 0===(o=implementsAnyMethods(e,["next","error","complete"])?e:{next:e,error:r,complete:t}).next&&(o.next=noop),void 0===o.error&&(o.error=noop),void 0===o.complete&&(o.complete=noop);var n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?o.error(i.finalError):o.complete()}catch(e){}}),this.observers.push(o),n},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,e)},e.prototype.sendOne=function(e,r){var t=this;this.task.then(function(){if(void 0!==t.observers&&void 0!==t.observers[e])try{r(t.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var r=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},e}();function async(e,r){return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];Promise.resolve(!0).then(function(){e.apply(void 0,t)}).catch(function(e){r&&r(e)})}}function implementsAnyMethods(e,r){if("object"!=typeof e||null===e)return!1;for(var t=0,o=r;t<o.length;t++){var i=o[t];if(i in e&&"function"==typeof e[i])return!0}return!1}function noop(){}var validateArgCount=function(e,r,t,o){var i;if(o<r?i="at least "+r:o>t&&(i=0===t?"none":"no more than "+t),i)throw new Error(e+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+i+".")};function errorPrefix(e,r,t){var o="";switch(r){case 1:o=t?"first":"First";break;case 2:o=t?"second":"Second";break;case 3:o=t?"third":"Third";break;case 4:o=t?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=o+" argument "}function validateNamespace(e,r,t,o){if((!o||t)&&"string"!=typeof t)throw new Error(errorPrefix(e,r,o)+"must be a valid firebase namespace.")}function validateCallback(e,r,t,o){if((!o||t)&&"function"!=typeof t)throw new Error(errorPrefix(e,r,o)+"must be a valid function.")}function validateContextObject(e,r,t,o){if((!o||t)&&("object"!=typeof t||null===t))throw new Error(errorPrefix(e,r,o)+"must be a valid context object.")}var stringToByteArray$1=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(i>=55296&&i<=56319){var n=i-55296;assert(++o<e.length,"Surrogate pair missing trail surrogate."),i=65536+(n<<10)+(e.charCodeAt(o)-56320)}i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):i<65536?(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},stringLength=function(e){for(var r=0,t=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r++:o<2048?r+=2:o>=55296&&o<=56319?(r+=4,t++):r+=3}return r};exports.CONSTANTS=CONSTANTS,exports.Deferred=Deferred,exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.Sha1=Sha1,exports.assert=assert,exports.assertionError=assertionError,exports.async=async,exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=base64Encode,exports.contains=contains,exports.createSubscribe=createSubscribe,exports.decode=decode,exports.deepCopy=deepCopy,exports.deepExtend=deepExtend,exports.errorPrefix=errorPrefix,exports.getUA=getUA,exports.isAdmin=isAdmin,exports.isBrowser=isBrowser,exports.isBrowserExtension=isBrowserExtension,exports.isElectron=isElectron,exports.isEmpty=isEmpty,exports.isIE=isIE,exports.isMobileCordova=isMobileCordova,exports.isNode=isNode,exports.isNodeSdk=isNodeSdk,exports.isReactNative=isReactNative,exports.isUWP=isUWP,exports.isValidFormat=isValidFormat,exports.isValidTimestamp=isValidTimestamp,exports.issuedAtTime=issuedAtTime,exports.jsonEval=jsonEval,exports.map=map,exports.querystring=querystring,exports.querystringDecode=querystringDecode,exports.safeGet=safeGet,exports.stringLength=stringLength,exports.stringToByteArray=stringToByteArray$1,exports.stringify=stringify,exports.validateArgCount=validateArgCount,exports.validateCallback=validateCallback,exports.validateContextObject=validateContextObject,exports.validateNamespace=validateNamespace;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"tslib":"/Users/rabbit/projects/buntimer2020-github/node_modules/tslib/tslib.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/webchannel-wrapper/dist/index.js":[function(require,module,exports){
(function (global){
(function(){"use strict";var t,i=i||{},n=this||self;function e(t){return"string"==typeof t}function s(t){return"number"==typeof t}function a(t,i){t=t.split("."),i=i||n;for(var e=0;e<t.length;e++)if(null==(i=i[t[e]]))return null;return i}function r(){}function h(t){var i=typeof t;if("object"==i){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return i;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==i&&void 0===t.call)return"object";return i}function o(t){return"array"==h(t)}function c(t){var i=h(t);return"array"==i||"object"==i&&"number"==typeof t.length}function l(t){var i=typeof t;return"object"==i&&null!=t||"function"==i}var u="closure_uid_"+(1e9*Math.random()>>>0),f=0;function p(t,i,n){return t.call.apply(t.bind,arguments)}function v(t,i,n){if(!t)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,e),t.apply(i,n)}}return function(){return t.apply(i,arguments)}}function d(t,i,n){return(d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:v).apply(null,arguments)}function b(t,i){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),t.apply(this,i)}}var g=Date.now||function(){return+new Date};function y(t,i){function n(){}n.prototype=i.prototype,t.N=i.prototype,t.prototype=new n,t.prototype.constructor=t,t.wb=function(t,n,e){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return i.prototype[n].apply(t,s)}}function m(){0!=w&&(E[this[u]||(this[u]=++f)]=this),this.j=this.j,this.i=this.i}var w=0,E={};m.prototype.j=!1,m.prototype.ka=function(){if(!this.j&&(this.j=!0,this.G(),0!=w)){var t=this[u]||(this[u]=++f);if(0!=w&&this.i&&0<this.i.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete E[t]}},m.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var T=Array.prototype.indexOf?function(t,i){return Array.prototype.indexOf.call(t,i,void 0)}:function(t,i){if(e(t))return e(i)&&1==i.length?t.indexOf(i,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===i)return n;return-1},C=Array.prototype.forEach?function(t,i,n){Array.prototype.forEach.call(t,i,n)}:function(t,i,n){for(var s=t.length,a=e(t)?t.split(""):t,r=0;r<s;r++)r in a&&i.call(n,a[r],r,t)};function S(t){return Array.prototype.concat.apply([],arguments)}function I(t){var i=t.length;if(0<i){for(var n=Array(i),e=0;e<i;e++)n[e]=t[e];return n}return[]}function O(t){return/^[\s\xa0]*$/.test(t)}var x,j=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function P(t,i){return-1!=t.indexOf(i)}function R(t,i){return t<i?-1:t>i?1:0}t:{var L=n.navigator;if(L){var A=L.userAgent;if(A){x=A;break t}}x=""}function M(t,i,n){for(var e in t)i.call(n,t[e],e,t)}function k(t){var i,n={};for(i in t)n[i]=t[i];return n}var D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,i){for(var n,e,s=1;s<arguments.length;s++){for(n in e=arguments[s])t[n]=e[n];for(var a=0;a<D.length;a++)n=D[a],Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}}function _(t){return _[" "](t),t}_[" "]=r;var H,N,U=P(x,"Opera"),F=P(x,"Trident")||P(x,"MSIE"),K=P(x,"Edge"),Y=K||F,B=P(x,"Gecko")&&!(P(x.toLowerCase(),"webkit")&&!P(x,"Edge"))&&!(P(x,"Trident")||P(x,"MSIE"))&&!P(x,"Edge"),G=P(x.toLowerCase(),"webkit")&&!P(x,"Edge");function J(){var t=n.document;return t?t.documentMode:void 0}t:{var W="",$=(N=x,B?/rv:([^\);]+)(\)|;)/.exec(N):K?/Edge\/([\d\.]+)/.exec(N):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(N):G?/WebKit\/(\S+)/.exec(N):U?/(?:Version)[ \/]?(\S+)/.exec(N):void 0);if($&&(W=$?$[1]:""),F){var q=J();if(null!=q&&q>parseFloat(W)){H=String(q);break t}}H=W}var V,Z={};function z(t){return function(t,i){var n=Z;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=i(t)}(t,function(){for(var i=0,n=j(String(H)).split("."),e=j(String(t)).split("."),s=Math.max(n.length,e.length),a=0;0==i&&a<s;a++){var r=n[a]||"",h=e[a]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],h=/(\d*)(\D*)(.*)/.exec(h)||["","","",""],0==r[0].length&&0==h[0].length)break;i=R(0==r[1].length?0:parseInt(r[1],10),0==h[1].length?0:parseInt(h[1],10))||R(0==r[2].length,0==h[2].length)||R(r[2],h[2]),r=r[3],h=h[3]}while(0==i)}return 0<=i})}V=n.document&&F?J():void 0;var Q=!F||9<=Number(V),tt=F&&!z("9"),it=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var t=!1,i=Object.defineProperty({},"passive",{get:function(){t=!0}});try{n.addEventListener("test",r,i),n.removeEventListener("test",r,i)}catch(t){}return t}();function nt(t,i){this.type=t,this.a=this.target=i,this.Ha=!0}function et(t,i){if(nt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=i,i=t.relatedTarget){if(B){t:{try{_(i.nodeName);var a=!0;break t}catch(t){}a=!1}a||(i=null)}}else"mouseover"==n?i=t.fromElement:"mouseout"==n&&(i=t.toElement);this.relatedTarget=i,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=e(t.pointerType)?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}nt.prototype.b=function(){this.Ha=!1},y(et,nt);var st={2:"touch",3:"pen",4:"mouse"};et.prototype.b=function(){et.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,tt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var at="closure_listenable_"+(1e6*Math.random()|0),rt=0;function ht(t,i,n,e,s){this.listener=t,this.proxy=null,this.src=i,this.type=n,this.capture=!!e,this.da=s,this.key=++rt,this.X=this.Z=!1}function ot(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ct(t){this.src=t,this.a={},this.b=0}function lt(t,i){var n=i.type;if(n in t.a){var e,s=t.a[n],a=T(s,i);(e=0<=a)&&Array.prototype.splice.call(s,a,1),e&&(ot(i),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ut(t,i,n,e){for(var s=0;s<t.length;++s){var a=t[s];if(!a.X&&a.listener==i&&a.capture==!!n&&a.da==e)return s}return-1}ct.prototype.add=function(t,i,n,e,s){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var r=ut(t,i,e,s);return-1<r?(i=t[r],n||(i.Z=!1)):((i=new ht(i,this.src,a,!!e,s)).Z=n,t.push(i)),i};var ft="closure_lm_"+(1e6*Math.random()|0),pt={};function vt(t,i,n,e,s){if(e&&e.once)return function t(i,n,e,s,a){if(o(n)){for(var r=0;r<n.length;r++)t(i,n[r],e,s,a);return null}e=Tt(e);return i&&i[at]?i.za(n,e,l(s)?!!s.capture:!!s,a):dt(i,n,e,!0,s,a)}(t,i,n,e,s);if(o(i)){for(var a=0;a<i.length;a++)vt(t,i[a],n,e,s);return null}return n=Tt(n),t&&t[at]?t.ya(i,n,l(e)?!!e.capture:!!e,s):dt(t,i,n,!1,e,s)}function dt(t,i,n,e,s,a){if(!i)throw Error("Invalid event type");var r=l(s)?!!s.capture:!!s;if(r&&!Q)return null;var h=wt(t);if(h||(t[ft]=h=new ct(t)),(n=h.add(i,n,e,r,a)).proxy)return n;if(e=function(){var t=mt,i=Q?function(n){return t.call(i.src,i.listener,n)}:function(n){if(!(n=t.call(i.src,i.listener,n)))return n};return i}(),n.proxy=e,e.src=t,e.listener=n,t.addEventListener)it||(s=r),void 0===s&&(s=!1),t.addEventListener(i.toString(),e,s);else if(t.attachEvent)t.attachEvent(gt(i.toString()),e);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(e)}return 0,n}function bt(t){if(!s(t)&&t&&!t.X){var i=t.src;if(i&&i[at])lt(i.c,t);else{var n=t.type,e=t.proxy;i.removeEventListener?i.removeEventListener(n,e,t.capture):i.detachEvent?i.detachEvent(gt(n),e):i.addListener&&i.removeListener&&i.removeListener(e),0,(n=wt(i))?(lt(n,t),0==n.b&&(n.src=null,i[ft]=null)):ot(t)}}}function gt(t){return t in pt?pt[t]:pt[t]="on"+t}function yt(t,i){var n=t.listener,e=t.da||t.src;return t.Z&&bt(t),n.call(e,i)}function mt(t,i){return!!t.X||(Q?yt(t,new et(i,this)):yt(t,i=new et(i||a("window.event"),this)))}function wt(t){return(t=t[ft])instanceof ct?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tt(t){return"function"==h(t)?t:(t[Et]||(t[Et]=function(i){return t.handleEvent(i)}),t[Et])}function Ct(){m.call(this),this.c=new ct(this),this.J=this,this.B=null}function St(t,i,n,e){if(!(i=t.c.a[String(i)]))return!0;i=i.concat();for(var s=!0,a=0;a<i.length;++a){var r=i[a];if(r&&!r.X&&r.capture==n){var h=r.listener,o=r.da||r.src;r.Z&&lt(t.c,r),s=!1!==h.call(o,e)&&s}}return s&&0!=e.Ha}y(Ct,m),Ct.prototype[at]=!0,(t=Ct.prototype).addEventListener=function(t,i,n,e){vt(this,t,i,n,e)},t.removeEventListener=function(t,i,n,e){!function t(i,n,e,s,a){if(o(n))for(var r=0;r<n.length;r++)t(i,n[r],e,s,a);else s=l(s)?!!s.capture:!!s,e=Tt(e),i&&i[at]?(i=i.c,(n=String(n).toString())in i.a&&-1<(e=ut(r=i.a[n],e,s,a))&&(ot(r[e]),Array.prototype.splice.call(r,e,1),0==r.length&&(delete i.a[n],i.b--))):i&&(i=wt(i))&&(n=i.a[n.toString()],i=-1,n&&(i=ut(n,e,s,a)),(e=-1<i?n[i]:null)&&bt(e))}(this,t,i,n,e)},t.dispatchEvent=function(t){var i,n=this.B;if(n)for(i=[];n;n=n.B)i.push(n);n=this.J;var s=t.type||t;if(e(t))t=new nt(t,n);else if(t instanceof nt)t.target=t.target||n;else{var a=t;X(t=new nt(s,n),a)}if(a=!0,i)for(var r=i.length-1;0<=r;r--){var h=t.a=i[r];a=St(h,s,!0,t)&&a}if(a=St(h=t.a=n,s,!0,t)&&a,a=St(h,s,!1,t)&&a,i)for(r=0;r<i.length;r++)a=St(h=t.a=i[r],s,!1,t)&&a;return a},t.G=function(){if(Ct.N.G.call(this),this.c){var t,i=this.c;for(t in i.a){for(var n=i.a[t],e=0;e<n.length;e++)0,ot(n[e]);delete i.a[t],i.b--}}this.B=null},t.ya=function(t,i,n,e){return this.c.add(String(t),i,!1,n,e)},t.za=function(t,i,n,e){return this.c.add(String(t),i,!0,n,e)};var It=n.JSON.stringify;function Ot(t,i){this.c=t,this.f=i,this.b=0,this.a=null}function xt(){this.b=this.a=null}Ot.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var jt,Pt=new Ot(function(){return new Lt},function(t){t.reset()});function Rt(){var t=Dt,i=null;return t.a&&(i=t.a,t.a=t.a.next,t.a||(t.b=null),i.next=null),i}function Lt(){this.next=this.b=this.a=null}function At(t){n.setTimeout(function(){throw t},0)}function Mt(t,i){jt||function(){var t=n.Promise.resolve(void 0);jt=function(){t.then(Xt)}}(),kt||(jt(),kt=!0),Dt.add(t,i)}xt.prototype.add=function(t,i){var n=Pt.get();n.set(t,i),this.b?this.b.next=n:this.a=n,this.b=n},Lt.prototype.set=function(t,i){this.a=t,this.b=i,this.next=null},Lt.prototype.reset=function(){this.next=this.b=this.a=null};var kt=!1,Dt=new xt;function Xt(){for(var t;t=Rt();){try{t.a.call(t.b)}catch(t){At(t)}var i=Pt;i.f(t),100>i.b&&(i.b++,t.next=i.a,i.a=t)}kt=!1}function _t(t,i){Ct.call(this),this.b=t||1,this.a=i||n,this.f=d(this.eb,this),this.g=g()}function Ht(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Nt(t,i,e){if("function"==h(t))e&&(t=d(t,e));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=d(t.handleEvent,t)}return 2147483647<Number(i)?-1:n.setTimeout(t,i||0)}function Ut(t,i,n){m.call(this),this.f=null!=n?d(t,n):t,this.c=i,this.b=d(this.Za,this),this.a=[]}function Ft(t){t.U=Nt(t.b,t.c),t.f.apply(null,t.a)}function Kt(t){m.call(this),this.b=t,this.a={}}y(_t,Ct),(t=_t.prototype).ba=!1,t.L=null,t.eb=function(){if(this.ba){var t=g()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Ht(this),this.start()))}},t.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=g())},t.G=function(){_t.N.G.call(this),Ht(this),delete this.a},y(Ut,m),(t=Ut.prototype).ea=!1,t.U=null,t.Sa=function(t){this.a=arguments,this.U?this.ea=!0:Ft(this)},t.G=function(){Ut.N.G.call(this),this.U&&(n.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},t.Za=function(){this.U=null,this.ea&&(this.ea=!1,Ft(this))},y(Kt,m);var Yt=[];function Bt(t,i,n,e){o(n)||(n&&(Yt[0]=n.toString()),n=Yt);for(var s=0;s<n.length;s++){var a=vt(i,n[s],e||t.handleEvent,!1,t.b||t);if(!a)break;t.a[a.key]=a}}function Gt(t){M(t.a,function(t,i){this.a.hasOwnProperty(i)&&bt(t)},t),t.a={}}function Jt(){}Kt.prototype.G=function(){Kt.N.G.call(this),Gt(this)},Kt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wt=null;function $t(){return Wt=Wt||new Ct}function qt(t){nt.call(this,"serverreachability",t)}function Vt(t){var i=$t();i.dispatchEvent(new qt(i,t))}function Zt(t){nt.call(this,"statevent",t)}function zt(t){var i=$t();i.dispatchEvent(new Zt(i,t))}function Qt(t){nt.call(this,"timingevent",t)}function ti(t,i){if("function"!=h(t))throw Error("Fn must not be null and must be a function");return n.setTimeout(function(){t()},i)}y(qt,nt),y(Zt,nt),y(Qt,nt);var ii={NO_ERROR:0,fb:1,mb:2,lb:3,ib:4,kb:5,nb:6,Ka:7,TIMEOUT:8,qb:9},ni={hb:"complete",ub:"success",La:"error",Ka:"abort",sb:"ready",tb:"readystatechange",TIMEOUT:"timeout",ob:"incrementaldata",rb:"progress",jb:"downloadprogress",vb:"uploadprogress"};function ei(){}function si(t){var i;return(i=t.a)||(i=t.a={}),i}function ai(){}ei.prototype.a=null;var ri,hi={OPEN:"a",gb:"b",La:"c",pb:"d"};function oi(){nt.call(this,"d")}function ci(){nt.call(this,"c")}function li(){}function ui(t,i,n){this.g=t,this.W=i,this.V=n||1,this.I=new Kt(this),this.O=fi,t=Y?125:void 0,this.P=new _t(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}y(oi,nt),y(ci,nt),y(li,ei),ri=new li;var fi=45e3,pi={},vi={};function di(t,i,n){t.F=1,t.f=Ui(Mi(i)),t.l=n,t.H=!0,gi(t,null)}function bi(t,i,n,e){t.F=1,t.f=Ui(Mi(i)),t.l=null,t.H=n,gi(t,e)}function gi(t,i){t.v=g(),wi(t),t.D=Mi(t.f),Ni(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?i:null),0<t.J&&(t.B=new Ut(d(t.Ia,t,t.a),t.J)),Bt(t.I,t.a,"readystatechange",t.bb),i=t.h?k(t.h):{},t.l?(t.w||(t.w="POST"),i["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,i)):(t.w="GET",t.a.ca(t.D,t.w,null,i)),Vt(1)}function yi(t,i,n){for(var e=!0;!t.m&&t.A<n.length;){var s=mi(t,n);if(s==vi){4==i&&(t.c=4,zt(14),e=!1);break}if(s==pi){t.c=4,zt(15),e=!1;break}Ii(t,s)}4==i&&0==n.length&&(t.c=1,zt(16),e=!1),t.b=t.b&&e,e||(Si(t),Ci(t))}function mi(t,i){var n=t.A,e=i.indexOf("\n",n);return-1==e?vi:(n=Number(i.substring(n,e)),isNaN(n)?pi:(e+=1)+n>i.length?vi:(i=i.substr(e,n),t.A=e+n,i))}function wi(t){t.R=g()+t.O,Ei(t,t.O)}function Ei(t,i){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ti(d(t.$a,t),i)}function Ti(t){t.i&&(n.clearTimeout(t.i),t.i=null)}function Ci(t){t.g.Ba()||t.m||t.g.ma(t)}function Si(t){Ti(t);var i=t.B;i&&"function"==typeof i.ka&&i.ka(),t.B=null,Ht(t.P),Gt(t.I),t.a&&(i=t.a,t.a=null,i.abort(),i.ka())}function Ii(t,i){try{t.g.Ea(t,i),Vt(4)}catch(t){}}function Oi(t,i){if(t.forEach&&"function"==typeof t.forEach)t.forEach(i,void 0);else if(c(t)||e(t))C(t,i,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(c(t)||e(t)){n=[];for(var s=t.length,a=0;a<s;a++)n.push(a)}else for(a in n=[],s=0,t)n[s++]=a;a=(s=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(e(t))return t.split("");if(c(t)){for(var i=[],n=t.length,s=0;s<n;s++)i.push(t[s]);return i}for(s in i=[],n=0,t)i[n++]=t[s];return i}(t)).length;for(var r=0;r<a;r++)i.call(void 0,s[r],n&&n[r],t)}}function xi(t,i){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var e=0;e<n;e+=2)this.set(arguments[e],arguments[e+1])}else if(t)if(t instanceof xi)for(n=t.K(),e=0;e<n.length;e++)this.set(n[e],t.get(n[e]));else for(e in t)this.set(e,t[e])}function ji(t,i){Ri(t.b,i)&&(delete t.b[i],t.c--,t.a.length>2*t.c&&Pi(t))}function Pi(t){if(t.c!=t.a.length){for(var i=0,n=0;i<t.a.length;){var e=t.a[i];Ri(t.b,e)&&(t.a[n++]=e),i++}t.a.length=n}if(t.c!=t.a.length){var s={};for(n=i=0;i<t.a.length;)Ri(s,e=t.a[i])||(t.a[n++]=e,s[e]=1),i++;t.a.length=n}}function Ri(t,i){return Object.prototype.hasOwnProperty.call(t,i)}(t=ui.prototype).setTimeout=function(t){this.O=t},t.bb=function(t){t=t.target;var i=this.B;i&&3==An(t)?i.Sa():this.Ia(t)},t.Ia=function(t){try{if(t==this.a)t:{var i=An(this.a),n=this.a.xa(),e=this.a.T();if(!(3>i||3==i&&!Y&&!this.a.aa())){this.m||4!=i||7==n||Vt(8==n||0>=e?3:2),Ti(this);var s=this.a.T();this.o=s;var a=this.a.aa();if(this.b=200==s){if(this.S&&!this.s){i:{if(this.a){var r=Mn(this.a,"X-HTTP-Initial-Response");if(r&&!O(r)){var h=r;break i}}h=null}if(!h){this.b=!1,this.c=3,zt(12),Si(this),Ci(this);break t}this.s=!0,Ii(this,h)}this.H?(yi(this,i,a),Y&&this.b&&3==i&&(Bt(this.I,this.P,"tick",this.ab),this.P.start())):Ii(this,a),4==i&&Si(this),this.b&&!this.m&&(4==i?this.g.ma(this):(this.b=!1,wi(this)))}else 400==s&&0<a.indexOf("Unknown SID")?(this.c=3,zt(12)):(this.c=0,zt(13)),Si(this),Ci(this)}}}catch(t){}},t.ab=function(){if(this.a){var t=An(this.a),i=this.a.aa();this.A<i.length&&(Ti(this),yi(this,t,i),this.b&&4!=t&&wi(this))}},t.cancel=function(){this.m=!0,Si(this)},t.$a=function(){this.i=null;var t=g();0<=t-this.R?(2!=this.F&&(Vt(3),zt(17)),Si(this),this.c=2,Ci(this)):Ei(this,this.R-t)},(t=xi.prototype).C=function(){Pi(this);for(var t=[],i=0;i<this.a.length;i++)t.push(this.b[this.a[i]]);return t},t.K=function(){return Pi(this),this.a.concat()},t.get=function(t,i){return Ri(this.b,t)?this.b[t]:i},t.set=function(t,i){Ri(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=i},t.forEach=function(t,i){for(var n=this.K(),e=0;e<n.length;e++){var s=n[e],a=this.get(s);t.call(i,a,s,this)}};var Li=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ai(t,i){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ai){this.a=void 0!==i?i:t.a,ki(this,t.f),this.j=t.j,Di(this,t.c),Xi(this,t.h),this.g=t.g,i=t.b;var n=new qi;n.c=i.c,i.a&&(n.a=new xi(i.a),n.b=i.b),_i(this,n),this.i=t.i}else t&&(n=String(t).match(Li))?(this.a=!!i,ki(this,n[1]||"",!0),this.j=Fi(n[2]||""),Di(this,n[3]||"",!0),Xi(this,n[4]),this.g=Fi(n[5]||"",!0),_i(this,n[6]||"",!0),this.i=Fi(n[7]||"")):(this.a=!!i,this.b=new qi(null,this.a))}function Mi(t){return new Ai(t)}function ki(t,i,n){t.f=n?Fi(i,!0):i,t.f&&(t.f=t.f.replace(/:$/,""))}function Di(t,i,n){t.c=n?Fi(i,!0):i}function Xi(t,i){if(i){if(i=Number(i),isNaN(i)||0>i)throw Error("Bad port number "+i);t.h=i}else t.h=null}function _i(t,i,n){i instanceof qi?(t.b=i,function(t,i){i&&!t.f&&(Vi(t),t.c=null,t.a.forEach(function(t,i){var n=i.toLowerCase();i!=n&&(Zi(this,i),Qi(this,n,t))},t)),t.f=i}(t.b,t.a)):(n||(i=Ki(i,Wi)),t.b=new qi(i,t.a))}function Hi(t,i,n){t.b.set(i,n)}function Ni(t,i,n){o(n)||(n=[String(n)]),Qi(t.b,i,n)}function Ui(t){return Hi(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^g()).toString(36)),t}function Fi(t,i){return t?i?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ki(t,i,n){return e(t)?(t=encodeURI(t).replace(i,Yi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Yi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ai.prototype.toString=function(){var t=[],i=this.f;i&&t.push(Ki(i,Bi,!0),":");var n=this.c;return(n||"file"==i)&&(t.push("//"),(i=this.j)&&t.push(Ki(i,Bi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ki(n,"/"==n.charAt(0)?Ji:Gi,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ki(n,$i)),t.join("")};var Bi=/[#\/\?@]/g,Gi=/[#\?:]/g,Ji=/[#\?]/g,Wi=/[#\?@]/g,$i=/#/g;function qi(t,i){this.b=this.a=null,this.c=t||null,this.f=!!i}function Vi(t){t.a||(t.a=new xi,t.b=0,t.c&&function(t,i){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var e=t[n].indexOf("="),s=null;if(0<=e){var a=t[n].substring(0,e);s=t[n].substring(e+1)}else a=t[n];i(a,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.c,function(i,n){t.add(decodeURIComponent(i.replace(/\+/g," ")),n)}))}function Zi(t,i){Vi(t),i=tn(t,i),Ri(t.a.b,i)&&(t.c=null,t.b-=t.a.get(i).length,ji(t.a,i))}function zi(t,i){return Vi(t),i=tn(t,i),Ri(t.a.b,i)}function Qi(t,i,n){Zi(t,i),0<n.length&&(t.c=null,t.a.set(tn(t,i),I(n)),t.b+=n.length)}function tn(t,i){return i=String(i),t.f&&(i=i.toLowerCase()),i}function nn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function en(t){var i=t.a.F.a;if(null!=i)zt(4),i?(zt(10),Gn(t.a,t,!1)):(zt(11),Gn(t.a,t,!0));else{t.b=new ui(t,void 0,void 0),t.b.h=t.h,i=Vn(i=t.a,i.Y()?t.f:null,t.i),zt(4),Ni(i,"TYPE","xmlhttp");var n=t.a.j,e=t.a.I;n&&e&&Hi(i,n,e),bi(t.b,i,!1,t.f)}}function sn(){this.a=this.b=null}function an(){this.a=new xi}function rn(t){var i=typeof t;return"object"==i&&t||"function"==i?"o"+(t[u]||(t[u]=++f)):i.charAt(0)+t}function hn(t,i){this.b=t,this.a=i}function on(t){this.g=t||cn,n.PerformanceNavigationTiming?t=0<(t=n.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(n.a&&n.a.Ca&&n.a.Ca()&&n.a.Ca().xb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new an),this.b=null,this.c=[]}(t=qi.prototype).add=function(t,i){Vi(this),this.c=null,t=tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(i),this.b+=1,this},t.forEach=function(t,i){Vi(this),this.a.forEach(function(n,e){C(n,function(n){t.call(i,n,e,this)},this)},this)},t.K=function(){Vi(this);for(var t=this.a.C(),i=this.a.K(),n=[],e=0;e<i.length;e++)for(var s=t[e],a=0;a<s.length;a++)n.push(i[e]);return n},t.C=function(t){Vi(this);var i=[];if(e(t))zi(this,t)&&(i=S(i,this.a.get(tn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)i=S(i,t[n])}return i},t.set=function(t,i){return Vi(this),this.c=null,zi(this,t=tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[i]),this.b+=1,this},t.get=function(t,i){return t&&0<(t=this.C(t)).length?String(t[0]):i},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],i=this.a.K(),n=0;n<i.length;n++){var e=i[n],s=encodeURIComponent(String(e));e=this.C(e);for(var a=0;a<e.length;a++){var r=s;""!==e[a]&&(r+="="+encodeURIComponent(String(e[a]))),t.push(r)}}return this.c=t.join("&")},(t=nn.prototype).M=null,t.$=function(t){return this.a.$(t)},t.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},t.Ba=function(){return!1},t.Ea=function(t,i){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Mn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Mn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(i){try{var e=this.a.ja.a.parse(i)}catch(t){return(i=this.a).m=this.c,void $n(i,2)}this.f=e[0]}else(i=this.a).m=this.c,$n(i,2)}else 1==this.M&&(this.g?zt(6):"11111"==i?(zt(5),this.g=!0,(!F||10<=Number(V))&&(this.c=200,this.b.cancel(),zt(11),Gn(this.a,this,!0))):(zt(7),this.g=!1))},t.ma=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,en(this)):1==this.M&&(this.g?(zt(11),Gn(this.a,this,!0)):(zt(10),Gn(this.a,this,!1)));else{0==this.M?zt(8):1==this.M&&zt(9);var t=this.a;t.m=this.c,$n(t,2)}},t.Y=function(){return this.a.Y()},t.la=function(){return this.a.la()},an.prototype.add=function(t){this.a.set(rn(t),t)},an.prototype.C=function(){return this.a.C()};var cn=10;function ln(t,i){!t.a&&(P(i,"spdy")||P(i,"quic")||P(i,"h2"))&&(t.f=t.g,t.a=new an,t.b&&(vn(t,t.b),t.b=null))}function un(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function fn(t){return t.b?1:t.a?t.a.a.c:0}function pn(t,i){return t.b?t=t.b==i:t.a?(i=rn(i),t=Ri(t.a.a.b,i)):t=!1,t}function vn(t,i){t.a?t.a.add(i):t.b=i}function dn(t,i){var n;t.b&&t.b==i?t.b=null:((n=t.a)&&(n=rn(i),n=Ri(t.a.a.b,n)),n&&ji(t.a.a,rn(i)))}function bn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var i=t.c;return C(t.a.C(),function(t){i=i.concat(t.j)}),i}return I(t.c)}function gn(){}function yn(){this.a=new gn}function mn(t,i,n){var e=n||"";try{Oi(t,function(t,n){var s=t;l(t)&&(s=It(t)),i.push(e+n+"="+encodeURIComponent(s))})}catch(t){throw i.push(e+"type="+encodeURIComponent("_badmap")),t}}function wn(t,i,n,e,s){try{i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null,s(e)}catch(t){}}on.prototype.cancel=function(){var t;this.c=bn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(C(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},gn.prototype.stringify=function(t){return n.JSON.stringify(t,void 0)},gn.prototype.parse=function(t){return n.JSON.parse(t,void 0)};var En=n.JSON.parse;function Tn(t){Ct.call(this),this.headers=new xi,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}y(Tn,Ct);var Cn="",Sn=/^https?$/i,In=["POST","PUT"];function On(t){return"content-type"==t.toLowerCase()}function xn(t,i){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=i,t.h=5,jn(t),Rn(t)}function jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pn(t){if(t.b&&void 0!==i&&(!t.s[1]||4!=An(t)||2!=t.T()))if(t.l&&4==An(t))Nt(t.Da,0,t);else if(t.dispatchEvent("readystatechange"),4==An(t)){t.b=!1;try{var e,s=t.T();t:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break t;default:a=!1}if(!(e=a)){var r;if(r=0===s){var h=String(t.A).match(Li)[1]||null;if(!h&&n.self&&n.self.location){var o=n.self.location.protocol;h=o.substr(0,o.length-1)}r=!Sn.test(h?h.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<An(t)?t.a.statusText:""}catch(t){c=""}t.f=c+" ["+t.T()+"]",jn(t)}}finally{Rn(t)}}}function Rn(t,i){if(t.a){Ln(t);var n=t.a,e=t.s[0]?r:null;t.a=null,t.s=null,i||t.dispatchEvent("ready");try{n.onreadystatechange=e}catch(t){}}}function Ln(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(n.clearTimeout(t.m),t.m=null)}function An(t){return t.a?t.a.readyState:0}function Mn(t,i){return t.a?t.a.getResponseHeader(i):null}function kn(t,i,n){t:{for(s in n){var s=!1;break t}s=!0}if(s)return t;if(n=function(t){var i="";return M(t,function(t,n){i+=n,i+=":",i+=t,i+="\r\n"}),i}(n),e(t)){if(i=encodeURIComponent(String(i)),i+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(s=t.indexOf("?"))||s>n){s=n;var a=""}else a=t.substring(s+1,n);n=(t=[t.substr(0,s),a,t.substr(n)])[1],t[1]=i?n?n+"&"+i:i:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Hi(t,i,n),t}function Dn(t){this.f=[],this.F=new sn,this.ga=this.oa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Pa=this.P=0,this.Na=!!a("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.na=!0,this.m=this.qa=this.O=-1,this.S=this.v=this.A=0,this.Ma=a("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Qa=a("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Oa=a("internalChannelParams.forwardChannelMaxRetries",t)||2,this.pa=a("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ja=t&&t.yb||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new on(t&&t.concurrentRequestLimit),this.ja=new yn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.na=!1),this.fa=void 0}function Xn(t){if(_n(t),3==t.u){var i=t.P++,e=Mi(t.B);Hi(e,"SID",t.H),Hi(e,"RID",i),Hi(e,"TYPE","terminate"),Fn(t,e),(i=new ui(t,i,void 0)).F=2,i.f=Ui(Mi(e)),e=!1,n.navigator&&n.navigator.sendBeacon&&(e=n.navigator.sendBeacon(i.f.toString(),"")),!e&&n.Image&&((new Image).src=i.f,e=!0),e||(i.a=i.g.$(null),i.a.ca(i.f)),i.v=g(),wi(i)}qn(t)}function _n(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(n.clearTimeout(t.l),t.l=null),Jn(t),t.b.cancel(),t.h&&(s(t.h)&&n.clearTimeout(t.h),t.h=null)}function Hn(t,i){t.f.push(new hn(t.Pa++,i)),3==t.u&&Nn(t)}function Nn(t){un(t.b)||t.h||(t.h=!0,Mt(t.Ga,t),t.A=0)}function Un(t,i){var n;n=i?i.W:t.P++;var e=Mi(t.B);Hi(e,"SID",t.H),Hi(e,"RID",n),Hi(e,"AID",t.O),Fn(t,e),t.g&&t.i&&kn(e,t.g,t.i),n=new ui(t,n,t.A+1),null===t.g&&(n.h=t.i),i&&(t.f=i.j.concat(t.f)),i=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.pa)+Math.round(.5*t.pa*Math.random())),vn(t.b,n),di(n,e,i)}function Fn(t,i){t.c&&Oi({},function(t,n){Hi(i,n,t)})}function Kn(t,i,n){n=Math.min(t.f.length,n);var e=t.c?d(t.c.Ra,t.c,t):null;t:for(var s=t.f,a=-1;;){var r=["count="+n];-1==a?0<n?(a=s[0].b,r.push("ofs="+a)):a=0:r.push("ofs="+a);for(var h=!0,o=0;o<n;o++){var c=s[o].b,l=s[o].a;if(0>(c-=a))a=Math.max(0,s[o].b-100),h=!1;else try{mn(l,r,"req"+c+"_")}catch(t){e&&e(l)}}if(h){e=r.join("&");break t}}return t=t.f.splice(0,n),i.j=t,e}function Yn(t){t.a||t.l||(t.S=1,Mt(t.Fa,t),t.v=0)}function Bn(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ti(d(t.Fa,t),Wn(t,t.v)),t.v++,!0)}function Gn(t,i,n){var e=i.l;e&&ln(t.b,e),t.ia=t.na&&n,t.m=i.c,t.B=Vn(t,null,t.ha),Nn(t)}function Jn(t){null!=t.s&&(n.clearTimeout(t.s),t.s=null)}function Wn(t,i){var n=t.Ma+Math.floor(Math.random()*t.Qa);return t.la()||(n*=2),n*i}function $n(t,i){if(2==i){var e=null;t.c&&(e=null);var s=d(t.cb,t);e||(e=new Ai("//www.google.com/images/cleardot.gif"),n.location&&"http"==n.location.protocol||ki(e,"https"),Ui(e)),function(t,i){var e=new Jt;if(n.Image){var s=new Image;s.onload=b(wn,e,s,"TestLoadImage: loaded",!0,i),s.onerror=b(wn,e,s,"TestLoadImage: error",!1,i),s.onabort=b(wn,e,s,"TestLoadImage: abort",!1,i),s.ontimeout=b(wn,e,s,"TestLoadImage: timeout",!1,i),n.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else i(!1)}(e.toString(),s)}else zt(2);t.u=0,t.c&&t.c.sa(i),qn(t),_n(t)}function qn(t){t.u=0,t.m=-1,t.c&&(0==bn(t.b).length&&0==t.f.length||(t.b.c.length=0,I(t.f),t.f.length=0),t.c.ra())}function Vn(t,i,e){var s=function(t){return t instanceof Ai?Mi(t):new Ai(t,void 0)}(e);if(""!=s.c)i&&Di(s,i+"."+s.c),Xi(s,s.h);else{var a=n.location;s=function(t,i,n,e){var s=new Ai(null,void 0);return t&&ki(s,t),i&&Di(s,i),n&&Xi(s,n),e&&(s.g=e),s}(a.protocol,i?i+"."+a.hostname:a.hostname,+a.port,e)}return t.V&&M(t.V,function(t,i){Hi(s,i,t)}),i=t.j,e=t.I,i&&e&&Hi(s,i,e),Hi(s,"VER",t.va),Fn(t,s),s}function Zn(){}function zn(){if(F&&!(10<=Number(V)))throw Error("Environmental error: no available transport.")}function Qn(t,i){Ct.call(this),this.a=new Dn(i),this.g=t,this.m=i&&i.testUrl?i.testUrl:function(t){for(var i=arguments[0],n=1;n<arguments.length;n++){var e,s=arguments[n];0==s.lastIndexOf("/",0)?i=s:((e=""==i)||(e=0<=(e=i.length-1)&&i.indexOf("/",e)==e),i+=e?s:"/"+s)}return i}(this.g,"test"),this.b=i&&i.messageUrlParams||null,t=i&&i.messageHeaders||null,i&&i.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=i&&i.initMessageHeaders||null,i&&i.messageContentType&&(t?t["X-WebChannel-Content-Type"]=i.messageContentType:t={"X-WebChannel-Content-Type":i.messageContentType}),i&&i.wa&&(t?t["X-WebChannel-Client-Profile"]=i.wa:t={"X-WebChannel-Client-Profile":i.wa}),this.a.J=t,(t=i&&i.httpHeadersOverwriteParam)&&!O(t)&&(this.a.g=t),this.l=i&&i.supportsCrossDomainXhr||!1,this.h=i&&i.sendRawJson||!1,(i=i&&i.httpSessionIdParam)&&!O(i)&&(this.a.j=i,null!==(t=this.b)&&i in t&&(i in(t=this.b)&&delete t[i])),this.f=new ne(this)}function te(t){oi.call(this);var i=t.__sm__;if(i){t:{for(var n in i){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==i&&t in i?i[t]:void 0):this.data=i}else this.data=t}function ie(){ci.call(this),this.status=1}function ne(t){this.a=t}(t=Tn.prototype).ca=function(t,i,a,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);i=i?i.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?si(this.H):si(ri),this.a.onreadystatechange=d(this.Da,this);try{this.w=!0,this.a.open(i,String(t),!0),this.w=!1}catch(t){return void xn(this,t)}t=a||"";var h=new xi(this.headers);r&&Oi(r,function(t,i){h.set(i,t)}),r=function(t){t:{for(var i=On,n=t.length,s=e(t)?t.split(""):t,a=0;a<n;a++)if(a in s&&i.call(void 0,s[a],a,t)){i=a;break t}i=-1}return 0>i?null:e(t)?t.charAt(i):t[i]}(h.K()),a=n.FormData&&t instanceof n.FormData,!(0<=T(In,i))||r||a||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),h.forEach(function(t,i){this.a.setRequestHeader(i,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ln(this),0<this.o&&((this.D=function(t){return F&&z(9)&&s(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=d(this.Aa,this)):this.m=Nt(this.Aa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},t.Aa=function(){void 0!==i&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Rn(this))},t.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Rn(this,!0)),Tn.N.G.call(this)},t.Da=function(){this.j||(this.w||this.l||this.g?Pn(this):this.Ya())},t.Ya=function(){Pn(this)},t.T=function(){try{return 2<An(this)?this.a.status:-1}catch(t){return-1}},t.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},t.Ta=function(t){if(this.a){var i=this.a.responseText;return t&&0==i.indexOf(t)&&(i=i.substring(t.length)),En(i)}},t.xa=function(){return this.h},t.Wa=function(){return e(this.f)?this.f:String(this.f)},(t=Dn.prototype).va=8,t.u=1,t.Ba=function(){return 0==this.u},t.Ga=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var i,n=new ui(this,t=this.P++,void 0),s=this.i;if(this.J&&(s?X(s=k(s),this.J):s=this.J),null===this.g&&(n.h=s),this.W)t:{for(var a=i=0;a<this.f.length;a++){var r=this.f[a];if(void 0===(r="__data__"in r.a&&e(r=r.a.__data__)?r.length:void 0))break;if(4096<(i+=r)){i=a;break t}if(4096===i||a===this.f.length-1){i=a+1;break t}}i=1e3}else i=1e3;i=Kn(this,n,i),Hi(a=Mi(this.B),"RID",t),Hi(a,"CVER",22),this.o&&this.j&&Hi(a,"X-HTTP-Session-Id",this.j),Fn(this,a),this.g&&s&&kn(a,this.g,s),vn(this.b,n),this.W?(Hi(a,"$req",i),Hi(a,"SID","null"),n.S=!0,di(n,a,null)):di(n,a,i),this.u=2}}else 3==this.u&&(t?Un(this,t):0==this.f.length||un(this.b)||Un(this))},t.Fa=function(){this.l=null,this.a=new ui(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Mi(this.oa);Hi(t,"RID","rpc"),Hi(t,"SID",this.H),Hi(t,"CI",this.ia?"0":"1"),Hi(t,"AID",this.O),Fn(this,t),Hi(t,"TYPE","xmlhttp"),this.g&&this.i&&kn(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),bi(this.a,t,!0,this.ga)},t.Ea=function(t,i){if(0!=this.u&&(this.a==t||pn(this.b,t)))if(this.m=t.o,!t.s&&pn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(i)}catch(t){n=null}if(o(n)&&3==n.length){if(0==(i=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Jn(this),this.a.cancel(),this.a=null}Bn(this),zt(18)}}else this.qa=i[1],0<this.qa-this.O&&37500>i[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ti(d(this.Xa,this),6e3));if(1>=fn(this.b)&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else $n(this,11)}else if((t.s||this.a==t)&&Jn(this),!O(i))for(i=n=this.ja.a.parse(i),n=0;n<i.length;n++){var e=i[n];if(this.O=e[0],e=e[1],2==this.u)if("c"==e[0]){this.H=e[1],this.ga=e[2];var a=e[3];null!=a&&(this.va=a),null!=(e=e[5])&&s(e)&&0<e&&(this.D=1.5*e),this.o&&(e=t.a)&&((a=Mn(e,"X-Client-Wire-Protocol"))&&ln(this.b,a),this.j&&(e=Mn(e,"X-HTTP-Session-Id")))&&(this.I=e,Hi(this.B,this.j,e)),this.u=3,this.c&&this.c.ua(),e=t,this.oa=Vn(this,this.Y()?this.ga:null,this.ha),e.s?(dn(this.b,e),(a=this.D)&&e.setTimeout(a),e.i&&(Ti(e),wi(e)),this.a=e):Yn(this),0<this.f.length&&Nn(this)}else"stop"!=e[0]&&"close"!=e[0]||$n(this,7);else 3==this.u&&("stop"==e[0]||"close"==e[0]?"stop"==e[0]?$n(this,7):Xn(this):"noop"!=e[0]&&this.c&&this.c.ta(e),this.v=0)}},t.Xa=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Bn(this),zt(19))},t.ma=function(t){var i=null;if(this.a==t){Jn(this),this.a=null;var n=2}else{if(!pn(this.b,t))return;i=t.j,dn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)if(1==n){i=t.l?t.l.length:0,t=g()-t.v;var e=this.A;(n=$t()).dispatchEvent(new Qt(n,i,t,e)),Nn(this)}else Yn(this);else if(3==(e=t.c)||0==e&&0<this.m||!(1==n&&function(t,i){return!(fn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.f=i.j.concat(t.f),0):1==t.u||2==t.u||t.A>=(t.Na?0:t.Oa)||(t.h=ti(d(t.Ga,t,i),Wn(t,t.A)),t.A++,0)))}(this,t)||2==n&&Bn(this)))switch(i&&0<i.length&&(t=this.b,t.c=t.c.concat(i)),e){case 1:$n(this,5);break;case 4:$n(this,10);break;case 3:$n(this,6);break;default:$n(this,2)}},t.cb=function(t){zt(t?2:1)},t.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Tn(this.Ja)).F=this.R,t},t.la=function(){return!!this.c&&!0},t.Y=function(){return this.R},(t=Zn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.Ra=function(){},zn.prototype.a=function(t,i){return new Qn(t,i)},y(Qn,Ct),(t=Qn.prototype).addEventListener=function(t,i,n,e){Qn.N.addEventListener.call(this,t,i,n,e)},t.removeEventListener=function(t,i,n,e){Qn.N.removeEventListener.call(this,t,i,n,e)},t.Ua=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,i=this.m,n=this.g,e=this.b||void 0;zt(0),t.ha=n,t.V=e||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new nn(t),null===t.g&&(t.w.h=t.i),n=i,t.g&&t.i&&(n=kn(i,t.g,t.i)),(t=t.w).i=n,i=Vn(t.a,null,t.i),zt(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,en(t)):(Ni(i,"MODE","init"),!t.a.o&&t.a.j&&Ni(i,"X-HTTP-Session-Id",t.a.j),t.b=new ui(t,void 0,void 0),t.b.h=t.h,bi(t.b,i,!1,null),t.M=0)},t.close=function(){Xn(this.a)},t.Va=function(t){if(e(t)){var i={};i.__data__=t,Hn(this.a,i)}else this.h?((i={}).__data__=It(t),Hn(this.a,i)):Hn(this.a,t)},t.G=function(){this.a.c=null,delete this.f,Xn(this.a),delete this.a,Qn.N.G.call(this)},y(te,oi),y(ie,ci),y(ne,Zn),ne.prototype.ua=function(){this.a.dispatchEvent("a")},ne.prototype.ta=function(t){this.a.dispatchEvent(new te(t))},ne.prototype.sa=function(t){this.a.dispatchEvent(new ie(t))},ne.prototype.ra=function(){this.a.dispatchEvent("b")};var ee=b(function(t,i){function n(){}n.prototype=t.prototype;var e=new n;return t.apply(e,Array.prototype.slice.call(arguments,1)),e},zn);zn.prototype.createWebChannel=zn.prototype.a,Qn.prototype.send=Qn.prototype.Va,Qn.prototype.open=Qn.prototype.Ua,Qn.prototype.close=Qn.prototype.close,ii.NO_ERROR=0,ii.TIMEOUT=8,ii.HTTP_ERROR=6,ni.COMPLETE="complete",ai.EventType=hi,hi.OPEN="a",hi.CLOSE="b",hi.ERROR="c",hi.MESSAGE="d",Ct.prototype.listen=Ct.prototype.ya,Tn.prototype.listenOnce=Tn.prototype.za,Tn.prototype.getLastError=Tn.prototype.Wa,Tn.prototype.getLastErrorCode=Tn.prototype.xa,Tn.prototype.getStatus=Tn.prototype.T,Tn.prototype.getResponseJson=Tn.prototype.Ta,Tn.prototype.getResponseText=Tn.prototype.aa,Tn.prototype.send=Tn.prototype.ca,module.exports={createWebChannelTransport:ee,ErrorCode:ii,EventType:ni,WebChannel:ai,XhrIo:Tn}}).call("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/app/dist/index.cjs.js":[function(require,module,exports){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var firebase=_interopDefault(require("@firebase/app")),name="firebase",version="7.7.0";firebase.registerVersion(name,version,"app"),module.exports=firebase;

},{"@firebase/app":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/app/dist/index.cjs.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/auth/dist/index.cjs.js":[function(require,module,exports){
"use strict";require("@firebase/auth");

},{"@firebase/auth":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/auth/dist/auth.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/firestore/dist/index.cjs.js":[function(require,module,exports){
"use strict";require("@firebase/firestore");

},{"@firebase/firestore":"/Users/rabbit/projects/buntimer2020-github/node_modules/@firebase/firestore/dist/index.cjs.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/named-regexp-groups/dist/index.js":[function(require,module,exports){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var R_NAME=/([a-zA-Z_$][a-zA-Z_$0-9]{0,50})/,R_NAME_REPLACE=new RegExp("\\$\\+{".concat(R_NAME.source,"}"),"g"),R_NAMED_BACKREF=new RegExp("^[?:]&".concat(R_NAME.source)),R_GROUP=new RegExp("^[?:]<".concat(R_NAME.source,">([^]*)")),R_GROUPS=/([\\]?[()])/g,R_EMPTY_GROUPS=/\(\)/g;function generate(e,t){var r={},n={};(e=e||"")instanceof RegExp&&((t=t||e.flags||"")||(e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.global&&(t+="g")),e=e.source);var o={count:0,groups:[""],names:[]},s=0,u=e.split(R_GROUPS);return{source:u.map(function(e,t){var a,c;switch(e){case"(":o.groups.push(""),o.names.push("");break;case")":c=o.groups.pop(),(a=o.names.pop())&&(n[a]=c.substr(1));break;default:"("===u[t-1]&&!/^\?[:!=]/.test(e)&&(s++,(a=R_GROUP.exec(e))&&a[1]?(r[a[1]]?r[o.count++]=s:(o.names[o.names.length-1]=a[1],r[a[1]]=s),e=a[2]||"",")"!==u[t+1]||a[2]||(e="[^]+")):r[o.count++]=s,(a=R_NAMED_BACKREF.exec(e))&&a[1]&&(e=n[a[1]]||""))}return o.groups=o.groups.map(function(t){return t+e}),e}).join("").replace(R_EMPTY_GROUPS,""),flags:t,groups:r,named:n}}var NamedRegExp=function(){function e(t,r){_classCallCheck(this,e);var n=generate(t,r);this.regex=new RegExp(n.source,n.flags),this.source=this.regex.source,this.groups=n.groups}return _createClass(e,[{key:"exec",value:function(e){var t=this,r=this.regex.exec(e);return r&&(r.groups={},Object.keys(this.groups).forEach(function(e){r.groups[e]=r[t.groups[e]]})),r}},{key:"test",value:function(e){return this.regex.test(e)}},{key:"toString",value:function(){return this.regex.toString()}},{key:Symbol.replace,value:function(e,t){var r=this,n=t;switch(_typeof(n)){case"string":n=n.replace(R_NAME_REPLACE,function(e,t){var n=r.groups[t];return null==n?"":"$"+r.groups[t]});break;case"function":n=t.bind(this);break;default:return String(n)}return e.replace(this.regex,n)}},{key:Symbol.match,value:function(e){return this.exec(e)}},{key:Symbol.split,value:function(e){return e.split(this.regex)}},{key:Symbol.search,value:function(e){return e.search(this.regex)}}]),e}();exports.default=NamedRegExp,module.exports=exports.default;

},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/object-assign/index.js":[function(require,module,exports){
"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(e){return r[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}module.exports=shouldUseNative()?Object.assign:function(e,r){for(var t,n,o=toObject(e),a=1;a<arguments.length;a++){for(var s in t=Object(arguments[a]))hasOwnProperty.call(t,s)&&(o[s]=t[s]);if(getOwnPropertySymbols){n=getOwnPropertySymbols(t);for(var c=0;c<n.length;c++)propIsEnumerable.call(t,n[c])&&(o[n[c]]=t[n[c]])}}return o};

},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/process/browser.js":[function(require,module,exports){
var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/react-dom/cjs/react-dom.production.min.js":[function(require,module,exports){
"use strict";var aa=require("react"),n=require("object-assign"),q=require("scheduler");function u(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!aa)throw Error(u(227));var ba=null,ca={};function da(){if(ba)for(var e in ca){var t=ca[e],n=ba.indexOf(e);if(!(-1<n))throw Error(u(96,e));if(!ea[n]){if(!t.extractEvents)throw Error(u(97,e));for(var r in ea[n]=t,n=t.eventTypes){var l=void 0,a=n[r],i=t,o=r;if(fa.hasOwnProperty(o))throw Error(u(99,o));fa[o]=a;var c=a.phasedRegistrationNames;if(c){for(l in c)c.hasOwnProperty(l)&&ha(c[l],i,o);l=!0}else a.registrationName?(ha(a.registrationName,i,o),l=!0):l=!1;if(!l)throw Error(u(98,r,e))}}}}function ha(e,t,n){if(ia[e])throw Error(u(100,e));ia[e]=t,ja[e]=t.eventTypes[n].dependencies}var ea=[],fa={},ia={},ja={};function ka(e,t,n,r,l,a,i,u,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var la=!1,ma=null,na=!1,oa=null,pa={onError:function(e){la=!0,ma=e}};function qa(e,t,n,r,l,a,i,u,o){la=!1,ma=null,ka.apply(pa,arguments)}function ra(e,t,n,r,l,a,i,o,c){if(qa.apply(this,arguments),la){if(!la)throw Error(u(198));var f=ma;la=!1,ma=null,na||(na=!0,oa=f)}}var sa=null,ua=null,va=null;function wa(e,t,n){var r=e.type||"unknown-event";e.currentTarget=va(n),ra(r,t,void 0,e),e.currentTarget=null}function xa(e,t){if(null==t)throw Error(u(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function ya(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var za=null;function Aa(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)wa(e,t[r],n[r]);else t&&wa(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function Ba(e){if(null!==e&&(za=xa(za,e)),e=za,za=null,e){if(ya(e,Aa),za)throw Error(u(95));if(na)throw e=oa,na=!1,oa=null,e}}var Ca={injectEventPluginOrder:function(e){if(ba)throw Error(u(101));ba=Array.prototype.slice.call(e),da()},injectEventPluginsByName:function(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!ca.hasOwnProperty(t)||ca[t]!==r){if(ca[t])throw Error(u(102,t));ca[t]=r,n=!0}}n&&da()}};function Da(e,t){var n=e.stateNode;if(!n)return null;var r=sa(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(u(231,t,typeof n));return n}var Ea=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ea.hasOwnProperty("ReactCurrentDispatcher")||(Ea.ReactCurrentDispatcher={current:null}),Ea.hasOwnProperty("ReactCurrentBatchConfig")||(Ea.ReactCurrentBatchConfig={suspense:null});var Fa=/^(.*)[\\\/]/,w="function"==typeof Symbol&&Symbol.for,Ga=w?Symbol.for("react.element"):60103,Ha=w?Symbol.for("react.portal"):60106,Ia=w?Symbol.for("react.fragment"):60107,Ja=w?Symbol.for("react.strict_mode"):60108,Ka=w?Symbol.for("react.profiler"):60114,La=w?Symbol.for("react.provider"):60109,Ma=w?Symbol.for("react.context"):60110,Na=w?Symbol.for("react.concurrent_mode"):60111,Oa=w?Symbol.for("react.forward_ref"):60112,Pa=w?Symbol.for("react.suspense"):60113,Qa=w?Symbol.for("react.suspense_list"):60120,Ra=w?Symbol.for("react.memo"):60115,Sa=w?Symbol.for("react.lazy"):60116;w&&Symbol.for("react.fundamental"),w&&Symbol.for("react.responder"),w&&Symbol.for("react.scope");var Ta="function"==typeof Symbol&&Symbol.iterator;function Ua(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Ta&&e[Ta]||e["@@iterator"])?e:null}function Va(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)})}}function Wa(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Ia:return"Fragment";case Ha:return"Portal";case Ka:return"Profiler";case Ja:return"StrictMode";case Pa:return"Suspense";case Qa:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ma:return"Context.Consumer";case La:return"Context.Provider";case Oa:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case Ra:return Wa(e.type);case Sa:if(e=1===e._status?e._result:null)return Wa(e)}return null}function Xa(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,l=e._debugSource,a=Wa(e.type);n=null,r&&(n=Wa(r.type)),r=a,a="",l?a=" (at "+l.fileName.replace(Fa,"")+":"+l.lineNumber+")":n&&(a=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+a}t+=n,e=e.return}while(e);return t}var Ya=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Za=null,$a=null,ab=null;function bb(e){if(e=ua(e)){if("function"!=typeof Za)throw Error(u(280));var t=sa(e.stateNode);Za(e.stateNode,e.type,t)}}function cb(e){$a?ab?ab.push(e):ab=[e]:$a=e}function db(){if($a){var e=$a,t=ab;if(ab=$a=null,bb(e),t)for(e=0;e<t.length;e++)bb(t[e])}}function eb(e,t){return e(t)}function fb(e,t,n,r){return e(t,n,r)}function gb(){}var hb=eb,ib=!1,jb=!1;function kb(){null===$a&&null===ab||(gb(),db())}new Map;var lb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mb=Object.prototype.hasOwnProperty,nb={},ob={};function pb(e){return!!mb.call(ob,e)||!mb.call(nb,e)&&(lb.test(e)?ob[e]=!0:(nb[e]=!0,!1))}function qb(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function rb(e,t,n,r){if(null==t||qb(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function B(e,t,n,r,l,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a}var D={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){D[e]=new B(e,0,!1,e,null,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];D[t]=new B(t,1,!1,e[1],null,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){D[e]=new B(e,2,!1,e.toLowerCase(),null,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){D[e]=new B(e,2,!1,e,null,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){D[e]=new B(e,3,!1,e.toLowerCase(),null,!1)}),["checked","multiple","muted","selected"].forEach(function(e){D[e]=new B(e,3,!0,e,null,!1)}),["capture","download"].forEach(function(e){D[e]=new B(e,4,!1,e,null,!1)}),["cols","rows","size","span"].forEach(function(e){D[e]=new B(e,6,!1,e,null,!1)}),["rowSpan","start"].forEach(function(e){D[e]=new B(e,5,!1,e.toLowerCase(),null,!1)});var sb=/[\-:]([a-z])/g;function tb(e){return e[1].toUpperCase()}function ub(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function vb(e,t,n,r){var l=D.hasOwnProperty(t)?D[t]:null;(null!==l?0===l.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(rb(t,n,l,r)&&(n=null),r||null===l?pb(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=null===n?3!==l.type&&"":n:(t=l.attributeName,r=l.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(l=l.type)||4===l&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function wb(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function xb(e){var t=wb(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var l=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yb(e){e._valueTracker||(e._valueTracker=xb(e))}function zb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=wb(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Ab(e,t){var r=t.checked;return n({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Bb(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ub(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Cb(e,t){null!=(t=t.checked)&&vb(e,"checked",t,!1)}function Eb(e,t){Cb(e,t);var n=ub(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Fb(e,t.type,n):t.hasOwnProperty("defaultValue")&&Fb(e,t.type,ub(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Gb(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Fb(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Hb(e){var t="";return aa.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}function Ib(e,t){return e=n({children:void 0},t),(t=Hb(t.children))&&(e.children=t),e}function Jb(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ub(n),t=null,l=0;l<e.length;l++){if(e[l].value===n)return e[l].selected=!0,void(r&&(e[l].defaultSelected=!0));null!==t||e[l].disabled||(t=e[l])}null!==t&&(t.selected=!0)}}function Kb(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(u(91));return n({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Lb(e,t){var n=t.value;if(null==n){if(n=t.defaultValue,null!=(t=t.children)){if(null!=n)throw Error(u(92));if(Array.isArray(t)){if(!(1>=t.length))throw Error(u(93));t=t[0]}n=t}null==n&&(n="")}e._wrapperState={initialValue:ub(n)}}function Mb(e,t){var n=ub(t.value),r=ub(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Nb(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sb,tb);D[t]=new B(t,1,!1,e,null,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sb,tb);D[t]=new B(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sb,tb);D[t]=new B(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)}),["tabIndex","crossOrigin"].forEach(function(e){D[e]=new B(e,1,!1,e.toLowerCase(),null,!1)}),D.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach(function(e){D[e]=new B(e,1,!1,e.toLowerCase(),null,!0)});var Ob={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Pb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qb(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Pb(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Rb,Sb=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if(e.namespaceURI!==Ob.svg||"innerHTML"in e)e.innerHTML=t;else{for((Rb=Rb||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Tb(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Ub(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Vb={animationend:Ub("Animation","AnimationEnd"),animationiteration:Ub("Animation","AnimationIteration"),animationstart:Ub("Animation","AnimationStart"),transitionend:Ub("Transition","TransitionEnd")},Wb={},Xb={};function Yb(e){if(Wb[e])return Wb[e];if(!Vb[e])return e;var t,n=Vb[e];for(t in n)if(n.hasOwnProperty(t)&&t in Xb)return Wb[e]=n[t];return e}Ya&&(Xb=document.createElement("div").style,"AnimationEvent"in window||(delete Vb.animationend.animation,delete Vb.animationiteration.animation,delete Vb.animationstart.animation),"TransitionEvent"in window||delete Vb.transitionend.transition);var Zb=Yb("animationend"),$b=Yb("animationiteration"),ac=Yb("animationstart"),bc=Yb("transitionend"),cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" ");function ec(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function fc(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function gc(e){if(ec(e)!==e)throw Error(u(188))}function hc(e){var t=e.alternate;if(!t){if(null===(t=ec(e)))throw Error(u(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(null===l)break;var a=l.alternate;if(null===a){if(null!==(r=l.return)){n=r;continue}break}if(l.child===a.child){for(a=l.child;a;){if(a===n)return gc(l),e;if(a===r)return gc(l),t;a=a.sibling}throw Error(u(188))}if(n.return!==r.return)n=l,r=a;else{for(var i=!1,o=l.child;o;){if(o===n){i=!0,n=l,r=a;break}if(o===r){i=!0,r=l,n=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===n){i=!0,n=a,r=l;break}if(o===r){i=!0,r=a,n=l;break}o=o.sibling}if(!i)throw Error(u(189))}}if(n.alternate!==r)throw Error(u(190))}if(3!==n.tag)throw Error(u(188));return n.stateNode.current===n?e:t}function ic(e){if(!(e=hc(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var jc,kc,lc,mc=!1,nc=[],oc=null,pc=null,qc=null,rc=new Map,sc=new Map,tc=[],uc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),vc="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function wc(e){var t=xc(e);uc.forEach(function(n){yc(n,e,t)}),vc.forEach(function(n){yc(n,e,t)})}function zc(e,t,n,r){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:r}}function Ac(e,t){switch(e){case"focus":case"blur":oc=null;break;case"dragenter":case"dragleave":pc=null;break;case"mouseover":case"mouseout":qc=null;break;case"pointerover":case"pointerout":rc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":sc.delete(t.pointerId)}}function Bc(e,t,n,r,l){return null===e||e.nativeEvent!==l?(e=zc(t,n,r,l),null!==t&&(null!==(t=Cc(t))&&kc(t)),e):(e.eventSystemFlags|=r,e)}function Dc(e,t,n,r){switch(t){case"focus":return oc=Bc(oc,e,t,n,r),!0;case"dragenter":return pc=Bc(pc,e,t,n,r),!0;case"mouseover":return qc=Bc(qc,e,t,n,r),!0;case"pointerover":var l=r.pointerId;return rc.set(l,Bc(rc.get(l)||null,e,t,n,r)),!0;case"gotpointercapture":return l=r.pointerId,sc.set(l,Bc(sc.get(l)||null,e,t,n,r)),!0}return!1}function Ec(e){var t=Fc(e.target);if(null!==t){var n=ec(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=fc(n)))return e.blockedOn=t,void q.unstable_runWithPriority(e.priority,function(){lc(n)})}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Gc(e){if(null!==e.blockedOn)return!1;var t=Hc(e.topLevelType,e.eventSystemFlags,e.nativeEvent);if(null!==t){var n=Cc(t);return null!==n&&kc(n),e.blockedOn=t,!1}return!0}function Ic(e,t,n){Gc(e)&&n.delete(t)}function Jc(){for(mc=!1;0<nc.length;){var e=nc[0];if(null!==e.blockedOn){null!==(e=Cc(e.blockedOn))&&jc(e);break}var t=Hc(e.topLevelType,e.eventSystemFlags,e.nativeEvent);null!==t?e.blockedOn=t:nc.shift()}null!==oc&&Gc(oc)&&(oc=null),null!==pc&&Gc(pc)&&(pc=null),null!==qc&&Gc(qc)&&(qc=null),rc.forEach(Ic),sc.forEach(Ic)}function Kc(e,t){e.blockedOn===t&&(e.blockedOn=null,mc||(mc=!0,q.unstable_scheduleCallback(q.unstable_NormalPriority,Jc)))}function Lc(e){function t(t){return Kc(t,e)}if(0<nc.length){Kc(nc[0],e);for(var n=1;n<nc.length;n++){var r=nc[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==oc&&Kc(oc,e),null!==pc&&Kc(pc,e),null!==qc&&Kc(qc,e),rc.forEach(t),sc.forEach(t),n=0;n<tc.length;n++)(r=tc[n]).blockedOn===e&&(r.blockedOn=null);for(;0<tc.length&&null===(n=tc[0]).blockedOn;)Ec(n),null===n.blockedOn&&tc.shift()}function Mc(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function Nc(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Oc(e,t,n){(t=Da(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=xa(n._dispatchListeners,t),n._dispatchInstances=xa(n._dispatchInstances,e))}function Pc(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Nc(t);for(t=n.length;0<t--;)Oc(n[t],"captured",e);for(t=0;t<n.length;t++)Oc(n[t],"bubbled",e)}}function Qc(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Da(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=xa(n._dispatchListeners,t),n._dispatchInstances=xa(n._dispatchInstances,e))}function Rc(e){e&&e.dispatchConfig.registrationName&&Qc(e._targetInst,null,e)}function Sc(e){ya(e,Pc)}function Tc(){return!0}function Uc(){return!1}function E(e,t,n,r){for(var l in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(l)&&((t=e[l])?this[l]=t(n):"target"===l?this.target=r:this[l]=n[l]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Tc:Uc,this.isPropagationStopped=Uc,this}function Wc(e,t,n,r){if(this.eventPool.length){var l=this.eventPool.pop();return this.call(l,e,t,n,r),l}return new this(e,t,n,r)}function Xc(e){if(!(e instanceof this))throw Error(u(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Vc(e){e.eventPool=[],e.getPooled=Wc,e.release=Xc}n(E.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Tc)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Tc)},persist:function(){this.isPersistent=Tc},isPersistent:Uc,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Uc,this._dispatchInstances=this._dispatchListeners=null}}),E.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},E.extend=function(e){function t(){}function r(){return l.apply(this,arguments)}var l=this;t.prototype=l.prototype;var a=new t;return n(a,r.prototype),r.prototype=a,r.prototype.constructor=r,r.Interface=n({},l.Interface,e),r.extend=l.extend,Vc(r),r},Vc(E);var Yc=E.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Zc=E.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$c=E.extend({view:null,detail:null}),ad=$c.extend({relatedTarget:null});function bd(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var cd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ed={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ed[e])&&!!t[e]}function hd(){return gd}for(var id=$c.extend({key:function(e){if(e.key){var t=cd[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=bd(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dd[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:hd,charCode:function(e){return"keypress"===e.type?bd(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?bd(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),jd=0,kd=0,ld=!1,md=!1,nd=$c.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:hd,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=jd;return jd=e.screenX,ld?"mousemove"===e.type?e.screenX-t:0:(ld=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=kd;return kd=e.screenY,md?"mousemove"===e.type?e.screenY-t:0:(md=!0,0)}}),od=nd.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),pd=nd.extend({dataTransfer:null}),qd=$c.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:hd}),rd=E.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),sd=nd.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),td=[["blur","blur",0],["cancel","cancel",0],["click","click",0],["close","close",0],["contextmenu","contextMenu",0],["copy","copy",0],["cut","cut",0],["auxclick","auxClick",0],["dblclick","doubleClick",0],["dragend","dragEnd",0],["dragstart","dragStart",0],["drop","drop",0],["focus","focus",0],["input","input",0],["invalid","invalid",0],["keydown","keyDown",0],["keypress","keyPress",0],["keyup","keyUp",0],["mousedown","mouseDown",0],["mouseup","mouseUp",0],["paste","paste",0],["pause","pause",0],["play","play",0],["pointercancel","pointerCancel",0],["pointerdown","pointerDown",0],["pointerup","pointerUp",0],["ratechange","rateChange",0],["reset","reset",0],["seeked","seeked",0],["submit","submit",0],["touchcancel","touchCancel",0],["touchend","touchEnd",0],["touchstart","touchStart",0],["volumechange","volumeChange",0],["drag","drag",1],["dragenter","dragEnter",1],["dragexit","dragExit",1],["dragleave","dragLeave",1],["dragover","dragOver",1],["mousemove","mouseMove",1],["mouseout","mouseOut",1],["mouseover","mouseOver",1],["pointermove","pointerMove",1],["pointerout","pointerOut",1],["pointerover","pointerOver",1],["scroll","scroll",1],["toggle","toggle",1],["touchmove","touchMove",1],["wheel","wheel",1],["abort","abort",2],[Zb,"animationEnd",2],[$b,"animationIteration",2],[ac,"animationStart",2],["canplay","canPlay",2],["canplaythrough","canPlayThrough",2],["durationchange","durationChange",2],["emptied","emptied",2],["encrypted","encrypted",2],["ended","ended",2],["error","error",2],["gotpointercapture","gotPointerCapture",2],["load","load",2],["loadeddata","loadedData",2],["loadedmetadata","loadedMetadata",2],["loadstart","loadStart",2],["lostpointercapture","lostPointerCapture",2],["playing","playing",2],["progress","progress",2],["seeking","seeking",2],["stalled","stalled",2],["suspend","suspend",2],["timeupdate","timeUpdate",2],[bc,"transitionEnd",2],["waiting","waiting",2]],ud={},vd={},wd=0;wd<td.length;wd++){var yd=td[wd],zd=yd[0],Ad=yd[1],Bd=yd[2],Cd="on"+(Ad[0].toUpperCase()+Ad.slice(1)),Dd={phasedRegistrationNames:{bubbled:Cd,captured:Cd+"Capture"},dependencies:[zd],eventPriority:Bd};ud[Ad]=Dd,vd[zd]=Dd}var Ed={eventTypes:ud,getEventPriority:function(e){return void 0!==(e=vd[e])?e.eventPriority:2},extractEvents:function(e,t,n,r){var l=vd[e];if(!l)return null;switch(e){case"keypress":if(0===bd(n))return null;case"keydown":case"keyup":e=id;break;case"blur":case"focus":e=ad;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=nd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=pd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=qd;break;case Zb:case $b:case ac:e=Yc;break;case bc:e=rd;break;case"scroll":e=$c;break;case"wheel":e=sd;break;case"copy":case"cut":case"paste":e=Zc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=od;break;default:e=E}return Sc(t=e.getPooled(l,t,n,r)),t}},Fd=q.unstable_UserBlockingPriority,Gd=q.unstable_runWithPriority,Hd=Ed.getEventPriority,Id=10,Jd=[];function Kd(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=Fc(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var l=Mc(e.nativeEvent);r=e.topLevelType;for(var a=e.nativeEvent,i=e.eventSystemFlags,u=null,o=0;o<ea.length;o++){var c=ea[o];c&&(c=c.extractEvents(r,t,a,l,i))&&(u=xa(u,c))}Ba(u)}}var Ld=!0;function F(e,t){Md(t,e,!1)}function Md(e,t,n){switch(Hd(t)){case 0:var r=Nd.bind(null,t,1);break;case 1:r=Od.bind(null,t,1);break;default:r=Pd.bind(null,t,1)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Nd(e,t,n){ib||gb();var r=Pd,l=ib;ib=!0;try{fb(r,e,t,n)}finally{(ib=l)||kb()}}function Od(e,t,n){Gd(Fd,Pd.bind(null,e,t,n))}function Qd(e,t,n,r){if(Jd.length){var l=Jd.pop();l.topLevelType=e,l.eventSystemFlags=t,l.nativeEvent=n,l.targetInst=r,e=l}else e={topLevelType:e,eventSystemFlags:t,nativeEvent:n,targetInst:r,ancestors:[]};try{if(t=Kd,n=e,jb)t(n,void 0);else{jb=!0;try{hb(t,n,void 0)}finally{jb=!1,kb()}}}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,Jd.length<Id&&Jd.push(e)}}function Pd(e,t,n){if(Ld)if(0<nc.length&&-1<uc.indexOf(e))e=zc(null,e,t,n),nc.push(e);else{var r=Hc(e,t,n);null===r?Ac(e,n):-1<uc.indexOf(e)?(e=zc(r,e,t,n),nc.push(e)):Dc(r,e,t,n)||(Ac(e,n),Qd(e,t,n,null))}}function Hc(e,t,n){var r=Mc(n);if(null!==(r=Fc(r))){var l=ec(r);if(null===l)r=null;else{var a=l.tag;if(13===a){if(null!==(r=fc(l)))return r;r=null}else if(3===a){if(l.stateNode.hydrate)return 3===l.tag?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return Qd(e,t,n,r),null}function Rd(e){if(!Ya)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}var Sd=new("function"==typeof WeakMap?WeakMap:Map);function xc(e){var t=Sd.get(e);return void 0===t&&(t=new Set,Sd.set(e,t)),t}function yc(e,t,n){if(!n.has(e)){switch(e){case"scroll":Md(t,"scroll",!0);break;case"focus":case"blur":Md(t,"focus",!0),Md(t,"blur",!0),n.add("blur"),n.add("focus");break;case"cancel":case"close":Rd(e)&&Md(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===cc.indexOf(e)&&F(e,t)}n.add(e)}}var Td={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ud=["Webkit","ms","Moz","O"];function Vd(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Td.hasOwnProperty(e)&&Td[e]?(""+t).trim():t+"px"}function Wd(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),l=Vd(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}Object.keys(Td).forEach(function(e){Ud.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Td[t]=Td[e]})});var Xd=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yd(e,t){if(t){if(Xd[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(u(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(u(60));if(!("object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML))throw Error(u(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(u(62,""))}}function Zd(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function $d(e,t){var n=xc(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=ja[t];for(var r=0;r<t.length;r++)yc(t[r],e,n)}function ae(){}function be(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function ce(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function de(e,t){var n,r=ce(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ce(r)}}function ee(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ee(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fe(){for(var e=window,t=be();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=be((e=t.contentWindow).document)}return t}function ge(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var he="$",ie="/$",je="$?",ke="$!",le=null,me=null;function ne(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function oe(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var pe="function"==typeof setTimeout?setTimeout:void 0,qe="function"==typeof clearTimeout?clearTimeout:void 0;function re(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function se(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if(n===he||n===ke||n===je){if(0===t)return e;t--}else n===ie&&t++}e=e.previousSibling}return null}var te=Math.random().toString(36).slice(2),ue="__reactInternalInstance$"+te,ve="__reactEventHandlers$"+te,we="__reactContainere$"+te;function Fc(e){var t=e[ue];if(t)return t;for(var n=e.parentNode;n;){if(t=n[we]||n[ue]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=se(e);null!==e;){if(n=e[ue])return n;e=se(e)}return t}n=(e=n).parentNode}return null}function Cc(e){return!(e=e[ue]||e[we])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xe(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(u(33))}function ye(e){return e[ve]||null}var ze=null,Ae=null,Be=null;function Ce(){if(Be)return Be;var e,t,n=Ae,r=n.length,l="value"in ze?ze.value:ze.textContent,a=l.length;for(e=0;e<r&&n[e]===l[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===l[a-t];t++);return Be=l.slice(e,1<t?1-t:void 0)}var De=E.extend({data:null}),Ee=E.extend({data:null}),Fe=[9,13,27,32],Ge=Ya&&"CompositionEvent"in window,He=null;Ya&&"documentMode"in document&&(He=document.documentMode);var Ie=Ya&&"TextEvent"in window&&!He,Je=Ya&&(!Ge||He&&8<He&&11>=He),Ke=String.fromCharCode(32),Le={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Me=!1;function Ne(e,t){switch(e){case"keyup":return-1!==Fe.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Oe(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Pe=!1;function Qe(e,t){switch(e){case"compositionend":return Oe(t);case"keypress":return 32!==t.which?null:(Me=!0,Ke);case"textInput":return(e=t.data)===Ke&&Me?null:e;default:return null}}function Re(e,t){if(Pe)return"compositionend"===e||!Ge&&Ne(e,t)?(e=Ce(),Be=Ae=ze=null,Pe=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Je&&"ko"!==t.locale?null:t.data;default:return null}}var Se={eventTypes:Le,extractEvents:function(e,t,n,r){var l;if(Ge)e:{switch(e){case"compositionstart":var a=Le.compositionStart;break e;case"compositionend":a=Le.compositionEnd;break e;case"compositionupdate":a=Le.compositionUpdate;break e}a=void 0}else Pe?Ne(e,n)&&(a=Le.compositionEnd):"keydown"===e&&229===n.keyCode&&(a=Le.compositionStart);return a?(Je&&"ko"!==n.locale&&(Pe||a!==Le.compositionStart?a===Le.compositionEnd&&Pe&&(l=Ce()):(Ae="value"in(ze=r)?ze.value:ze.textContent,Pe=!0)),a=De.getPooled(a,t,n,r),l?a.data=l:null!==(l=Oe(n))&&(a.data=l),Sc(a),l=a):l=null,(e=Ie?Qe(e,n):Re(e,n))?((t=Ee.getPooled(Le.beforeInput,t,n,r)).data=e,Sc(t)):t=null,null===l?t:null===t?l:[l,t]}},Te={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ue(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Te[e.type]:"textarea"===t}var Ve={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function We(e,t,n){return(e=E.getPooled(Ve.change,e,t,n)).type="change",cb(n),Sc(e),e}var Xe=null,Ye=null;function Ze(e){Ba(e)}function $e(e){if(zb(xe(e)))return e}function af(e,t){if("change"===e)return t}var bf=!1;function cf(){Xe&&(Xe.detachEvent("onpropertychange",df),Ye=Xe=null)}function df(e){if("value"===e.propertyName&&$e(Ye))if(e=We(Ye,e,Mc(e)),ib)Ba(e);else{ib=!0;try{eb(Ze,e)}finally{ib=!1,kb()}}}function ef(e,t,n){"focus"===e?(cf(),Ye=n,(Xe=t).attachEvent("onpropertychange",df)):"blur"===e&&cf()}function ff(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $e(Ye)}function gf(e,t){if("click"===e)return $e(t)}function hf(e,t){if("input"===e||"change"===e)return $e(t)}Ya&&(bf=Rd("input")&&(!document.documentMode||9<document.documentMode));var lf,jf={eventTypes:Ve,_isInputEventSupported:bf,extractEvents:function(e,t,n,r){var l=t?xe(t):window,a=l.nodeName&&l.nodeName.toLowerCase();if("select"===a||"input"===a&&"file"===l.type)var i=af;else if(Ue(l))if(bf)i=hf;else{i=ff;var u=ef}else(a=l.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(i=gf);if(i&&(i=i(e,t)))return We(i,n,r);u&&u(e,l,t),"blur"===e&&(e=l._wrapperState)&&e.controlled&&"number"===l.type&&Fb(l,"number",l.value)}},kf={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},mf={eventTypes:kf,extractEvents:function(e,t,n,r,l){var a="mouseover"===e||"pointerover"===e,i="mouseout"===e||"pointerout"===e;if(a&&0==(32&l)&&(n.relatedTarget||n.fromElement)||!i&&!a)return null;if(l=r.window===r?r:(l=r.ownerDocument)?l.defaultView||l.parentWindow:window,i?(i=t,null!==(t=(t=n.relatedTarget||n.toElement)?Fc(t):null)&&(t!==(a=ec(t))||5!==t.tag&&6!==t.tag)&&(t=null)):i=null,i===t)return null;if("mouseout"===e||"mouseover"===e)var u=nd,o=kf.mouseLeave,c=kf.mouseEnter,f="mouse";else"pointerout"!==e&&"pointerover"!==e||(u=od,o=kf.pointerLeave,c=kf.pointerEnter,f="pointer");if(e=null==i?l:xe(i),l=null==t?l:xe(t),(o=u.getPooled(o,i,n,r)).type=f+"leave",o.target=e,o.relatedTarget=l,(r=u.getPooled(c,t,n,r)).type=f+"enter",r.target=l,r.relatedTarget=e,f=t,(u=i)&&f)e:{for(e=f,i=0,t=c=u;t;t=Nc(t))i++;for(t=0,l=e;l;l=Nc(l))t++;for(;0<i-t;)c=Nc(c),i--;for(;0<t-i;)e=Nc(e),t--;for(;i--;){if(c===e||c===e.alternate)break e;c=Nc(c),e=Nc(e)}c=null}else c=null;for(e=c,c=[];u&&u!==e&&(null===(i=u.alternate)||i!==e);)c.push(u),u=Nc(u);for(u=[];f&&f!==e&&(null===(i=f.alternate)||i!==e);)u.push(f),f=Nc(f);for(f=0;f<c.length;f++)Qc(c[f],"bubbled",o);for(f=u.length;0<f--;)Qc(u[f],"captured",r);return n===lf?(lf=null,[o]):(lf=n,[o,r])}};function nf(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var of="function"==typeof Object.is?Object.is:nf,pf=Object.prototype.hasOwnProperty;function qf(e,t){if(of(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!pf.call(t,n[r])||!of(e[n[r]],t[n[r]]))return!1;return!0}var rf=Ya&&"documentMode"in document&&11>=document.documentMode,sf={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},tf=null,uf=null,vf=null,wf=!1;function xf(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return wf||null==tf||tf!==be(n)?null:("selectionStart"in(n=tf)&&ge(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vf&&qf(vf,n)?null:(vf=n,(e=E.getPooled(sf.select,uf,e,t)).type="select",e.target=tf,Sc(e),e))}var yf={eventTypes:sf,extractEvents:function(e,t,n,r){var l,a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(l=!a)){e:{a=xc(a),l=ja.onSelect;for(var i=0;i<l.length;i++)if(!a.has(l[i])){a=!1;break e}a=!0}l=!a}if(l)return null;switch(a=t?xe(t):window,e){case"focus":(Ue(a)||"true"===a.contentEditable)&&(tf=a,uf=t,vf=null);break;case"blur":vf=uf=tf=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":return wf=!1,xf(n,r);case"selectionchange":if(rf)break;case"keydown":case"keyup":return xf(n,r)}return null}};Ca.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));var zf=Cc;sa=ye,ua=zf,va=xe,Ca.injectEventPluginsByName({SimpleEventPlugin:Ed,EnterLeaveEventPlugin:mf,ChangeEventPlugin:jf,SelectEventPlugin:yf,BeforeInputEventPlugin:Se}),new Set;var Af=[],Bf=-1;function G(e){0>Bf||(e.current=Af[Bf],Af[Bf]=null,Bf--)}function I(e,t){Af[++Bf]=e.current,e.current=t}var Cf={},J={current:Cf},K={current:!1},Df=Cf;function Ef(e,t){var n=e.type.contextTypes;if(!n)return Cf;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l,a={};for(l in n)a[l]=t[l];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function L(e){return null!=(e=e.childContextTypes)}function Ff(e){G(K,e),G(J,e)}function Gf(e){G(K,e),G(J,e)}function Hf(e,t,n){if(J.current!==Cf)throw Error(u(168));I(J,t,e),I(K,n,e)}function If(e,t,r){var l=e.stateNode;if(e=t.childContextTypes,"function"!=typeof l.getChildContext)return r;for(var a in l=l.getChildContext())if(!(a in e))throw Error(u(108,Wa(t)||"Unknown",a));return n({},r,{},l)}function Jf(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||Cf,Df=J.current,I(J,t,e),I(K,K.current,e),!0}function Kf(e,t,n){var r=e.stateNode;if(!r)throw Error(u(169));n?(t=If(e,t,Df),r.__reactInternalMemoizedMergedChildContext=t,G(K,e),G(J,e),I(J,t,e)):G(K,e),I(K,n,e)}var Lf=q.unstable_runWithPriority,Mf=q.unstable_scheduleCallback,Nf=q.unstable_cancelCallback,Of=q.unstable_shouldYield,Pf=q.unstable_requestPaint,Qf=q.unstable_now,Rf=q.unstable_getCurrentPriorityLevel,Sf=q.unstable_ImmediatePriority,Tf=q.unstable_UserBlockingPriority,Uf=q.unstable_NormalPriority,Vf=q.unstable_LowPriority,Wf=q.unstable_IdlePriority,Xf={},Yf=void 0!==Pf?Pf:function(){},Zf=null,$f=null,ag=!1,bg=Qf(),cg=1e4>bg?Qf:function(){return Qf()-bg};function dg(){switch(Rf()){case Sf:return 99;case Tf:return 98;case Uf:return 97;case Vf:return 96;case Wf:return 95;default:throw Error(u(332))}}function eg(e){switch(e){case 99:return Sf;case 98:return Tf;case 97:return Uf;case 96:return Vf;case 95:return Wf;default:throw Error(u(332))}}function fg(e,t){return e=eg(e),Lf(e,t)}function gg(e,t,n){return e=eg(e),Mf(e,t,n)}function hg(e){return null===Zf?(Zf=[e],$f=Mf(Sf,ig)):Zf.push(e),Xf}function jg(){if(null!==$f){var e=$f;$f=null,Nf(e)}ig()}function ig(){if(!ag&&null!==Zf){ag=!0;var e=0;try{var t=Zf;fg(99,function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}}),Zf=null}catch(t){throw null!==Zf&&(Zf=Zf.slice(e+1)),Mf(Sf,jg),t}finally{ag=!1}}}var kg=3;function lg(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function mg(e,t){if(e&&e.defaultProps)for(var r in t=n({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}var ng={current:null},og=null,pg=null,qg=null;function rg(){qg=pg=og=null}function sg(e,t){var n=e.type._context;I(ng,n._currentValue,e),n._currentValue=t}function tg(e){var t=ng.current;G(ng,e),e.type._context._currentValue=t}function ug(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function vg(e,t){og=e,qg=pg=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(wg=!0),e.firstContext=null)}function xg(e,t){if(qg!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(qg=e,t=1073741823),t={context:e,observedBits:t,next:null},null===pg){if(null===og)throw Error(u(308));pg=t,og.dependencies={expirationTime:0,firstContext:t,responders:null}}else pg=pg.next=t;return e._currentValue}var yg=!1;function zg(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Ag(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Bg(e,t){return{expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Cg(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function Dg(e,t){var n=e.alternate;if(null===n){var r=e.updateQueue,l=null;null===r&&(r=e.updateQueue=zg(e.memoizedState))}else r=e.updateQueue,l=n.updateQueue,null===r?null===l?(r=e.updateQueue=zg(e.memoizedState),l=n.updateQueue=zg(n.memoizedState)):r=e.updateQueue=Ag(l):null===l&&(l=n.updateQueue=Ag(r));null===l||r===l?Cg(r,t):null===r.lastUpdate||null===l.lastUpdate?(Cg(r,t),Cg(l,t)):(Cg(r,t),l.lastUpdate=t)}function Eg(e,t){var n=e.updateQueue;null===(n=null===n?e.updateQueue=zg(e.memoizedState):Fg(e,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=t:(n.lastCapturedUpdate.next=t,n.lastCapturedUpdate=t)}function Fg(e,t){var n=e.alternate;return null!==n&&t===n.updateQueue&&(t=e.updateQueue=Ag(t)),t}function Gg(e,t,r,l,a,i){switch(r.tag){case 1:return"function"==typeof(e=r.payload)?e.call(i,l,a):e;case 3:e.effectTag=-4097&e.effectTag|64;case 0:if(null==(a="function"==typeof(e=r.payload)?e.call(i,l,a):e))break;return n({},l,a);case 2:yg=!0}return l}function Hg(e,t,n,r,l){yg=!1;for(var a=(t=Fg(e,t)).baseState,i=null,u=0,o=t.firstUpdate,c=a;null!==o;){var f=o.expirationTime;f<l?(null===i&&(i=o,a=c),u<f&&(u=f)):(Ig(f,o.suspenseConfig),c=Gg(e,t,o,c,n,r),null!==o.callback&&(e.effectTag|=32,o.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=o:(t.lastEffect.nextEffect=o,t.lastEffect=o))),o=o.next}for(f=null,o=t.firstCapturedUpdate;null!==o;){var s=o.expirationTime;s<l?(null===f&&(f=o,null===i&&(a=c)),u<s&&(u=s)):(c=Gg(e,t,o,c,n,r),null!==o.callback&&(e.effectTag|=32,o.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=o:(t.lastCapturedEffect.nextEffect=o,t.lastCapturedEffect=o))),o=o.next}null===i&&(t.lastUpdate=null),null===f?t.lastCapturedUpdate=null:e.effectTag|=32,null===i&&null===f&&(a=c),t.baseState=a,t.firstUpdate=i,t.firstCapturedUpdate=f,Jg(u),e.expirationTime=u,e.memoizedState=c}function Kg(e,t,n){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),Lg(t.firstEffect,n),t.firstEffect=t.lastEffect=null,Lg(t.firstCapturedEffect,n),t.firstCapturedEffect=t.lastCapturedEffect=null}function Lg(e,t){for(;null!==e;){var n=e.callback;if(null!==n){e.callback=null;var r=t;if("function"!=typeof n)throw Error(u(191,n));n.call(r)}e=e.nextEffect}}var Mg=Ea.ReactCurrentBatchConfig,Ng=(new aa.Component).refs;function Og(e,t,r,l){r=null==(r=r(l,t=e.memoizedState))?t:n({},t,r),e.memoizedState=r,null!==(l=e.updateQueue)&&0===e.expirationTime&&(l.baseState=r)}var Sg={isMounted:function(e){return!!(e=e._reactInternalFiber)&&ec(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=Pg(),l=Mg.suspense;(l=Bg(r=Qg(r,e,l),l)).payload=t,null!=n&&(l.callback=n),Dg(e,l),Rg(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=Pg(),l=Mg.suspense;(l=Bg(r=Qg(r,e,l),l)).tag=1,l.payload=t,null!=n&&(l.callback=n),Dg(e,l),Rg(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=Pg(),r=Mg.suspense;(r=Bg(n=Qg(n,e,r),r)).tag=2,null!=t&&(r.callback=t),Dg(e,r),Rg(e,n)}};function Tg(e,t,n,r,l,a,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!qf(n,r)||!qf(l,a))}function Ug(e,t,n){var r=!1,l=Cf,a=t.contextType;return"object"==typeof a&&null!==a?a=xg(a):(l=L(t)?Df:J.current,a=(r=null!=(r=t.contextTypes))?Ef(e,l):Cf),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Sg,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=a),t}function Vg(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Sg.enqueueReplaceState(t,t.state,null)}function Wg(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs=Ng;var a=t.contextType;"object"==typeof a&&null!==a?l.context=xg(a):(a=L(t)?Df:J.current,l.context=Ef(e,a)),null!==(a=e.updateQueue)&&(Hg(e,a,n,l,r),l.state=e.memoizedState),"function"==typeof(a=t.getDerivedStateFromProps)&&(Og(e,t,a,n),l.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof l.getSnapshotBeforeUpdate||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||(t=l.state,"function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount(),t!==l.state&&Sg.enqueueReplaceState(l,l.state,null),null!==(a=e.updateQueue)&&(Hg(e,a,n,l,r),l.state=e.memoizedState)),"function"==typeof l.componentDidMount&&(e.effectTag|=4)}var Xg=Array.isArray;function Yg(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(u(309));var r=n.stateNode}if(!r)throw Error(u(147,e));var l=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===l?t.ref:((t=function(e){var t=r.refs;t===Ng&&(t=r.refs={}),null===e?delete t[l]:t[l]=e})._stringRef=l,t)}if("string"!=typeof e)throw Error(u(284));if(!n._owner)throw Error(u(290,e))}return e}function Zg(e,t){if("textarea"!==e.type)throw Error(u(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function $g(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function l(e,t,n){return(e=ah(e,t,n)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function i(t){return e&&null===t.alternate&&(t.effectTag=2),t}function o(e,t,n,r){return null===t||6!==t.tag?((t=bh(n,e.mode,r)).return=e,t):((t=l(t,n,r)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=l(t,n.props,r)).ref=Yg(e,t,n),r.return=e,r):((r=ch(n.type,n.key,n.props,null,e.mode,r)).ref=Yg(e,t,n),r.return=e,r)}function f(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=dh(n,e.mode,r)).return=e,t):((t=l(t,n.children||[],r)).return=e,t)}function s(e,t,n,r,a){return null===t||7!==t.tag?((t=eh(n,e.mode,r,a)).return=e,t):((t=l(t,n,r)).return=e,t)}function d(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=bh(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Ga:return(n=ch(t.type,t.key,t.props,null,e.mode,n)).ref=Yg(e,null,t),n.return=e,n;case Ha:return(t=dh(t,e.mode,n)).return=e,t}if(Xg(t)||Ua(t))return(t=eh(t,e.mode,n,null)).return=e,t;Zg(e,t)}return null}function p(e,t,n,r){var l=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==l?null:o(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Ga:return n.key===l?n.type===Ia?s(e,t,n.props.children,r,l):c(e,t,n,r):null;case Ha:return n.key===l?f(e,t,n,r):null}if(Xg(n)||Ua(n))return null!==l?null:s(e,t,n,r,null);Zg(e,n)}return null}function h(e,t,n,r,l){if("string"==typeof r||"number"==typeof r)return o(t,e=e.get(n)||null,""+r,l);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Ga:return e=e.get(null===r.key?n:r.key)||null,r.type===Ia?s(t,e,r.props.children,l,r.key):c(t,e,r,l);case Ha:return f(t,e=e.get(null===r.key?n:r.key)||null,r,l)}if(Xg(r)||Ua(r))return s(t,e=e.get(n)||null,r,l,null);Zg(t,r)}return null}function g(l,i,u,o){for(var c=null,f=null,s=i,g=i=0,m=null;null!==s&&g<u.length;g++){s.index>g?(m=s,s=null):m=s.sibling;var b=p(l,s,u[g],o);if(null===b){null===s&&(s=m);break}e&&s&&null===b.alternate&&t(l,s),i=a(b,i,g),null===f?c=b:f.sibling=b,f=b,s=m}if(g===u.length)return n(l,s),c;if(null===s){for(;g<u.length;g++)null!==(s=d(l,u[g],o))&&(i=a(s,i,g),null===f?c=s:f.sibling=s,f=s);return c}for(s=r(l,s);g<u.length;g++)null!==(m=h(s,l,g,u[g],o))&&(e&&null!==m.alternate&&s.delete(null===m.key?g:m.key),i=a(m,i,g),null===f?c=m:f.sibling=m,f=m);return e&&s.forEach(function(e){return t(l,e)}),c}function m(l,i,o,c){var f=Ua(o);if("function"!=typeof f)throw Error(u(150));if(null==(o=f.call(o)))throw Error(u(151));for(var s=f=null,g=i,m=i=0,b=null,v=o.next();null!==g&&!v.done;m++,v=o.next()){g.index>m?(b=g,g=null):b=g.sibling;var y=p(l,g,v.value,c);if(null===y){null===g&&(g=b);break}e&&g&&null===y.alternate&&t(l,g),i=a(y,i,m),null===s?f=y:s.sibling=y,s=y,g=b}if(v.done)return n(l,g),f;if(null===g){for(;!v.done;m++,v=o.next())null!==(v=d(l,v.value,c))&&(i=a(v,i,m),null===s?f=v:s.sibling=v,s=v);return f}for(g=r(l,g);!v.done;m++,v=o.next())null!==(v=h(g,l,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),i=a(v,i,m),null===s?f=v:s.sibling=v,s=v);return e&&g.forEach(function(e){return t(l,e)}),f}return function(e,r,a,o){var c="object"==typeof a&&null!==a&&a.type===Ia&&null===a.key;c&&(a=a.props.children);var f="object"==typeof a&&null!==a;if(f)switch(a.$$typeof){case Ga:e:{for(f=a.key,c=r;null!==c;){if(c.key===f){if(7===c.tag?a.type===Ia:c.elementType===a.type){n(e,c.sibling),(r=l(c,a.type===Ia?a.props.children:a.props,o)).ref=Yg(e,c,a),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}a.type===Ia?((r=eh(a.props.children,e.mode,o,a.key)).return=e,e=r):((o=ch(a.type,a.key,a.props,null,e.mode,o)).ref=Yg(e,r,a),o.return=e,e=o)}return i(e);case Ha:e:{for(c=a.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=l(r,a.children||[],o)).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=dh(a,e.mode,o)).return=e,e=r}return i(e)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=l(r,a,o)).return=e,e=r):(n(e,r),(r=bh(a,e.mode,o)).return=e,e=r),i(e);if(Xg(a))return g(e,r,a,o);if(Ua(a))return m(e,r,a,o);if(f&&Zg(e,a),void 0===a&&!c)switch(e.tag){case 1:case 0:throw e=e.type,Error(u(152,e.displayName||e.name||"Component"))}return n(e,r)}}var fh=$g(!0),gh=$g(!1),hh={},ih={current:hh},jh={current:hh},kh={current:hh};function lh(e){if(e===hh)throw Error(u(174));return e}function mh(e,t){I(kh,t,e),I(jh,e,e),I(ih,hh,e);var n=t.nodeType;switch(n){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qb(null,"");break;default:t=Qb(t=(n=8===n?t.parentNode:t).namespaceURI||null,n=n.tagName)}G(ih,e),I(ih,t,e)}function nh(e){G(ih,e),G(jh,e),G(kh,e)}function oh(e){lh(kh.current);var t=lh(ih.current),n=Qb(t,e.type);t!==n&&(I(jh,e,e),I(ih,n,e))}function ph(e){jh.current===e&&(G(ih,e),G(jh,e))}var M={current:0};function qh(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===je||n.data===ke))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function rh(e,t){return{responder:e,props:t}}var sh=Ea.ReactCurrentDispatcher,N=Ea.ReactCurrentBatchConfig,th=0,uh=null,O=null,vh=null,wh=null,P=null,xh=null,yh=0,zh=null,Ah=0,Bh=!1,Ch=null,Gh=0;function Q(){throw Error(u(321))}function Hh(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!of(e[n],t[n]))return!1;return!0}function Ih(e,t,n,r,l,a){if(th=a,uh=t,vh=null!==e?e.memoizedState:null,sh.current=null===vh?Jh:Kh,t=n(r,l),Bh){do{Bh=!1,Gh+=1,vh=null!==e?e.memoizedState:null,xh=wh,zh=P=O=null,sh.current=Kh,t=n(r,l)}while(Bh);Ch=null,Gh=0}if(sh.current=Lh,(e=uh).memoizedState=wh,e.expirationTime=yh,e.updateQueue=zh,e.effectTag|=Ah,e=null!==O&&null!==O.next,th=0,xh=P=wh=vh=O=uh=null,yh=0,zh=null,Ah=0,e)throw Error(u(300));return t}function Mh(){sh.current=Lh,th=0,xh=P=wh=vh=O=uh=null,yh=0,zh=null,Ah=0,Bh=!1,Ch=null,Gh=0}function Nh(){var e={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};return null===P?wh=P=e:P=P.next=e,P}function Oh(){if(null!==xh)xh=(P=xh).next,vh=null!==(O=vh)?O.next:null;else{if(null===vh)throw Error(u(310));var e={memoizedState:(O=vh).memoizedState,baseState:O.baseState,queue:O.queue,baseUpdate:O.baseUpdate,next:null};P=null===P?wh=e:P.next=e,vh=O.next}return P}function Ph(e,t){return"function"==typeof t?t(e):t}function Qh(e){var t=Oh(),n=t.queue;if(null===n)throw Error(u(311));if(n.lastRenderedReducer=e,0<Gh){var r=n.dispatch;if(null!==Ch){var l=Ch.get(n);if(void 0!==l){Ch.delete(n);var a=t.memoizedState;do{a=e(a,l.action),l=l.next}while(null!==l);return of(a,t.memoizedState)||(wg=!0),t.memoizedState=a,t.baseUpdate===n.last&&(t.baseState=a),n.lastRenderedState=a,[a,r]}}return[t.memoizedState,r]}r=n.last;var i=t.baseUpdate;if(a=t.baseState,null!==i?(null!==r&&(r.next=null),r=i.next):r=null!==r?r.next:null,null!==r){var o=l=null,c=r,f=!1;do{var s=c.expirationTime;s<th?(f||(f=!0,o=i,l=a),s>yh&&Jg(yh=s)):(Ig(s,c.suspenseConfig),a=c.eagerReducer===e?c.eagerState:e(a,c.action)),i=c,c=c.next}while(null!==c&&c!==r);f||(o=i,l=a),of(a,t.memoizedState)||(wg=!0),t.memoizedState=a,t.baseUpdate=o,t.baseState=l,n.lastRenderedState=a}return[t.memoizedState,n.dispatch]}function Rh(e){var t=Nh();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={last:null,dispatch:null,lastRenderedReducer:Ph,lastRenderedState:e}).dispatch=Sh.bind(null,uh,e),[t.memoizedState,e]}function Th(e){return Qh(Ph,e)}function Uh(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===zh?(zh={lastEffect:null}).lastEffect=e.next=e:null===(t=zh.lastEffect)?zh.lastEffect=e.next=e:(n=t.next,t.next=e,e.next=n,zh.lastEffect=e),e}function Vh(e,t,n,r){var l=Nh();Ah|=e,l.memoizedState=Uh(t,n,void 0,void 0===r?null:r)}function Wh(e,t,n,r){var l=Oh();r=void 0===r?null:r;var a=void 0;if(null!==O){var i=O.memoizedState;if(a=i.destroy,null!==r&&Hh(r,i.deps))return void Uh(0,n,a,r)}Ah|=e,l.memoizedState=Uh(t,n,a,r)}function Xh(e,t){return Vh(516,192,e,t)}function Yh(e,t){return Wh(516,192,e,t)}function Zh(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function $h(){}function ai(e,t){return Nh().memoizedState=[e,void 0===t?null:t],e}function bi(e,t){var n=Oh();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Hh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Sh(e,t,n){if(!(25>Gh))throw Error(u(301));var r=e.alternate;if(e===uh||null!==r&&r===uh)if(Bh=!0,e={expirationTime:th,suspenseConfig:null,action:n,eagerReducer:null,eagerState:null,next:null},null===Ch&&(Ch=new Map),void 0===(n=Ch.get(t)))Ch.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}else{var l=Pg(),a=Mg.suspense;a={expirationTime:l=Qg(l,e,a),suspenseConfig:a,action:n,eagerReducer:null,eagerState:null,next:null};var i=t.last;if(null===i)a.next=a;else{var o=i.next;null!==o&&(a.next=o),i.next=a}if(t.last=a,0===e.expirationTime&&(null===r||0===r.expirationTime)&&null!==(r=t.lastRenderedReducer))try{var c=t.lastRenderedState,f=r(c,n);if(a.eagerReducer=r,a.eagerState=f,of(f,c))return}catch(e){}Rg(e,l)}}var Lh={readContext:xg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useResponder:Q,useDeferredValue:Q,useTransition:Q},Jh={readContext:xg,useCallback:ai,useContext:xg,useEffect:Xh,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Vh(4,36,Zh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vh(4,36,e,t)},useMemo:function(e,t){var n=Nh();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Nh();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={last:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Sh.bind(null,uh,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Nh().memoizedState=e},useState:Rh,useDebugValue:$h,useResponder:rh,useDeferredValue:function(e,t){var n=Rh(e),r=n[0],l=n[1];return Xh(function(){q.unstable_next(function(){var n=N.suspense;N.suspense=void 0===t?null:t;try{l(e)}finally{N.suspense=n}})},[e,t]),r},useTransition:function(e){var t=Rh(!1),n=t[0],r=t[1];return[ai(function(t){r(!0),q.unstable_next(function(){var n=N.suspense;N.suspense=void 0===e?null:e;try{r(!1),t()}finally{N.suspense=n}})},[e,n]),n]}},Kh={readContext:xg,useCallback:bi,useContext:xg,useEffect:Yh,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Wh(4,36,Zh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wh(4,36,e,t)},useMemo:function(e,t){var n=Oh();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Hh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)},useReducer:Qh,useRef:function(){return Oh().memoizedState},useState:Th,useDebugValue:$h,useResponder:rh,useDeferredValue:function(e,t){var n=Th(e),r=n[0],l=n[1];return Yh(function(){q.unstable_next(function(){var n=N.suspense;N.suspense=void 0===t?null:t;try{l(e)}finally{N.suspense=n}})},[e,t]),r},useTransition:function(e){var t=Th(!1),n=t[0],r=t[1];return[bi(function(t){r(!0),q.unstable_next(function(){var n=N.suspense;N.suspense=void 0===e?null:e;try{r(!1),t()}finally{N.suspense=n}})},[e,n]),n]}},ci=null,di=null,ei=!1;function fi(e,t){var n=gi(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function hi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function ii(e){if(ei){var t=di;if(t){var n=t;if(!hi(e,t)){if(!(t=re(n.nextSibling))||!hi(e,t))return e.effectTag=-1025&e.effectTag|2,ei=!1,void(ci=e);fi(ci,n)}ci=e,di=re(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,ei=!1,ci=e}}function ji(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ci=e}function ki(e){if(e!==ci)return!1;if(!ei)return ji(e),ei=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!oe(t,e.memoizedProps))for(t=di;t;)fi(e,t),t=re(t.nextSibling);if(ji(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(u(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if(n===ie){if(0===t){di=re(e.nextSibling);break e}t--}else n!==he&&n!==ke&&n!==je||t++}e=e.nextSibling}di=null}}else di=ci?re(e.stateNode.nextSibling):null;return!0}function li(){di=ci=null,ei=!1}var mi=Ea.ReactCurrentOwner,wg=!1;function R(e,t,n,r){t.child=null===e?gh(t,null,n,r):fh(t,e.child,n,r)}function ni(e,t,n,r,l){n=n.render;var a=t.ref;return vg(t,l),r=Ih(e,t,n,r,a,l),null===e||wg?(t.effectTag|=1,R(e,t,r,l),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=l&&(e.expirationTime=0),oi(e,t,l))}function pi(e,t,n,r,l,a){if(null===e){var i=n.type;return"function"!=typeof i||qi(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ch(n.type,null,r,null,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ri(e,t,i,r,l,a))}return i=e.child,l<a&&(l=i.memoizedProps,(n=null!==(n=n.compare)?n:qf)(l,r)&&e.ref===t.ref)?oi(e,t,a):(t.effectTag|=1,(e=ah(i,r,a)).ref=t.ref,e.return=t,t.child=e)}function ri(e,t,n,r,l,a){return null!==e&&qf(e.memoizedProps,r)&&e.ref===t.ref&&(wg=!1,l<a)?oi(e,t,a):si(e,t,n,r,a)}function ti(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function si(e,t,n,r,l){var a=L(n)?Df:J.current;return a=Ef(t,a),vg(t,l),n=Ih(e,t,n,r,a,l),null===e||wg?(t.effectTag|=1,R(e,t,n,l),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=l&&(e.expirationTime=0),oi(e,t,l))}function ui(e,t,n,r,l){if(L(n)){var a=!0;Jf(t)}else a=!1;if(vg(t,l),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),Ug(t,n,r,l),Wg(t,n,r,l),r=!0;else if(null===e){var i=t.stateNode,u=t.memoizedProps;i.props=u;var o=i.context,c=n.contextType;"object"==typeof c&&null!==c?c=xg(c):c=Ef(t,c=L(n)?Df:J.current);var f=n.getDerivedStateFromProps,s="function"==typeof f||"function"==typeof i.getSnapshotBeforeUpdate;s||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(u!==r||o!==c)&&Vg(t,i,r,c),yg=!1;var d=t.memoizedState;o=i.state=d;var p=t.updateQueue;null!==p&&(Hg(t,p,r,i,l),o=t.memoizedState),u!==r||d!==o||K.current||yg?("function"==typeof f&&(Og(t,n,f,r),o=t.memoizedState),(u=yg||Tg(t,n,u,r,d,o,c))?(s||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.effectTag|=4)):("function"==typeof i.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=o),i.props=r,i.state=o,i.context=c,r=u):("function"==typeof i.componentDidMount&&(t.effectTag|=4),r=!1)}else i=t.stateNode,u=t.memoizedProps,i.props=t.type===t.elementType?u:mg(t.type,u),o=i.context,"object"==typeof(c=n.contextType)&&null!==c?c=xg(c):c=Ef(t,c=L(n)?Df:J.current),(s="function"==typeof(f=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(u!==r||o!==c)&&Vg(t,i,r,c),yg=!1,o=t.memoizedState,d=i.state=o,null!==(p=t.updateQueue)&&(Hg(t,p,r,i,l),d=t.memoizedState),u!==r||o!==d||K.current||yg?("function"==typeof f&&(Og(t,n,f,r),d=t.memoizedState),(f=yg||Tg(t,n,u,r,o,d,c))?(s||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,d,c),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,d,c)),"function"==typeof i.componentDidUpdate&&(t.effectTag|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof i.componentDidUpdate||u===e.memoizedProps&&o===e.memoizedState||(t.effectTag|=4),"function"!=typeof i.getSnapshotBeforeUpdate||u===e.memoizedProps&&o===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=d),i.props=r,i.state=d,i.context=c,r=f):("function"!=typeof i.componentDidUpdate||u===e.memoizedProps&&o===e.memoizedState||(t.effectTag|=4),"function"!=typeof i.getSnapshotBeforeUpdate||u===e.memoizedProps&&o===e.memoizedState||(t.effectTag|=256),r=!1);return vi(e,t,n,r,a,l)}function vi(e,t,n,r,l,a){ti(e,t);var i=0!=(64&t.effectTag);if(!r&&!i)return l&&Kf(t,n,!1),oi(e,t,a);r=t.stateNode,mi.current=t;var u=i&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&i?(t.child=fh(t,e.child,null,a),t.child=fh(t,null,u,a)):R(e,t,u,a),t.memoizedState=r.state,l&&Kf(t,n,!0),t.child}function wi(e){var t=e.stateNode;t.pendingContext?Hf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hf(e,t.context,!1),mh(e,t.containerInfo)}var Hi,Ii,Ji,Ki,xi={dehydrated:null,retryTime:0};function yi(e,t,n){var r,l=t.mode,a=t.pendingProps,i=M.current,u=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&i)&&(null===e||null!==e.memoizedState)),r?(u=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1),I(M,1&i,t),null===e){if(void 0!==a.fallback&&ii(t),u){if(u=a.fallback,(a=eh(null,l,0,null)).return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;return(n=eh(u,l,n,null)).return=t,a.sibling=n,t.memoizedState=xi,t.child=a,n}return l=a.children,t.memoizedState=null,t.child=gh(t,null,l,n)}if(null!==e.memoizedState){if(l=(e=e.child).sibling,u){if(a=a.fallback,(n=ah(e,e.pendingProps,0)).return=t,0==(2&t.mode)&&(u=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=u;null!==u;)u.return=n,u=u.sibling;return(l=ah(l,a,l.expirationTime)).return=t,n.sibling=l,n.childExpirationTime=0,t.memoizedState=xi,t.child=n,l}return n=fh(t,e.child,a.children,n),t.memoizedState=null,t.child=n}if(e=e.child,u){if(u=a.fallback,(a=eh(null,l,0,null)).return=t,a.child=e,null!==e&&(e.return=a),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;return(n=eh(u,l,n,null)).return=t,a.sibling=n,n.effectTag|=2,a.childExpirationTime=0,t.memoizedState=xi,t.child=a,n}return t.memoizedState=null,t.child=fh(t,e,a.children,n)}function zi(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),ug(e.return,t)}function Ai(e,t,n,r,l,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,last:r,tail:n,tailExpiration:0,tailMode:l,lastEffect:a}:(i.isBackwards=t,i.rendering=null,i.last=r,i.tail=n,i.tailExpiration=0,i.tailMode=l,i.lastEffect=a)}function Bi(e,t,n){var r=t.pendingProps,l=r.revealOrder,a=r.tail;if(R(e,t,r.children,n),0!=(2&(r=M.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,n);else if(19===e.tag)zi(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(I(M,r,t),0==(2&t.mode))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;null!==n;)null!==(e=n.alternate)&&null===qh(e)&&(l=n),n=n.sibling;null===(n=l)?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Ai(t,!1,l,n,a,t.lastEffect);break;case"backwards":for(n=null,l=t.child,t.child=null;null!==l;){if(null!==(e=l.alternate)&&null===qh(e)){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Ai(t,!0,n,null,a,t.lastEffect);break;case"together":Ai(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function oi(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&Jg(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(u(153));if(null!==t.child){for(n=ah(e=t.child,e.pendingProps,e.expirationTime),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ah(e,e.pendingProps,e.expirationTime)).return=t;n.sibling=null}return t.child}function Ci(e){e.effectTag|=4}function Li(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Mi(e){switch(e.tag){case 1:L(e.type)&&Ff(e);var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(nh(e),Gf(e),0!=(64&(t=e.effectTag)))throw Error(u(285));return e.effectTag=-4097&t|64,e;case 5:return ph(e),null;case 13:return G(M,e),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return G(M,e),null;case 4:return nh(e),null;case 10:return tg(e),null;default:return null}}function Ni(e,t){return{value:e,source:t,stack:Xa(t)}}Hi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ii=function(){},Ji=function(e,t,r,l,a){var i=e.memoizedProps;if(i!==l){var u,o,c=t.stateNode;switch(lh(ih.current),e=null,r){case"input":i=Ab(c,i),l=Ab(c,l),e=[];break;case"option":i=Ib(c,i),l=Ib(c,l),e=[];break;case"select":i=n({},i,{value:void 0}),l=n({},l,{value:void 0}),e=[];break;case"textarea":i=Kb(c,i),l=Kb(c,l),e=[];break;default:"function"!=typeof i.onClick&&"function"==typeof l.onClick&&(c.onclick=ae)}for(u in Yd(r,l),r=null,i)if(!l.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u)for(o in c=i[u])c.hasOwnProperty(o)&&(r||(r={}),r[o]="");else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(ia.hasOwnProperty(u)?e||(e=[]):(e=e||[]).push(u,null));for(u in l){var f=l[u];if(c=null!=i?i[u]:void 0,l.hasOwnProperty(u)&&f!==c&&(null!=f||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||f&&f.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in f)f.hasOwnProperty(o)&&c[o]!==f[o]&&(r||(r={}),r[o]=f[o])}else r||(e||(e=[]),e.push(u,r)),r=f;else"dangerouslySetInnerHTML"===u?(f=f?f.__html:void 0,c=c?c.__html:void 0,null!=f&&c!==f&&(e=e||[]).push(u,""+f)):"children"===u?c===f||"string"!=typeof f&&"number"!=typeof f||(e=e||[]).push(u,""+f):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(ia.hasOwnProperty(u)?(null!=f&&$d(a,u),e||c===f||(e=[])):(e=e||[]).push(u,f))}r&&(e=e||[]).push("style",r),a=e,(t.updateQueue=a)&&Ci(t)}},Ki=function(e,t,n,r){n!==r&&Ci(t)};var Oi="function"==typeof WeakSet?WeakSet:Set;function Pi(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=Xa(n)),null!==n&&Wa(n.type),t=t.value,null!==e&&1===e.tag&&Wa(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function Qi(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Ri(e,t)}}function Si(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Ri(e,t)}else t.current=null}function Ti(e,t){switch(t.tag){case 0:case 11:case 15:Ui(2,0,t);break;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:mg(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}break;case 3:case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}function Ui(e,t,n){if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var r=n=n.next;do{if(0!=(r.tag&e)){var l=r.destroy;r.destroy=void 0,void 0!==l&&l()}0!=(r.tag&t)&&(l=r.create,r.destroy=l()),r=r.next}while(r!==n)}}function Vi(e,t,n){switch("function"==typeof Wi&&Wi(t),t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;fg(97<n?97:n,function(){var e=r;do{var n=e.destroy;if(void 0!==n){var l=t;try{n()}catch(e){Ri(l,e)}}e=e.next}while(e!==r)})}break;case 1:Si(t),"function"==typeof(n=t.stateNode).componentWillUnmount&&Qi(t,n);break;case 5:Si(t);break;case 4:Xi(e,t,n)}}function Yi(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,null!==t&&Yi(t)}function Zi(e){return 5===e.tag||3===e.tag||4===e.tag}function $i(e){e:{for(var t=e.return;null!==t;){if(Zi(t)){var n=t;break e}t=t.return}throw Error(u(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(u(161))}16&n.effectTag&&(Tb(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Zi(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}for(var l=e;;){var a=5===l.tag||6===l.tag;if(a){var i=a?l.stateNode:l.stateNode.instance;if(n)if(r){var o=i;i=n,8===(a=t).nodeType?a.parentNode.insertBefore(o,i):a.insertBefore(o,i)}else t.insertBefore(i,n);else r?(8===(o=t).nodeType?(a=o.parentNode).insertBefore(i,o):(a=o).appendChild(i),null!=(o=o._reactRootContainer)||null!==a.onclick||(a.onclick=ae)):t.appendChild(i)}else if(4!==l.tag&&null!==l.child){l.child.return=l,l=l.child;continue}if(l===e)break;for(;null===l.sibling;){if(null===l.return||l.return===e)return;l=l.return}l.sibling.return=l.return,l=l.sibling}}function Xi(e,t,n){for(var r,l,a=t,i=!1;;){if(!i){i=a.return;e:for(;;){if(null===i)throw Error(u(160));switch(r=i.stateNode,i.tag){case 5:l=!1;break e;case 3:case 4:r=r.containerInfo,l=!0;break e}i=i.return}i=!0}if(5===a.tag||6===a.tag){e:for(var o=e,c=a,f=n,s=c;;)if(Vi(o,s,f),null!==s.child&&4!==s.tag)s.child.return=s,s=s.child;else{if(s===c)break;for(;null===s.sibling;){if(null===s.return||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}l?(o=r,c=a.stateNode,8===o.nodeType?o.parentNode.removeChild(c):o.removeChild(c)):r.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){r=a.stateNode.containerInfo,l=!0,a.child.return=a,a=a.child;continue}}else if(Vi(e,a,n),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(i=!1)}a.sibling.return=a.return,a=a.sibling}}function aj(e,t){switch(t.tag){case 0:case 11:case 14:case 15:Ui(4,8,t);break;case 1:break;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,l=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[ve]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Cb(n,r),Zd(e,l),t=Zd(e,r),l=0;l<a.length;l+=2){var i=a[l],o=a[l+1];"style"===i?Wd(n,o):"dangerouslySetInnerHTML"===i?Sb(n,o):"children"===i?Tb(n,o):vb(n,i,o,t)}switch(e){case"input":Eb(n,r);break;case"textarea":Mb(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Jb(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Jb(n,!!r.multiple,r.defaultValue,!0):Jb(n,!!r.multiple,r.multiple?[]:"",!1))}}}break;case 6:if(null===t.stateNode)throw Error(u(162));t.stateNode.nodeValue=t.memoizedProps;break;case 3:(t=t.stateNode).hydrate&&(t.hydrate=!1,Lc(t.containerInfo));break;case 12:break;case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,bj=cg()),null!==n)e:for(e=n;;){if(5===e.tag)a=e.stateNode,r?"function"==typeof(a=a.style).setProperty?a.setProperty("display","none","important"):a.display="none":(a=e.stateNode,l=null!=(l=e.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,a.style.display=Vd("display",l));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(a=e.child.sibling).return=e,e=a;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break e;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}cj(t);break;case 19:cj(t);break;case 17:case 20:case 21:break;default:throw Error(u(163))}}function cj(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Oi),t.forEach(function(t){var r=dj.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}var ej="function"==typeof WeakMap?WeakMap:Map;function fj(e,t,n){(n=Bg(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){gj||(gj=!0,hj=r),Pi(e,t)},n}function ij(e,t,n){(n=Bg(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var l=t.value;n.payload=function(){return Pi(e,t),r(l)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===jj?jj=new Set([this]):jj.add(this),Pi(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var gk,kj=Math.ceil,lj=Ea.ReactCurrentDispatcher,mj=Ea.ReactCurrentOwner,S=0,nj=8,oj=16,pj=32,qj=0,rj=1,sj=2,tj=3,uj=4,vj=5,T=S,U=null,V=null,W=0,X=qj,wj=null,xj=1073741823,yj=1073741823,zj=null,Aj=0,Bj=!1,bj=0,Cj=500,Y=null,gj=!1,hj=null,jj=null,Dj=!1,Ej=null,Fj=90,Gj=null,Hj=0,Ij=null,Jj=0;function Pg(){return(T&(oj|pj))!==S?1073741821-(cg()/10|0):0!==Jj?Jj:Jj=1073741821-(cg()/10|0)}function Qg(e,t,n){if(0==(2&(t=t.mode)))return 1073741823;var r=dg();if(0==(4&t))return 99===r?1073741823:1073741822;if((T&oj)!==S)return W;if(null!==n)e=lg(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=lg(e,150,100);break;case 97:case 96:e=lg(e,5e3,250);break;case 95:e=2;break;default:throw Error(u(326))}return null!==U&&e===W&&--e,e}function Rg(e,t){if(50<Hj)throw Hj=0,Ij=null,Error(u(185));if(null!==(e=Kj(e,t))){var n=dg();1073741823===t?(T&nj)!==S&&(T&(oj|pj))===S?Lj(e):(Z(e),T===S&&jg()):Z(e),(4&T)===S||98!==n&&99!==n||(null===Gj?Gj=new Map([[e,t]]):(void 0===(n=Gj.get(e))||n>t)&&Gj.set(e,t))}}function Kj(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,l=null;if(null===r&&3===e.tag)l=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){l=r.stateNode;break}r=r.return}return null!==l&&(U===l&&(Jg(t),X===uj&&Mj(l,W)),Nj(l,t)),l}function Oj(e){var t=e.lastExpiredTime;return 0!==t?t:Pj(e,t=e.firstPendingTime)?(t=e.lastPingedTime)>(e=e.nextKnownPendingLevel)?t:e:t}function Z(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=hg(Lj.bind(null,e));else{var t=Oj(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=Pg();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var l=e.callbackPriority;if(e.callbackExpirationTime===t&&l>=r)return;n!==Xf&&Nf(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?hg(Lj.bind(null,e)):gg(r,Qj.bind(null,e),{timeout:10*(1073741821-t)-cg()}),e.callbackNode=t}}}function Qj(e,t){if(Jj=0,t)return Rj(e,t=Pg()),Z(e),null;var n=Oj(e);if(0!==n){if(t=e.callbackNode,(T&(oj|pj))!==S)throw Error(u(327));if(Sj(),e===U&&n===W||Tj(e,n),null!==V){var r=T;T|=oj;for(var l=Uj(e);;)try{Vj();break}catch(t){Wj(e,t)}if(rg(),T=r,lj.current=l,X===rj)throw t=wj,Tj(e,n),Mj(e,n),Z(e),t;if(null===V)switch(l=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=X,U=null,r){case qj:case rj:throw Error(u(345));case sj:Rj(e,2<n?2:n);break;case tj:if(Mj(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Xj(l)),1073741823===xj&&10<(l=bj+Cj-cg())){if(Bj){var a=e.lastPingedTime;if(0===a||a>=n){e.lastPingedTime=n,Tj(e,n);break}}if(0!==(a=Oj(e))&&a!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=pe(Yj.bind(null,e),l);break}Yj(e);break;case uj:if(Mj(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=Xj(l)),Bj&&(0===(l=e.lastPingedTime)||l>=n)){e.lastPingedTime=n,Tj(e,n);break}if(0!==(l=Oj(e))&&l!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==yj?r=10*(1073741821-yj)-cg():1073741823===xj?r=0:(r=10*(1073741821-xj)-5e3,0>(r=(l=cg())-r)&&(r=0),(n=10*(1073741821-n)-l)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kj(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=pe(Yj.bind(null,e),r);break}Yj(e);break;case vj:if(1073741823!==xj&&null!==zj){a=xj;var i=zj;if(0>=(r=0|i.busyMinDurationMs)?r=0:(l=0|i.busyDelayMs,r=(a=cg()-(10*(1073741821-a)-(0|i.timeoutMs||5e3)))<=l?0:l+r-a),10<r){Mj(e,n),e.timeoutHandle=pe(Yj.bind(null,e),r);break}}Yj(e);break;default:throw Error(u(329))}if(Z(e),e.callbackNode===t)return Qj.bind(null,e)}}return null}function Lj(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,e.finishedExpirationTime===t)Yj(e);else{if((T&(oj|pj))!==S)throw Error(u(327));if(Sj(),e===U&&t===W||Tj(e,t),null!==V){var n=T;T|=oj;for(var r=Uj(e);;)try{Zj();break}catch(t){Wj(e,t)}if(rg(),T=n,lj.current=r,X===rj)throw n=wj,Tj(e,t),Mj(e,t),Z(e),n;if(null!==V)throw Error(u(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,U=null,Yj(e),Z(e)}}return null}function ak(){if(null!==Gj){var e=Gj;Gj=null,e.forEach(function(e,t){Rj(t,e),Z(t)}),jg()}}function bk(e,t){var n=T;T|=1;try{return e(t)}finally{(T=n)===S&&jg()}}function ck(e,t){var n=T;T&=-2,T|=nj;try{return e(t)}finally{(T=n)===S&&jg()}}function Tj(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,qe(n)),null!==V)for(n=V.return;null!==n;){var r=n;switch(r.tag){case 1:var l=r.type.childContextTypes;null!=l&&Ff(r);break;case 3:nh(r),Gf(r);break;case 5:ph(r);break;case 4:nh(r);break;case 13:case 19:G(M,r);break;case 10:tg(r)}n=n.return}U=e,V=ah(e.current,null,t),W=t,X=qj,wj=null,yj=xj=1073741823,zj=null,Aj=0,Bj=!1}function Wj(e,t){for(;;){try{if(rg(),Mh(),null===V||null===V.return)return X=rj,wj=t,null;e:{var n=e,r=V.return,l=V,a=t;if(t=W,l.effectTag|=2048,l.firstEffect=l.lastEffect=null,null!==a&&"object"==typeof a&&"function"==typeof a.then){var i=a,u=0!=(1&M.current),o=r;do{var c;if(c=13===o.tag){var f=o.memoizedState;if(null!==f)c=null!==f.dehydrated;else{var s=o.memoizedProps;c=void 0!==s.fallback&&(!0!==s.unstable_avoidThisFallback||!u)}}if(c){var d=o.updateQueue;if(null===d){var p=new Set;p.add(i),o.updateQueue=p}else d.add(i);if(0==(2&o.mode)){if(o.effectTag|=64,l.effectTag&=-2981,1===l.tag)if(null===l.alternate)l.tag=17;else{var h=Bg(1073741823,null);h.tag=2,Dg(l,h)}l.expirationTime=1073741823;break e}a=void 0,l=t;var g=n.pingCache;if(null===g?(g=n.pingCache=new ej,a=new Set,g.set(i,a)):void 0===(a=g.get(i))&&(a=new Set,g.set(i,a)),!a.has(l)){a.add(l);var m=dk.bind(null,n,i,l);i.then(m,m)}o.effectTag|=4096,o.expirationTime=t;break e}o=o.return}while(null!==o);a=Error((Wa(l.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+Xa(l))}X!==vj&&(X=sj),a=Ni(a,l),o=r;do{switch(o.tag){case 3:i=a,o.effectTag|=4096,o.expirationTime=t,Eg(o,fj(o,i,t));break e;case 1:i=a;var b=o.type,v=o.stateNode;if(0==(64&o.effectTag)&&("function"==typeof b.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===jj||!jj.has(v)))){o.effectTag|=4096,o.expirationTime=t,Eg(o,ij(o,i,t));break e}}o=o.return}while(null!==o)}V=ek(V)}catch(e){t=e;continue}break}}function Uj(){var e=lj.current;return lj.current=Lh,null===e?Lh:e}function Ig(e,t){e<xj&&2<e&&(xj=e),null!==t&&e<yj&&2<e&&(yj=e,zj=t)}function Jg(e){e>Aj&&(Aj=e)}function Zj(){for(;null!==V;)V=fk(V)}function Vj(){for(;null!==V&&!Of();)V=fk(V)}function fk(e){var t=gk(e.alternate,e,W);return e.memoizedProps=e.pendingProps,null===t&&(t=ek(e)),mj.current=null,t}function ek(e){V=e;do{var t=V.alternate;if(e=V.return,0==(2048&V.effectTag)){e:{var r=t,l=W,a=(t=V).pendingProps;switch(t.tag){case 2:case 16:break;case 15:case 0:break;case 1:L(t.type)&&Ff(t);break;case 3:nh(t),Gf(t),(a=t.stateNode).pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(null===r||null===r.child)&&ki(t)&&Ci(t),Ii(t);break;case 5:ph(t),l=lh(kh.current);var i=t.type;if(null!==r&&null!=t.stateNode)Ji(r,t,i,a,l),r.ref!==t.ref&&(t.effectTag|=128);else if(a){var o=lh(ih.current);if(ki(t)){var c=(a=t).stateNode;r=a.type;var f=a.memoizedProps,s=l;switch(c[ue]=a,c[ve]=f,i=void 0,l=c,r){case"iframe":case"object":case"embed":F("load",l);break;case"video":case"audio":for(c=0;c<cc.length;c++)F(cc[c],l);break;case"source":F("error",l);break;case"img":case"image":case"link":F("error",l),F("load",l);break;case"form":F("reset",l),F("submit",l);break;case"details":F("toggle",l);break;case"input":Bb(l,f),F("invalid",l),$d(s,"onChange");break;case"select":l._wrapperState={wasMultiple:!!f.multiple},F("invalid",l),$d(s,"onChange");break;case"textarea":Lb(l,f),F("invalid",l),$d(s,"onChange")}for(i in Yd(r,f),c=null,f)f.hasOwnProperty(i)&&(o=f[i],"children"===i?"string"==typeof o?l.textContent!==o&&(c=["children",o]):"number"==typeof o&&l.textContent!==""+o&&(c=["children",""+o]):ia.hasOwnProperty(i)&&null!=o&&$d(s,i));switch(r){case"input":yb(l),Gb(l,f,!0);break;case"textarea":yb(l),Nb(l,f);break;case"select":case"option":break;default:"function"==typeof f.onClick&&(l.onclick=ae)}i=c,a.updateQueue=i,(a=null!==i)&&Ci(t)}else{r=t,s=i,f=a,c=9===l.nodeType?l:l.ownerDocument,o===Ob.html&&(o=Pb(s)),o===Ob.html?"script"===s?((f=c.createElement("div")).innerHTML="<script><\/script>",c=f.removeChild(f.firstChild)):"string"==typeof f.is?c=c.createElement(s,{is:f.is}):(c=c.createElement(s),"select"===s&&(s=c,f.multiple?s.multiple=!0:f.size&&(s.size=f.size))):c=c.createElementNS(o,s),(f=c)[ue]=r,f[ve]=a,Hi(f,t,!1,!1),t.stateNode=f;var d=l,p=Zd(s=i,r=a);switch(s){case"iframe":case"object":case"embed":F("load",f),l=r;break;case"video":case"audio":for(l=0;l<cc.length;l++)F(cc[l],f);l=r;break;case"source":F("error",f),l=r;break;case"img":case"image":case"link":F("error",f),F("load",f),l=r;break;case"form":F("reset",f),F("submit",f),l=r;break;case"details":F("toggle",f),l=r;break;case"input":Bb(f,r),l=Ab(f,r),F("invalid",f),$d(d,"onChange");break;case"option":l=Ib(f,r);break;case"select":f._wrapperState={wasMultiple:!!r.multiple},l=n({},r,{value:void 0}),F("invalid",f),$d(d,"onChange");break;case"textarea":Lb(f,r),l=Kb(f,r),F("invalid",f),$d(d,"onChange");break;default:l=r}Yd(s,l),c=void 0,o=s;var h=f,g=l;for(c in g)if(g.hasOwnProperty(c)){var m=g[c];"style"===c?Wd(h,m):"dangerouslySetInnerHTML"===c?null!=(m=m?m.__html:void 0)&&Sb(h,m):"children"===c?"string"==typeof m?("textarea"!==o||""!==m)&&Tb(h,m):"number"==typeof m&&Tb(h,""+m):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(ia.hasOwnProperty(c)?null!=m&&$d(d,c):null!=m&&vb(h,c,m,p))}switch(s){case"input":yb(f),Gb(f,r,!1);break;case"textarea":yb(f),Nb(f,r);break;case"option":null!=r.value&&f.setAttribute("value",""+ub(r.value));break;case"select":(l=f).multiple=!!r.multiple,null!=(f=r.value)?Jb(l,!!r.multiple,f,!1):null!=r.defaultValue&&Jb(l,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof l.onClick&&(f.onclick=ae)}(a=ne(i,a))&&Ci(t)}null!==t.ref&&(t.effectTag|=128)}else if(null===t.stateNode)throw Error(u(166));break;case 6:if(r&&null!=t.stateNode)Ki(r,t,r.memoizedProps,a);else{if("string"!=typeof a&&null===t.stateNode)throw Error(u(166));l=lh(kh.current),lh(ih.current),ki(t)?(i=(a=t).stateNode,l=a.memoizedProps,i[ue]=a,(a=i.nodeValue!==l)&&Ci(t)):(i=t,(a=(9===l.nodeType?l:l.ownerDocument).createTextNode(a))[ue]=i,t.stateNode=a)}break;case 11:break;case 13:if(G(M,t),a=t.memoizedState,0!=(64&t.effectTag)){t.expirationTime=l;break e}a=null!==a,i=!1,null===r?void 0!==t.memoizedProps.fallback&&ki(t):(i=null!==(l=r.memoizedState),a||null===l||null!==(l=r.child.sibling)&&(null!==(f=t.firstEffect)?(t.firstEffect=l,l.nextEffect=f):(t.firstEffect=t.lastEffect=l,l.nextEffect=null),l.effectTag=8)),a&&!i&&0!=(2&t.mode)&&(null===r&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&M.current)?X===qj&&(X=tj):(X!==qj&&X!==tj||(X=uj),0!==Aj&&null!==U&&(Mj(U,W),Nj(U,Aj)))),(a||i)&&(t.effectTag|=4);break;case 7:case 8:case 12:break;case 4:nh(t),Ii(t);break;case 10:tg(t);break;case 9:case 14:break;case 17:L(t.type)&&Ff(t);break;case 19:if(G(M,t),null===(a=t.memoizedState))break;if(i=0!=(64&t.effectTag),null===(f=a.rendering)){if(i)Li(a,!1);else if(X!==qj||null!==r&&0!=(64&r.effectTag))for(r=t.child;null!==r;){if(null!==(f=qh(r))){for(t.effectTag|=64,Li(a,!1),null!==(i=f.updateQueue)&&(t.updateQueue=i,t.effectTag|=4),null===a.lastEffect&&(t.firstEffect=null),t.lastEffect=a.lastEffect,a=l,i=t.child;null!==i;)r=a,(l=i).effectTag&=2,l.nextEffect=null,l.firstEffect=null,l.lastEffect=null,null===(f=l.alternate)?(l.childExpirationTime=0,l.expirationTime=r,l.child=null,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null):(l.childExpirationTime=f.childExpirationTime,l.expirationTime=f.expirationTime,l.child=f.child,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,r=f.dependencies,l.dependencies=null===r?null:{expirationTime:r.expirationTime,firstContext:r.firstContext,responders:r.responders}),i=i.sibling;I(M,1&M.current|2,t),t=t.child;break e}r=r.sibling}}else{if(!i)if(null!==(r=qh(f))){if(t.effectTag|=64,i=!0,null!==(l=r.updateQueue)&&(t.updateQueue=l,t.effectTag|=4),Li(a,!0),null===a.tail&&"hidden"===a.tailMode&&!f.alternate){null!==(t=t.lastEffect=a.lastEffect)&&(t.nextEffect=null);break}}else cg()>a.tailExpiration&&1<l&&(t.effectTag|=64,i=!0,Li(a,!1),t.expirationTime=t.childExpirationTime=l-1);a.isBackwards?(f.sibling=t.child,t.child=f):(null!==(l=a.last)?l.sibling=f:t.child=f,a.last=f)}if(null!==a.tail){0===a.tailExpiration&&(a.tailExpiration=cg()+500),l=a.tail,a.rendering=l,a.tail=l.sibling,a.lastEffect=t.lastEffect,l.sibling=null,a=M.current,I(M,a=i?1&a|2:1&a,t),t=l;break e}break;case 20:case 21:break;default:throw Error(u(156,t.tag))}t=null}if(a=V,1===W||1!==a.childExpirationTime){for(i=0,l=a.child;null!==l;)(r=l.expirationTime)>i&&(i=r),(f=l.childExpirationTime)>i&&(i=f),l=l.sibling;a.childExpirationTime=i}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=V.firstEffect),null!==V.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=V.firstEffect),e.lastEffect=V.lastEffect),1<V.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=V:e.firstEffect=V,e.lastEffect=V))}else{if(null!==(t=Mi(V,W)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=V.sibling))return t;V=e}while(null!==V);return X===qj&&(X=vj),null}function Xj(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function Yj(e){var t=dg();return fg(99,ik.bind(null,e,t)),null}function ik(e,t){do{Sj()}while(null!==Ej);if((T&(oj|pj))!==S)throw Error(u(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(u(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var l=Xj(n);if(e.firstPendingTime=l,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===U&&(V=U=null,W=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,l=n.firstEffect):l=n:l=n.firstEffect,null!==l){var a=T;T|=pj,mj.current=null,le=Ld;var i=fe();if(ge(i)){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{var c=(o=(o=i.ownerDocument)&&o.defaultView||window).getSelection&&o.getSelection();if(c&&0!==c.rangeCount){o=c.anchorNode;var f=c.anchorOffset,s=c.focusNode;c=c.focusOffset;try{o.nodeType,s.nodeType}catch(e){o=null;break e}var d=0,p=-1,h=-1,g=0,m=0,b=i,v=null;t:for(;;){for(var y;b!==o||0!==f&&3!==b.nodeType||(p=d+f),b!==s||0!==c&&3!==b.nodeType||(h=d+c),3===b.nodeType&&(d+=b.nodeValue.length),null!==(y=b.firstChild);)v=b,b=y;for(;;){if(b===i)break t;if(v===o&&++g===f&&(p=d),v===s&&++m===c&&(h=d),null!==(y=b.nextSibling))break;v=(b=v).parentNode}b=y}o=-1===p||-1===h?null:{start:p,end:h}}else o=null}o=o||{start:0,end:0}}else o=null;me={focusedElem:i,selectionRange:o},Ld=!1,Y=l;do{try{jk()}catch(e){if(null===Y)throw Error(u(330));Ri(Y,e),Y=Y.nextEffect}}while(null!==Y);Y=l;do{try{for(i=e,o=t;null!==Y;){var k=Y.effectTag;if(16&k&&Tb(Y.stateNode,""),128&k){var w=Y.alternate;if(null!==w){var E=w.ref;null!==E&&("function"==typeof E?E(null):E.current=null)}}switch(1038&k){case 2:$i(Y),Y.effectTag&=-3;break;case 6:$i(Y),Y.effectTag&=-3,aj(Y.alternate,Y);break;case 1024:Y.effectTag&=-1025;break;case 1028:Y.effectTag&=-1025,aj(Y.alternate,Y);break;case 4:aj(Y.alternate,Y);break;case 8:Xi(i,f=Y,o),Yi(f)}Y=Y.nextEffect}}catch(e){if(null===Y)throw Error(u(330));Ri(Y,e),Y=Y.nextEffect}}while(null!==Y);if(E=me,w=fe(),k=E.focusedElem,o=E.selectionRange,w!==k&&k&&k.ownerDocument&&ee(k.ownerDocument.documentElement,k)){null!==o&&ge(k)&&(w=o.start,void 0===(E=o.end)&&(E=w),"selectionStart"in k?(k.selectionStart=w,k.selectionEnd=Math.min(E,k.value.length)):(E=(w=k.ownerDocument||document)&&w.defaultView||window).getSelection&&(E=E.getSelection(),f=k.textContent.length,i=Math.min(o.start,f),o=void 0===o.end?i:Math.min(o.end,f),!E.extend&&i>o&&(f=o,o=i,i=f),f=de(k,i),s=de(k,o),f&&s&&(1!==E.rangeCount||E.anchorNode!==f.node||E.anchorOffset!==f.offset||E.focusNode!==s.node||E.focusOffset!==s.offset)&&((w=w.createRange()).setStart(f.node,f.offset),E.removeAllRanges(),i>o?(E.addRange(w),E.extend(s.node,s.offset)):(w.setEnd(s.node,s.offset),E.addRange(w))))),w=[];for(E=k;E=E.parentNode;)1===E.nodeType&&w.push({element:E,left:E.scrollLeft,top:E.scrollTop});for("function"==typeof k.focus&&k.focus(),k=0;k<w.length;k++)(E=w[k]).element.scrollLeft=E.left,E.element.scrollTop=E.top}me=null,Ld=!!le,le=null,e.current=n,Y=l;do{try{for(k=r;null!==Y;){var x=Y.effectTag;if(36&x){var j=Y.alternate;switch(E=k,(w=Y).tag){case 0:case 11:case 15:Ui(16,32,w);break;case 1:var C=w.stateNode;if(4&w.effectTag)if(null===j)C.componentDidMount();else{var P=w.elementType===w.type?j.memoizedProps:mg(w.type,j.memoizedProps);C.componentDidUpdate(P,j.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var N=w.updateQueue;null!==N&&Kg(w,N,C,E);break;case 3:var z=w.updateQueue;if(null!==z){if(i=null,null!==w.child)switch(w.child.tag){case 5:i=w.child.stateNode;break;case 1:i=w.child.stateNode}Kg(w,z,i,E)}break;case 5:var _=w.stateNode;null===j&&4&w.effectTag&&ne(w.type,w.memoizedProps)&&_.focus();break;case 6:case 4:case 12:break;case 13:if(null===w.memoizedState){var M=w.alternate;if(null!==M){var I=M.memoizedState;if(null!==I){var F=I.dehydrated;null!==F&&Lc(F)}}}break;case 19:case 17:case 20:case 21:break;default:throw Error(u(163))}}if(128&x){w=void 0;var O=Y.ref;if(null!==O){var R=Y.stateNode;switch(Y.tag){case 5:w=R;break;default:w=R}"function"==typeof O?O(w):O.current=w}}Y=Y.nextEffect}}catch(e){if(null===Y)throw Error(u(330));Ri(Y,e),Y=Y.nextEffect}}while(null!==Y);Y=null,Yf(),T=a}else e.current=n;if(Dj)Dj=!1,Ej=e,Fj=t;else for(Y=l;null!==Y;)t=Y.nextEffect,Y.nextEffect=null,Y=t;if(0===(t=e.firstPendingTime)&&(jj=null),1073741823===t?e===Ij?Hj++:(Hj=0,Ij=e):Hj=0,"function"==typeof kk&&kk(n.stateNode,r),Z(e),gj)throw gj=!1,e=hj,hj=null,e;return(T&nj)!==S?null:(jg(),null)}function jk(){for(;null!==Y;){var e=Y.effectTag;0!=(256&e)&&Ti(Y.alternate,Y),0==(512&e)||Dj||(Dj=!0,gg(97,function(){return Sj(),null})),Y=Y.nextEffect}}function Sj(){if(90!==Fj){var e=97<Fj?97:Fj;return Fj=90,fg(e,lk)}}function lk(){if(null===Ej)return!1;var e=Ej;if(Ej=null,(T&(oj|pj))!==S)throw Error(u(331));var t=T;for(T|=pj,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:Ui(128,0,n),Ui(0,64,n)}}catch(t){if(null===e)throw Error(u(330));Ri(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return T=t,jg(),!0}function mk(e,t,n){Dg(e,t=fj(e,t=Ni(n,t),1073741823)),null!==(e=Kj(e,1073741823))&&Z(e)}function Ri(e,t){if(3===e.tag)mk(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){mk(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===jj||!jj.has(r))){Dg(n,e=ij(n,e=Ni(t,e),1073741823)),null!==(n=Kj(n,1073741823))&&Z(n);break}}n=n.return}}function dk(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),U===e&&W===n?X===uj||X===tj&&1073741823===xj&&cg()-bj<Cj?Tj(e,W):Bj=!0:Pj(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,e.finishedExpirationTime===n&&(e.finishedExpirationTime=0,e.finishedWork=null),Z(e)))}function dj(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=Qg(t=Pg(),e,null)),null!==(e=Kj(e,t))&&Z(e)}gk=function(e,t,n){var r=t.expirationTime;if(null!==e){var l=t.pendingProps;if(e.memoizedProps!==l||K.current)wg=!0;else{if(r<n){switch(wg=!1,t.tag){case 3:wi(t),li();break;case 5:if(oh(t),4&t.mode&&1!==n&&l.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:L(t.type)&&Jf(t);break;case 4:mh(t,t.stateNode.containerInfo);break;case 10:sg(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?yi(e,t,n):(I(M,1&M.current,t),null!==(t=oi(e,t,n))?t.sibling:null);I(M,1&M.current,t);break;case 19:if(r=t.childExpirationTime>=n,0!=(64&e.effectTag)){if(r)return Bi(e,t,n);t.effectTag|=64}if(null!==(l=t.memoizedState)&&(l.rendering=null,l.tail=null),I(M,M.current,t),!r)return null}return oi(e,t,n)}wg=!1}}else wg=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,l=Ef(t,J.current),vg(t,n),l=Ih(null,t,r,e,l,n),t.effectTag|=1,"object"==typeof l&&null!==l&&"function"==typeof l.render&&void 0===l.$$typeof){if(t.tag=1,Mh(),L(r)){var a=!0;Jf(t)}else a=!1;t.memoizedState=null!==l.state&&void 0!==l.state?l.state:null;var i=r.getDerivedStateFromProps;"function"==typeof i&&Og(t,r,i,e),l.updater=Sg,t.stateNode=l,l._reactInternalFiber=t,Wg(t,r,e,n),t=vi(null,t,r,!0,a,n)}else t.tag=0,R(null,t,l,n),t=t.child;return t;case 16:if(l=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,Va(l),1!==l._status)throw l._result;switch(l=l._result,t.type=l,a=t.tag=nk(l),e=mg(l,e),a){case 0:t=si(null,t,l,e,n);break;case 1:t=ui(null,t,l,e,n);break;case 11:t=ni(null,t,l,e,n);break;case 14:t=pi(null,t,l,mg(l.type,e),r,n);break;default:throw Error(u(306,l,""))}return t;case 0:return r=t.type,l=t.pendingProps,si(e,t,r,l=t.elementType===r?l:mg(r,l),n);case 1:return r=t.type,l=t.pendingProps,ui(e,t,r,l=t.elementType===r?l:mg(r,l),n);case 3:if(wi(t),null===(r=t.updateQueue))throw Error(u(282));if(l=null!==(l=t.memoizedState)?l.element:null,Hg(t,r,t.pendingProps,null,n),(r=t.memoizedState.element)===l)li(),t=oi(e,t,n);else{if((l=t.stateNode.hydrate)&&(di=re(t.stateNode.containerInfo.firstChild),ci=t,l=ei=!0),l)for(n=gh(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else R(e,t,r,n),li();t=t.child}return t;case 5:return oh(t),null===e&&ii(t),r=t.type,l=t.pendingProps,a=null!==e?e.memoizedProps:null,i=l.children,oe(r,l)?i=null:null!==a&&oe(r,a)&&(t.effectTag|=16),ti(e,t),4&t.mode&&1!==n&&l.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(R(e,t,i,n),t=t.child),t;case 6:return null===e&&ii(t),null;case 13:return yi(e,t,n);case 4:return mh(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fh(t,null,r,n):R(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,ni(e,t,r,l=t.elementType===r?l:mg(r,l),n);case 7:return R(e,t,t.pendingProps,n),t.child;case 8:case 12:return R(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,i=t.memoizedProps,sg(t,a=l.value),null!==i){var o=i.value;if(0===(a=of(o,a)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(o,a):1073741823))){if(i.children===l.children&&!K.current){t=oi(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){i=o.child;for(var f=c.firstContext;null!==f;){if(f.context===r&&0!=(f.observedBits&a)){1===o.tag&&((f=Bg(n,null)).tag=2,Dg(o,f)),o.expirationTime<n&&(o.expirationTime=n),null!==(f=o.alternate)&&f.expirationTime<n&&(f.expirationTime=n),ug(o.return,n),c.expirationTime<n&&(c.expirationTime=n);break}f=f.next}}else i=10===o.tag&&o.type===t.type?null:o.child;if(null!==i)i.return=o;else for(i=o;null!==i;){if(i===t){i=null;break}if(null!==(o=i.sibling)){o.return=i.return,i=o;break}i=i.return}o=i}}R(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=(a=t.pendingProps).children,vg(t,n),r=r(l=xg(l,a.unstable_observedBits)),t.effectTag|=1,R(e,t,r,n),t.child;case 14:return a=mg(l=t.type,t.pendingProps),pi(e,t,l,a=mg(l.type,a),r,n);case 15:return ri(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:mg(r,l),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,L(r)?(e=!0,Jf(t)):e=!1,vg(t,n),Ug(t,r,l,n),Wg(t,r,l,n),vi(null,t,r,!0,e,n);case 19:return Bi(e,t,n)}throw Error(u(156,t.tag))};var kk=null,Wi=null;function ok(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);kk=function(e){try{t.onCommitFiberRoot(n,e,void 0,64==(64&e.current.effectTag))}catch(e){}},Wi=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}return!0}function pk(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function gi(e,t,n,r){return new pk(e,t,n,r)}function qi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function nk(e){if("function"==typeof e)return qi(e)?1:0;if(null!=e){if((e=e.$$typeof)===Oa)return 11;if(e===Ra)return 14}return 2}function ah(e,t){var n=e.alternate;return null===n?((n=gi(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ch(e,t,n,r,l,a){var i=2;if(r=e,"function"==typeof e)qi(e)&&(i=1);else if("string"==typeof e)i=5;else e:switch(e){case Ia:return eh(n.children,l,a,t);case Na:i=8,l|=7;break;case Ja:i=8,l|=1;break;case Ka:return(e=gi(12,n,t,8|l)).elementType=Ka,e.type=Ka,e.expirationTime=a,e;case Pa:return(e=gi(13,n,t,l)).type=Pa,e.elementType=Pa,e.expirationTime=a,e;case Qa:return(e=gi(19,n,t,l)).elementType=Qa,e.expirationTime=a,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case La:i=10;break e;case Ma:i=9;break e;case Oa:i=11;break e;case Ra:i=14;break e;case Sa:i=16,r=null;break e}throw Error(u(130,null==e?e:typeof e,""))}return(t=gi(i,n,t,l)).elementType=e,t.type=r,t.expirationTime=a,t}function eh(e,t,n,r){return(e=gi(7,e,r,t)).expirationTime=n,e}function bh(e,t,n){return(e=gi(6,e,null,t)).expirationTime=n,e}function dh(e,t,n){return(t=gi(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qk(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Pj(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Mj(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Nj(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Rj(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function rk(e,t,n,r){var l=t.current,a=Pg(),i=Mg.suspense;a=Qg(a,l,i);e:if(n){t:{if(ec(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(u(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break t;case 1:if(L(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break t}}o=o.return}while(null!==o);throw Error(u(171))}if(1===n.tag){var c=n.type;if(L(c)){n=If(n,c,o);break e}}n=o}else n=Cf;return null===t.context?t.context=n:t.pendingContext=n,(t=Bg(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),Dg(l,t),Rg(l,a),a}function sk(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function tk(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function uk(e,t){tk(e,t),(e=e.alternate)&&tk(e,t)}function vk(e,t,n){var r=new qk(e,t,n=null!=n&&!0===n.hydrate),l=gi(3,null,null,2===t?7:1===t?3:0);r.current=l,l.stateNode=r,e[we]=r.current,n&&0!==t&&wc(9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function wk(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function yk(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new vk(e,0,t?{hydrate:!0}:void 0)}function zk(e,t,n,r,l){var a=n._reactRootContainer;if(a){var i=a._internalRoot;if("function"==typeof l){var u=l;l=function(){var e=sk(i);u.call(e)}}rk(t,i,e,l)}else{if(a=n._reactRootContainer=yk(n,r),i=a._internalRoot,"function"==typeof l){var o=l;l=function(){var e=sk(i);o.call(e)}}ck(function(){rk(t,i,e,l)})}return sk(i)}function Ak(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ha,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Bk(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!wk(t))throw Error(u(200));return Ak(e,t,null,n)}vk.prototype.render=function(e,t){rk(e,this._internalRoot,null,void 0===t?null:t)},vk.prototype.unmount=function(e){var t=this._internalRoot,n=void 0===e?null:e,r=t.containerInfo;rk(null,t,null,function(){r[we]=null,null!==n&&n()})},jc=function(e){if(13===e.tag){var t=lg(Pg(),150,100);Rg(e,t),uk(e,t)}},kc=function(e){if(13===e.tag){Pg();var t=kg++;Rg(e,t),uk(e,t)}},lc=function(e){if(13===e.tag){var t=Pg();Rg(e,t=Qg(t,e,null)),uk(e,t)}},Za=function(e,t,n){switch(t){case"input":if(Eb(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=ye(r);if(!l)throw Error(u(90));zb(r),Eb(r,l)}}}break;case"textarea":Mb(e,n);break;case"select":null!=(t=n.value)&&Jb(e,!!n.multiple,t,!1)}},eb=bk,fb=function(e,t,n,r){var l=T;T|=4;try{return fg(98,e.bind(null,t,n,r))}finally{(T=l)===S&&jg()}},gb=function(){(T&(1|oj|pj))===S&&(ak(),Sj())},hb=function(e,t){var n=T;T|=2;try{return e(t)}finally{(T=n)===S&&jg()}};var Ck={createPortal:Bk,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(u(188));throw Error(u(268,Object.keys(e)))}return e=null===(e=ic(t))?null:e.stateNode},hydrate:function(e,t,n){if(!wk(t))throw Error(u(200));return zk(null,e,t,!0,n)},render:function(e,t,n){if(!wk(t))throw Error(u(200));return zk(null,e,t,!1,n)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){if(!wk(n))throw Error(u(200));if(null==e||void 0===e._reactInternalFiber)throw Error(u(38));return zk(e,t,n,!1,r)},unmountComponentAtNode:function(e){if(!wk(e))throw Error(u(40));return!!e._reactRootContainer&&(ck(function(){zk(null,null,e,!1,function(){e._reactRootContainer=null,e[we]=null})}),!0)},unstable_createPortal:function(){return Bk.apply(void 0,arguments)},unstable_batchedUpdates:bk,flushSync:function(e,t){if((T&(oj|pj))!==S)throw Error(u(187));var n=T;T|=1;try{return fg(99,e.bind(null,t))}finally{T=n,jg()}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[Cc,xe,ye,Ca.injectEventPluginsByName,fa,Sc,function(e){ya(e,Rc)},cb,db,Pd,Ba,Sj,{current:!1}]}};!function(e){var t=e.findFiberByHostInstance;ok(n({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=ic(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Fc,bundleType:0,version:"16.12.0",rendererPackageName:"react-dom"});var Dk={default:Ck},Ek=Dk&&Ck||Dk;module.exports=Ek.default||Ek;

},{"object-assign":"/Users/rabbit/projects/buntimer2020-github/node_modules/object-assign/index.js","react":"/Users/rabbit/projects/buntimer2020-github/node_modules/react/index.js","scheduler":"/Users/rabbit/projects/buntimer2020-github/node_modules/scheduler/index.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/react-dom/index.js":[function(require,module,exports){
"use strict";function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(_){console.error(_)}}}checkDCE(),module.exports=require("./cjs/react-dom.production.min.js");

},{"./cjs/react-dom.production.min.js":"/Users/rabbit/projects/buntimer2020-github/node_modules/react-dom/cjs/react-dom.production.min.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/react/cjs/react.production.min.js":[function(require,module,exports){
"use strict";var h=require("object-assign"),n="function"==typeof Symbol&&Symbol.for,p=n?Symbol.for("react.element"):60103,q=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,t=n?Symbol.for("react.strict_mode"):60108,u=n?Symbol.for("react.profiler"):60114,v=n?Symbol.for("react.provider"):60109,w=n?Symbol.for("react.context"):60110,x=n?Symbol.for("react.forward_ref"):60112,y=n?Symbol.for("react.suspense"):60113;n&&Symbol.for("react.suspense_list");var z=n?Symbol.for("react.memo"):60115,aa=n?Symbol.for("react.lazy"):60116;n&&Symbol.for("react.fundamental"),n&&Symbol.for("react.responder"),n&&Symbol.for("react.scope");var A="function"==typeof Symbol&&Symbol.iterator;function B(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)r+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D={};function E(e,r,t){this.props=e,this.context=r,this.refs=D,this.updater=t||C}function F(){}function G(e,r,t){this.props=e,this.context=r,this.refs=D,this.updater=t||C}E.prototype.isReactComponent={},E.prototype.setState=function(e,r){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(B(85));this.updater.enqueueSetState(this,e,r,"setState")},E.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},F.prototype=E.prototype;var H=G.prototype=new F;H.constructor=G,h(H,E.prototype),H.isPureReactComponent=!0;var I={current:null},J={current:null},K=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function M(e,r,t){var n,o={},u=null,c=null;if(null!=r)for(n in void 0!==r.ref&&(c=r.ref),void 0!==r.key&&(u=""+r.key),r)K.call(r,n)&&!L.hasOwnProperty(n)&&(o[n]=r[n]);var f=arguments.length-2;if(1===f)o.children=t;else if(1<f){for(var l=Array(f),a=0;a<f;a++)l[a]=arguments[a+2];o.children=l}if(e&&e.defaultProps)for(n in f=e.defaultProps)void 0===o[n]&&(o[n]=f[n]);return{$$typeof:p,type:e,key:u,ref:c,props:o,_owner:J.current}}function ba(e,r){return{$$typeof:p,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===p}function escape(e){var r={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return r[e]})}var O=/\/+/g,P=[];function Q(e,r,t,n){if(P.length){var o=P.pop();return o.result=e,o.keyPrefix=r,o.func=t,o.context=n,o.count=0,o}return{result:e,keyPrefix:r,func:t,context:n,count:0}}function R(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>P.length&&P.push(e)}function S(e,r,t,n){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var u=!1;if(null===e)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case p:case q:u=!0}}if(u)return t(n,e,""===r?"."+T(e,0):r),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var f=r+T(o=e[c],c);u+=S(o,f,t,n)}else if(null===e||"object"!=typeof e?f=null:f="function"==typeof(f=A&&e[A]||e["@@iterator"])?f:null,"function"==typeof f)for(e=f.call(e),c=0;!(o=e.next()).done;)u+=S(o=o.value,f=r+T(o,c++),t,n);else if("object"===o)throw t=""+e,Error(B(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t,""));return u}function U(e,r,t){return null==e?0:S(e,"",r,t)}function T(e,r){return"object"==typeof e&&null!==e&&null!=e.key?escape(e.key):r.toString(36)}function ca(e,r){e.func.call(e.context,r,e.count++)}function da(e,r,t){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,r,e.count++),Array.isArray(e)?V(e,n,t,function(e){return e}):null!=e&&(N(e)&&(e=ba(e,o+(!e.key||r&&r.key===e.key?"":(""+e.key).replace(O,"$&/")+"/")+t)),n.push(e))}function V(e,r,t,n,o){var u="";null!=t&&(u=(""+t).replace(O,"$&/")+"/"),U(e,da,r=Q(r,u,n,o)),R(r)}function W(){var e=I.current;if(null===e)throw Error(B(321));return e}var X={Children:{map:function(e,r,t){if(null==e)return e;var n=[];return V(e,n,null,r,t),n},forEach:function(e,r,t){if(null==e)return e;U(e,ca,r=Q(null,null,r,t)),R(r)},count:function(e){return U(e,function(){return null},null)},toArray:function(e){var r=[];return V(e,r,null,function(e){return e}),r},only:function(e){if(!N(e))throw Error(B(143));return e}},createRef:function(){return{current:null}},Component:E,PureComponent:G,createContext:function(e,r){return void 0===r&&(r=null),(e={$$typeof:w,_calculateChangedBits:r,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:v,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:x,render:e}},lazy:function(e){return{$$typeof:aa,_ctor:e,_status:-1,_result:null}},memo:function(e,r){return{$$typeof:z,type:e,compare:void 0===r?null:r}},useCallback:function(e,r){return W().useCallback(e,r)},useContext:function(e,r){return W().useContext(e,r)},useEffect:function(e,r){return W().useEffect(e,r)},useImperativeHandle:function(e,r,t){return W().useImperativeHandle(e,r,t)},useDebugValue:function(){},useLayoutEffect:function(e,r){return W().useLayoutEffect(e,r)},useMemo:function(e,r){return W().useMemo(e,r)},useReducer:function(e,r,t){return W().useReducer(e,r,t)},useRef:function(e){return W().useRef(e)},useState:function(e){return W().useState(e)},Fragment:r,Profiler:u,StrictMode:t,Suspense:y,createElement:M,cloneElement:function(e,r,t){if(null==e)throw Error(B(267,e));var n=h({},e.props),o=e.key,u=e.ref,c=e._owner;if(null!=r){if(void 0!==r.ref&&(u=r.ref,c=J.current),void 0!==r.key&&(o=""+r.key),e.type&&e.type.defaultProps)var f=e.type.defaultProps;for(l in r)K.call(r,l)&&!L.hasOwnProperty(l)&&(n[l]=void 0===r[l]&&void 0!==f?f[l]:r[l])}var l=arguments.length-2;if(1===l)n.children=t;else if(1<l){f=Array(l);for(var a=0;a<l;a++)f[a]=arguments[a+2];n.children=f}return{$$typeof:p,type:e.type,key:o,ref:u,props:n,_owner:c}},createFactory:function(e){var r=M.bind(null,e);return r.type=e,r},isValidElement:N,version:"16.12.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:I,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:J,IsSomeRendererActing:{current:!1},assign:h}},Y={default:X},Z=Y&&X||Y;module.exports=Z.default||Z;

},{"object-assign":"/Users/rabbit/projects/buntimer2020-github/node_modules/object-assign/index.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/react/index.js":[function(require,module,exports){
"use strict";module.exports=require("./cjs/react.production.min.js");

},{"./cjs/react.production.min.js":"/Users/rabbit/projects/buntimer2020-github/node_modules/react/cjs/react.production.min.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/scheduler/cjs/scheduler.production.min.js":[function(require,module,exports){
"use strict";var f,g,h,k,l;if(Object.defineProperty(exports,"__esModule",{value:!0}),"undefined"==typeof window||"function"!=typeof MessageChannel){var p=null,q=null,t=function(){if(null!==p)try{var e=exports.unstable_now();p(!0,e),p=null}catch(e){throw setTimeout(t,0),e}},u=Date.now();exports.unstable_now=function(){return Date.now()-u},f=function(e){null!==p?setTimeout(f,0,e):(p=e,setTimeout(t,0))},g=function(e,t){q=setTimeout(e,t)},h=function(){clearTimeout(q)},k=function(){return!1},l=exports.unstable_forceFrameRate=function(){}}else{var w=window.performance,x=window.Date,y=window.setTimeout,z=window.clearTimeout;if("undefined"!=typeof console){var A=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof A&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof w&&"function"==typeof w.now)exports.unstable_now=function(){return w.now()};else{var B=x.now();exports.unstable_now=function(){return x.now()-B}}var C=!1,D=null,E=-1,F=5,G=0;k=function(){return exports.unstable_now()>=G},l=function(){},exports.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):F=0<e?Math.floor(1e3/e):5};var H=new MessageChannel,I=H.port2;H.port1.onmessage=function(){if(null!==D){var e=exports.unstable_now();G=e+F;try{D(!0,e)?I.postMessage(null):(C=!1,D=null)}catch(e){throw I.postMessage(null),e}}else C=!1},f=function(e){D=e,C||(C=!0,I.postMessage(null))},g=function(e,t){E=y(function(){e(exports.unstable_now())},t)},h=function(){z(E),E=-1}}function J(e,t){var n=e.length;e.push(t);e:for(;;){var r=Math.floor((n-1)/2),o=e[r];if(!(void 0!==o&&0<K(o,t)))break e;e[r]=t,e[n]=o,n=r}}function L(e){return void 0===(e=e[0])?null:e}function M(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length;r<o;){var l=2*(r+1)-1,a=e[l],i=l+1,u=e[i];if(void 0!==a&&0>K(a,n))void 0!==u&&0>K(u,a)?(e[r]=u,e[i]=n,r=i):(e[r]=a,e[l]=n,r=l);else{if(!(void 0!==u&&0>K(u,n)))break e;e[r]=u,e[i]=n,r=i}}}return t}return null}function K(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var N=[],O=[],P=1,Q=null,R=3,S=!1,T=!1,U=!1;function V(e){for(var t=L(O);null!==t;){if(null===t.callback)M(O);else{if(!(t.startTime<=e))break;M(O),t.sortIndex=t.expirationTime,J(N,t)}t=L(O)}}function W(e){if(U=!1,V(e),!T)if(null!==L(N))T=!0,f(X);else{var t=L(O);null!==t&&g(W,t.startTime-e)}}function X(e,t){T=!1,U&&(U=!1,h()),S=!0;var n=R;try{for(V(t),Q=L(N);null!==Q&&(!(Q.expirationTime>t)||e&&!k());){var r=Q.callback;if(null!==r){Q.callback=null,R=Q.priorityLevel;var o=r(Q.expirationTime<=t);t=exports.unstable_now(),"function"==typeof o?Q.callback=o:Q===L(N)&&M(N),V(t)}else M(N);Q=L(N)}if(null!==Q)var l=!0;else{var a=L(O);null!==a&&g(W,a.startTime-t),l=!1}return l}finally{Q=null,R=n,S=!1}}function Y(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var Z=l;exports.unstable_ImmediatePriority=1,exports.unstable_UserBlockingPriority=2,exports.unstable_NormalPriority=3,exports.unstable_IdlePriority=5,exports.unstable_LowPriority=4,exports.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=R;R=e;try{return t()}finally{R=n}},exports.unstable_next=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var n=R;R=t;try{return e()}finally{R=n}},exports.unstable_scheduleCallback=function(e,t,n){var r=exports.unstable_now();if("object"==typeof n&&null!==n){var o=n.delay;o="number"==typeof o&&0<o?r+o:r,n="number"==typeof n.timeout?n.timeout:Y(e)}else n=Y(e),o=r;return e={id:P++,callback:t,priorityLevel:e,startTime:o,expirationTime:n=o+n,sortIndex:-1},o>r?(e.sortIndex=o,J(O,e),null===L(N)&&e===L(O)&&(U?h():U=!0,g(W,o-r))):(e.sortIndex=n,J(N,e),T||S||(T=!0,f(X))),e},exports.unstable_cancelCallback=function(e){e.callback=null},exports.unstable_wrapCallback=function(e){var t=R;return function(){var n=R;R=t;try{return e.apply(this,arguments)}finally{R=n}}},exports.unstable_getCurrentPriorityLevel=function(){return R},exports.unstable_shouldYield=function(){var e=exports.unstable_now();V(e);var t=L(N);return t!==Q&&null!==Q&&null!==t&&null!==t.callback&&t.startTime<=e&&t.expirationTime<Q.expirationTime||k()},exports.unstable_requestPaint=Z,exports.unstable_continueExecution=function(){T||S||(T=!0,f(X))},exports.unstable_pauseExecution=function(){},exports.unstable_getFirstCallbackNode=function(){return L(N)},exports.unstable_Profiling=null;

},{}],"/Users/rabbit/projects/buntimer2020-github/node_modules/scheduler/index.js":[function(require,module,exports){
"use strict";module.exports=require("./cjs/scheduler.production.min.js");

},{"./cjs/scheduler.production.min.js":"/Users/rabbit/projects/buntimer2020-github/node_modules/scheduler/cjs/scheduler.production.min.js"}],"/Users/rabbit/projects/buntimer2020-github/node_modules/tslib/tslib.js":[function(require,module,exports){
(function (global){
var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__spreadArrays,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault;!function(e){var t="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};function r(e,r){return e!==t&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(t,n){return e[t]=r?r(t,n):n}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(n){e(r(t,r(n)))}):"object"==typeof module&&"object"==typeof module.exports?e(r(t,r(module.exports))):e(r(t))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};__extends=function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)},__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},__decorate=function(e,t,r,n){var o,a=arguments.length,_=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(_=(a<3?o(_):a>3?o(t,r,_):o(t,r))||_);return a>3&&_&&Object.defineProperty(t,r,_),_},__param=function(e,t){return function(r,n){t(r,n,e)}},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function _(e){try{i(n.next(e))}catch(e){a(e)}}function c(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(_,c)}i((n=n.apply(e,t||[])).next())})},__generator=function(e,t){var r,n,o,a,_={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;_;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return _.label++,{value:a[1],done:!1};case 5:_.label++,n=a[1],a=[0];continue;case 7:a=_.ops.pop(),_.trys.pop();continue;default:if(!(o=(o=_.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){_=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){_.label=a[1];break}if(6===a[0]&&_.label<o[1]){_.label=o[1],o=a;break}if(o&&_.label<o[2]){_.label=o[2],_.ops.push(a);break}o[2]&&_.ops.pop(),_.trys.pop();continue}a=t.call(e,_)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},__exportStar=function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},__read=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),_=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)_.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return _},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],_=0,c=a.length;_<c;_++,o++)n[o]=a[_];return n},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},_("next"),_("throw"),_("return"),n[Symbol.asyncIterator]=function(){return this},n;function _(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||c(e,t)})})}function c(e,t){try{(r=o[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(i,u):f(a[0][2],r)}catch(e){f(a[0][3],e)}var r}function i(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}},__asyncDelegator=function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:__await(e[n](t)),done:"return"===n}:o?o(t):t}:o}},__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},e("__extends",__extends),e("__assign",__assign),e("__rest",__rest),e("__decorate",__decorate),e("__param",__param),e("__metadata",__metadata),e("__awaiter",__awaiter),e("__generator",__generator),e("__exportStar",__exportStar),e("__values",__values),e("__read",__read),e("__spread",__spread),e("__spreadArrays",__spreadArrays),e("__await",__await),e("__asyncGenerator",__asyncGenerator),e("__asyncDelegator",__asyncDelegator),e("__asyncValues",__asyncValues),e("__makeTemplateObject",__makeTemplateObject),e("__importStar",__importStar),e("__importDefault",__importDefault)});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],"/Users/rabbit/projects/buntimer2020-github/src/app.tsx":[function(require,module,exports){
"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});const React=__importStar(require("react")),ReactDOM=__importStar(require("react-dom")),config_1=require("./config"),utils_1=require("./utils"),timerStoreLocalhost_1=require("./timerStoreLocalhost"),timerStoreFirebase_1=require("./timerStoreFirebase"),testData_1=require("./testData"),timerView_1=require("./timerView");let sFlexboxColumn={width:"100vw",height:"100vh",maxWidth:1e3,marginLeft:"auto",marginRight:"auto",display:"flex",flexDirection:"column",alignItems:"stretch",padding:config_1.COLUMN_GUTTERS/2},sFlexboxItemSmall={flexGrow:0,flexShrink:0,margin:config_1.COLUMN_GUTTERS/2},sFlexboxItemLarge={position:"relative",flexGrow:1,flexShrink:0,margin:config_1.COLUMN_GUTTERS/2};class AppView extends React.Component{constructor(e){super(e),this.unsub=(()=>{}),this.state={showCompleted:!1}}_toggleShowCompleted(){this.setState({showCompleted:!this.state.showCompleted})}componentDidMount(){utils_1.log("AppView.componentDidMount(): subscribing to store"),this.unsub=this.props.store.onChange(()=>this.forceUpdate())}componentWillUnmount(){utils_1.log("AppView.componentWillUnmount(): unsubscribing from store"),this.unsub()}render(){utils_1.log("AppView.render()");let e=this.props.store,t=e.getTimers();return React.createElement("div",{style:sFlexboxColumn},this.state.showCompleted?React.createElement("div",{style:sFlexboxItemLarge},t.filter(e=>null!==e.completedTime).map(t=>React.createElement("div",{key:t.id,style:{color:config_1.cCARD_TEXT}},React.createElement("h3",null,t.title),React.createElement("p",{style:{color:config_1.cCARD_TEXT_FAINT}},"completed at ",utils_1.formatTime(t.completedTime||0),", ",utils_1.formatDuration((t.completedTime||0)-e.now)),React.createElement("a",{href:"",onClick:o=>{o.stopPropagation(),o.preventDefault(),e.delete(t.id)}},"delete"),React.createElement("hr",null)))):t.filter(e=>null===e.completedTime).map(t=>React.createElement("div",{key:t.id,style:sFlexboxItemLarge},React.createElement(timerView_1.TimerCard,{timer:t,now:e.now,store:e}))),React.createElement("div",{style:sFlexboxItemSmall},React.createElement(timerView_1.MainButtons,{store:e,onToggleShowCompleted:()=>this._toggleShowCompleted()})))}}let store=null,USER_ID=window.location.search?window.location.search.slice(1):"public",IS_TEST="test"===USER_ID,LOCALHOST_SERVE="8003"===window.location.port,LOCALHOST_FIREBASE="5000"===window.location.port,NETLIFY=-1!==window.location.host.indexOf("netlify.com"),FIREBASE=-1!==window.location.host.indexOf("web.app")||-1!==window.location.host.indexOf("firebaseapp.com");console.log("booting app.  hosting mode:",{USER_ID:USER_ID,IS_TEST:IS_TEST,LOCALHOST_FIREBASE:LOCALHOST_FIREBASE,LOCALHOST_SERVE:LOCALHOST_SERVE,NETLIFY:NETLIFY,FIREBASE:FIREBASE}),IS_TEST?(console.log("booting app in TEST mode"),store=testData_1.makeTestStore()):LOCALHOST_SERVE||NETLIFY?(console.log("booting app in LOCALSTORAGE mode"),store=new timerStoreLocalhost_1.TimerStoreLocalhost(3*config_1.SECOND,USER_ID)):LOCALHOST_FIREBASE||FIREBASE?(console.log("booting app in FIREBASE mode"),store=new timerStoreFirebase_1.TimerStoreFirebase(3*config_1.SECOND,USER_ID)):console.log("booting app in ???? mode"),store?ReactDOM.render(React.createElement(AppView,{store:store}),document.getElementById("react-slot")):console.error("Did not know what kind of store to create.");

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","./testData":"/Users/rabbit/projects/buntimer2020-github/src/testData.ts","./timerStoreFirebase":"/Users/rabbit/projects/buntimer2020-github/src/timerStoreFirebase.ts","./timerStoreLocalhost":"/Users/rabbit/projects/buntimer2020-github/src/timerStoreLocalhost.ts","./timerView":"/Users/rabbit/projects/buntimer2020-github/src/timerView.tsx","./utils":"/Users/rabbit/projects/buntimer2020-github/src/utils.ts","react":"/Users/rabbit/projects/buntimer2020-github/node_modules/react/index.js","react-dom":"/Users/rabbit/projects/buntimer2020-github/node_modules/react-dom/index.js"}],"/Users/rabbit/projects/buntimer2020-github/src/config.ts":[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FIREBASE_CONFIG={apiKey:"AIzaSyAgo3uaH6iE7rPION6mpw164hZw-QW__5A",authDomain:"buntimer2020.firebaseapp.com",databaseURL:"https://buntimer2020.firebaseio.com",projectId:"buntimer2020",storageBucket:"buntimer2020.appspot.com",messagingSenderId:"158404617479",appId:"1:158404617479:web:671fbf7656ba562fe251a2"},exports.SECOND=1e3,exports.MINUTE=60*exports.SECOND,exports.HOUR=60*exports.MINUTE,exports.DAY=24*exports.HOUR,exports.HEAVY_X="✖",exports.SNOOZE=10*exports.MINUTE,exports.FONT_SIZE=16,exports.LINE_HEIGHT=21,exports.EXTRA_FONT_SIZE_FOR_TITLE=4,exports.BUTTON_HEIGHT=exports.LINE_HEIGHT+20,exports.BUTTON_GUTTER=10,exports.CARD_PADDING=10,exports.COLUMN_GUTTERS=10,exports.RADIUS=10,exports.cCARD_BG="black",exports.cCARD_TEXT="white",exports.cCARD_TEXT_FAINT="rgba(255,255,255,0.6)",exports.cBUTTON_BG="#1D273C",exports.cBUTTON_TEXT="#A1C1DD",exports.PIECHART_DURATION=60*exports.MINUTE,exports.cDATAVIZ_BACKGROUND="black",exports.cELAPSED="rgba(0, 0, 0, 0.8)",exports.cGOOD="#224024",exports.cWARNING="#bb0",exports.cBAD="#e80202",exports.cBAD_ALT="#9c0020",exports.cSTALE="#a35",exports.cPIE_TEXT="rgba(255,255,255,0.2)",exports.cCOLOR_MAP=[[99999999*exports.MINUTE,{cFull:exports.cGOOD,cEmpty:exports.cELAPSED,cEmptyAlt:null,cTogglePeriod:null}],[15*exports.MINUTE,{cFull:exports.cWARNING,cEmpty:exports.cELAPSED,cEmptyAlt:null,cTogglePeriod:null}],[0*exports.MINUTE,{cFull:exports.cBAD,cEmpty:exports.cELAPSED,cEmptyAlt:null,cTogglePeriod:null}],[-1*exports.MINUTE,{cFull:exports.cBAD,cEmpty:exports.cBAD,cEmptyAlt:exports.cBAD_ALT,cTogglePeriod:60*exports.SECOND}],[-6*exports.HOUR,{cFull:exports.cSTALE,cEmpty:exports.cSTALE,cEmptyAlt:null,cTogglePeriod:null}]],exports.mapLookup=((e,t)=>{let o=e[0][1];for(let[p,r]of e)t<=p&&(o=r);return o});

},{}],"/Users/rabbit/projects/buntimer2020-github/src/testData.ts":[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const config_1=require("./config"),timerStoreLocalhost_1=require("./timerStoreLocalhost"),utils_1=require("./utils");exports.makeTestStore=(()=>{let e=Date.now(),t=new timerStoreLocalhost_1.TimerStoreLocalhost(null,"test");t._resetStorage(),t.now=e;let i=[-480,-21.2,-2.2,3.2,17.2,222.2],o=0;for(let r of i)t.push({id:utils_1.makeId(),title:`timer ${r}`,startTime:e+(2*o-4)*config_1.MINUTE,completedTime:null,endTime:e+r*config_1.MINUTE}),t.push({id:utils_1.makeId(),title:`timer ${r} ... done`,startTime:e+(2*o-4)*config_1.MINUTE,completedTime:e+utils_1.rand(-120,120)*config_1.MINUTE,endTime:e+r*config_1.MINUTE}),o+=1;return t});

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","./timerStoreLocalhost":"/Users/rabbit/projects/buntimer2020-github/src/timerStoreLocalhost.ts","./utils":"/Users/rabbit/projects/buntimer2020-github/src/utils.ts"}],"/Users/rabbit/projects/buntimer2020-github/src/timerStoreFirebase.ts":[function(require,module,exports){
"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});const firebase=__importStar(require("firebase/app"));require("firebase/auth"),require("firebase/firestore");const config_1=require("./config"),config_2=require("./config"),utils_1=require("./utils");let fbapp=firebase.initializeApp(config_1.FIREBASE_CONFIG),db=firebase.firestore(),FIREBASE_DOCUMENT_KEY="buntimer2020-v1";class TimerStoreFirebase{constructor(e,t){this.timers={},this.now=Date.now(),this.cbs=[],this.userId=t,this._load(),e&&setInterval(()=>{this.now=Date.now(),console.log("store timer update"),this._notify()},e),db.collection(this.userId).doc(FIREBASE_DOCUMENT_KEY).onSnapshot(e=>{console.log("incoming firebase data",e.metadata.hasPendingWrites?"(local)":"(server)"),e.exists?this.timers=e.data():this.timers={},this._notify()})}async _resetStorage(){utils_1.log("store._resetStorage()"),this.timers={},await db.collection(this.userId).doc(FIREBASE_DOCUMENT_KEY).delete(),utils_1.log("store._resetStorage() ... success")}async _save(){utils_1.log("store._save()"),await db.collection(this.userId).doc(FIREBASE_DOCUMENT_KEY).set(this.timers),utils_1.log("store._save() ... success")}async _load(){utils_1.log("store._load()");let e=await db.collection(this.userId).doc(FIREBASE_DOCUMENT_KEY).get();e.exists?(this.timers=e.data(),utils_1.log("store._load() ... success, loaded existing data")):(this.timers={},utils_1.log("store._load() ... success, does not exist yet")),this._notify(),utils_1.log("store._load() ... complete.  this.timers = ",this.timers)}onChange(e){utils_1.log("store.onChange subscription created"),this.cbs.push(e);return()=>{utils_1.log("store - unsub"),this.cbs=this.cbs.filter(t=>t!==e)}}_notify(){utils_1.log("store._notify() start");for(let e of this.cbs)e();utils_1.log("store._notify() end")}getTimers(){utils_1.log("store.getTimers()",this.timers);let e=Object.values(this.timers);return e.sort(utils_1.timerCmp),e}push(e){utils_1.log("store.push(t)"),this.timers[e.id]=e,this._save()}createTimer(e){utils_1.log("store.createTimer()");let t={id:utils_1.makeId(),title:e,startTime:this.now,endTime:this.now+90*config_2.MINUTE,completedTime:null};this.timers[t.id]=t,this._save()}complete(e,t){utils_1.log(`store.complete(${e}, ${t})`);let s=this.timers[e];void 0!==s&&(s.completedTime=t,this._save())}uncomplete(e){utils_1.log(`store.uncomplete(${e})`);let t=this.timers[e];void 0!==t&&(t.completedTime=null,this._save())}changeCompletedTime(e,t){utils_1.log(`store.changeCompletedTime(${e}, ${t})`);let s=this.timers[e];void 0!==s&&(s.completedTime=t,this._save())}delete(e){utils_1.log(`store.delete(${e})`),delete this.timers[e],this._save()}snooze(e){utils_1.log(`store.snooze(${e})`);let t=this.timers[e];void 0!==t&&(t.endTime+=config_2.SNOOZE,this._save())}changeTitle(e,t){utils_1.log(`store.changeTitle(${e}, ${t})`);let s=this.timers[e];void 0!==s&&(t=t.trim())&&(s.title=t,this._save())}changeStartTime(e,t){utils_1.log(`store.changeStartTime(${e}, ${t})`);let s=this.timers[e];void 0!==s&&(s.startTime=t,this._save())}changeEndTime(e,t){utils_1.log(`store.changeEndTime(${e}, ${t})`);let s=this.timers[e];void 0!==s&&(s.endTime=t,this._save())}}exports.TimerStoreFirebase=TimerStoreFirebase;

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","./utils":"/Users/rabbit/projects/buntimer2020-github/src/utils.ts","firebase/app":"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/app/dist/index.cjs.js","firebase/auth":"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/auth/dist/index.cjs.js","firebase/firestore":"/Users/rabbit/projects/buntimer2020-github/node_modules/firebase/firestore/dist/index.cjs.js"}],"/Users/rabbit/projects/buntimer2020-github/src/timerStoreLocalhost.ts":[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const config_1=require("./config"),utils_1=require("./utils");let LOCAL_STORAGE_KEY="buntimer2020-v1";class TimerStoreLocalhost{constructor(t,e){this.timers={},this.now=Date.now(),this.cbs=[],this.userId=e,this.localStorageKey=LOCAL_STORAGE_KEY+e,this._load(),t&&setInterval(()=>{this.now=Date.now(),this._notify()},t)}async _resetStorage(){utils_1.log("store._resetStorage()"),this.timers={},window.localStorage.removeItem(this.localStorageKey),this._notify()}async _save(){utils_1.log("store._save()"),window.localStorage.setItem(this.localStorageKey,JSON.stringify(this.timers))}async _load(){utils_1.log("store._load()"),this.timers=JSON.parse(window.localStorage.getItem(this.localStorageKey)||"{}");for(let t of Object.values(this.timers)){let e=t;void 0!==e.createdTime&&(t.startTime=e.createdTime,delete e.createdTime),void 0===t.startTime&&(t.startTime=this.now-60*config_1.MINUTE)}this._notify()}onChange(t){utils_1.log("store.onChange subscription created"),this.cbs.push(t);return()=>{this.cbs=this.cbs.filter(e=>e!==t)}}_notify(){utils_1.log("store._notify() start");for(let t of this.cbs)t();utils_1.log("store._notify() end")}getTimers(){let t=Object.values(this.timers);return t.sort(utils_1.timerCmp),t}push(t){utils_1.log("store.push(t)"),this.timers[t.id]=t,this._save(),this._notify()}createTimer(t){utils_1.log("store.createTimer()");let e={id:utils_1.makeId(),title:t,startTime:this.now,endTime:this.now+90*config_1.MINUTE,completedTime:null};this.timers[e.id]=e,this._save(),this._notify()}complete(t,e){utils_1.log(`store.complete(${t}, ${e})`);let i=this.timers[t];void 0!==i&&(i.completedTime=e,this._save(),this._notify())}uncomplete(t){utils_1.log(`store.uncomplete(${t})`);let e=this.timers[t];void 0!==e&&(e.completedTime=null,this._save(),this._notify())}changeCompletedTime(t,e){utils_1.log(`store.changeCompletedTime(${t}, ${e})`);let i=this.timers[t];void 0!==i&&(i.completedTime=e,this._save(),this._notify())}delete(t){utils_1.log(`store.delete(${t})`),delete this.timers[t],this._save(),this._notify()}snooze(t){utils_1.log(`store.snooze(${t})`);let e=this.timers[t];void 0!==e&&(e.endTime+=config_1.SNOOZE,this._save(),this._notify())}changeTitle(t,e){utils_1.log(`store.changeTitle(${t}, ${e})`);let i=this.timers[t];void 0!==i&&(e=e.trim())&&(i.title=e,this._save(),this._notify())}changeStartTime(t,e){utils_1.log(`store.changeStartTime(${t}, ${e})`);let i=this.timers[t];void 0!==i&&(i.startTime=e,this._save(),this._notify())}changeEndTime(t,e){utils_1.log(`store.changeEndTime(${t}, ${e})`);let i=this.timers[t];void 0!==i&&(i.endTime=e,this._save(),this._notify())}}exports.TimerStoreLocalhost=TimerStoreLocalhost;

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","./utils":"/Users/rabbit/projects/buntimer2020-github/src/utils.ts"}],"/Users/rabbit/projects/buntimer2020-github/src/timerView.tsx":[function(require,module,exports){
"use strict";var __importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0});const React=__importStar(require("react")),config_1=require("./config"),utils_1=require("./utils");let sTimerCard={position:"absolute",top:0,left:0,right:0,bottom:0,color:config_1.cCARD_TEXT,background:config_1.cCARD_BG,borderRadius:config_1.RADIUS,padding:10},sTitle={color:config_1.cCARD_TEXT,fontWeight:"bold",fontSize:config_1.FONT_SIZE+config_1.EXTRA_FONT_SIZE_FOR_TITLE,position:"absolute",top:config_1.CARD_PADDING,left:config_1.CARD_PADDING,minWidth:100},sDetailLeft={color:config_1.cCARD_TEXT_FAINT,position:"absolute",top:config_1.CARD_PADDING+config_1.LINE_HEIGHT+config_1.EXTRA_FONT_SIZE_FOR_TITLE,left:config_1.CARD_PADDING},sDetailRight={color:config_1.cCARD_TEXT_FAINT,position:"absolute",top:config_1.CARD_PADDING+config_1.LINE_HEIGHT+config_1.EXTRA_FONT_SIZE_FOR_TITLE,right:config_1.CARD_PADDING},sDeleteButton={color:config_1.cCARD_TEXT_FAINT,position:"absolute",top:config_1.CARD_PADDING,right:config_1.CARD_PADDING},sButtonBar={height:config_1.BUTTON_HEIGHT,textAlign:"center",display:"flex",margin:`0 ${-config_1.BUTTON_GUTTER/2}px`},sButtonBarInCard=Object.assign(Object.assign({},sButtonBar),{position:"absolute",left:config_1.CARD_PADDING,right:config_1.CARD_PADDING,bottom:config_1.CARD_PADDING}),sButton={border:"none",color:config_1.cBUTTON_TEXT,background:config_1.cBUTTON_BG,height:config_1.BUTTON_HEIGHT,paddingLeft:10,paddingRight:10,borderRadius:config_1.RADIUS},sButtonBarButton=Object.assign(Object.assign({},sButton),{flexGrow:1,flexShrink:1,flexBasis:1,margin:`0 ${config_1.BUTTON_GUTTER/2}px`}),sDatavizZone={position:"absolute",top:config_1.CARD_PADDING,bottom:config_1.CARD_PADDING,left:config_1.CARD_PADDING,right:config_1.CARD_PADDING,background:config_1.cDATAVIZ_BACKGROUND,borderRadius:config_1.RADIUS};exports.MainButtons=(({store:t,onToggleShowCompleted:e})=>React.createElement("div",{style:sButtonBar},React.createElement("button",{style:sButtonBarButton,onClick:()=>{t.createTimer("===")}},"+ new timer"),React.createElement("button",{style:sButtonBarButton,onClick:e},"show completed")));let sSvgTransition={transitionProperty:"fill, stroke",transitionDuration:"0.4s",transitionTimingFunction:"ease-out"};exports.PieChartSVG=(({pctFull:t,colorFull:e,colorEmpty:i,text:o,colorText:n})=>{let r=2*Math.PI*25,s=(1-t)*r,c=r;return React.createElement("svg",{viewBox:"-2 -2 104 104",preserveAspectRatio:"xMidYMid meet",height:"100%",width:"100%",style:{pointerEvents:"none",position:"absolute"}},React.createElement("circle",{r:"50",cx:"50",cy:"50",style:Object.assign(Object.assign({},sSvgTransition),{fill:e,stroke:e}),strokeWidth:2}),React.createElement("circle",{r:"25",cx:"50",cy:"50",style:Object.assign(Object.assign({},sSvgTransition),{fill:"transparent",stroke:i}),strokeWidth:"50",strokeDasharray:`${s} ${c}`,transform:"rotate(-90) translate(-100)"}),React.createElement("text",{x:"50",y:"50",fill:n,textAnchor:"middle",dominantBaseline:"middle",fontSize:"25"},o))});let sButtonOverlay={position:"absolute",left:config_1.CARD_PADDING,right:config_1.CARD_PADDING,bottom:config_1.CARD_PADDING,height:config_1.BUTTON_HEIGHT+2*config_1.CARD_PADDING,background:config_1.cCARD_BG};class TimerCard extends React.Component{constructor(t){super(t),this.state={showButtons:!1}}_changeTitle(){this.props.store.changeTitle(this.props.timer.id,prompt("Title:",this.props.timer.title)||"")}_changeStartTime(){let t=prompt("Start time:",utils_1.formatTime(this.props.timer.startTime))||"",e=utils_1.parseTime(t);e&&this.props.store.changeStartTime(this.props.timer.id,e)}_changeEndTime(){let t=prompt("End time:",utils_1.formatTime(this.props.timer.endTime))||"",e=utils_1.parseTime(t);e&&this.props.store.changeEndTime(this.props.timer.id,e)}_deleteTimer(){this.props.store.delete(this.props.timer.id)}_completeTimer(){this.props.store.complete(this.props.timer.id,this.props.now)}_snooze(){this.props.store.snooze(this.props.timer.id)}_toggleButtons(){utils_1.log("toggling buttons",this.state),this.setState({showButtons:!this.state.showButtons})}render(){let{timer:t,now:e,store:i}=this.props,o=t.endTime-e,n=utils_1.clamp(o/config_1.PIECHART_DURATION,0,1),{cFull:r,cEmpty:s,cEmptyAlt:c,cTogglePeriod:l}=config_1.mapLookup(config_1.cCOLOR_MAP,o),a=`${utils_1.roundTowardsZero(o/config_1.MINUTE)}m`;return null!==l&&null!==c&&Math.floor(e/l)%2==0&&(s=c),React.createElement("div",{style:sTimerCard},React.createElement("div",{style:sDatavizZone,onClick:()=>this._toggleButtons()},React.createElement(exports.PieChartSVG,{pctFull:n,colorFull:r,colorEmpty:s,text:a,colorText:config_1.cPIE_TEXT})),React.createElement("div",{style:sTitle,onClick:()=>this._changeTitle()},t.title||React.createElement("i",null,"(untitled timer)")),React.createElement("div",{style:sDetailLeft},React.createElement("div",{onClick:()=>this._changeStartTime()},"started:",React.createElement("br",null),utils_1.formatTime(t.startTime)),React.createElement("div",null,"(",utils_1.formatDuration(t.startTime-e),")")),React.createElement("div",{style:sDetailRight},React.createElement("div",{style:{textAlign:"right"},onClick:()=>this._changeEndTime()},"ends:",React.createElement("br",null),utils_1.formatTime(t.endTime)),React.createElement("div",null,"(",utils_1.formatDuration(t.endTime-e),")")),React.createElement("div",{style:sDeleteButton,onClick:()=>this._deleteTimer()},config_1.HEAVY_X),this.state.showButtons?React.createElement("div",{style:sButtonOverlay,onClick:()=>this._toggleButtons()},React.createElement("div",{style:sButtonBarInCard,onClick:t=>{t.stopPropagation()}},React.createElement("button",{style:sButtonBarButton,onClick:()=>this._completeTimer()},"did it"),React.createElement("button",{style:sButtonBarButton,onClick:()=>this._snooze()},"+ 10 minutes"))):null)}}exports.TimerCard=TimerCard;

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","./utils":"/Users/rabbit/projects/buntimer2020-github/src/utils.ts","react":"/Users/rabbit/projects/buntimer2020-github/node_modules/react/index.js"}],"/Users/rabbit/projects/buntimer2020-github/src/utils.ts":[function(require,module,exports){
"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const named_regexp_groups_1=__importDefault(require("named-regexp-groups")),config_1=require("./config");let _monotonicNow=Date.now();exports.monotonicNow=(()=>_monotonicNow=Math.max(_monotonicNow+1,Date.now())),exports.roundTowardsZero=(e=>e<0?-Math.floor(-e):Math.floor(e)),exports.log=((...e)=>console.log(...e)),exports.clamp=((e,o,t)=>Math.max(o,Math.min(t,e))),exports.remap=((e,o,t,r,a)=>{return(e-o)/(t-o)*(a-r)+r}),exports.rand=((e,o)=>exports.remap(Math.random(),0,1,e,o)),exports.randint=((e,o)=>Math.floor(exports.rand(e,o+.999999))),exports.makeId=(()=>`timer-${exports.monotonicNow()}-${exports.randint(1e8,999999999)}`),exports.posMod=((e,o)=>(e%o+o)%o),exports.formatTime=(e=>{let o=new Date(e),t=o.getHours(),r=t<12?"am":"pm";return 0==(t%=12)&&(t=12),`${t}:${(""+o.getMinutes()).padStart(2,"0")}${r}`}),exports.formatDuration=(e=>{if(Math.abs(e)<1*config_1.MINUTE)return"now";let o=Math.floor(Math.abs(e)/config_1.MINUTE),t=Math.floor(o/60),r=`${o%=60}m`;return t&&(r=`${t}h ${o}m`),e>0?`in ${r}`:`${r} ago`}),exports.parseTime=(e=>{let o=new named_regexp_groups_1.default(/^(:<hr>\d?\d)(:(:<min>\d\d))?\ ?((:<ampm>[ap]?)(m|[.]m[.])?)?$/i);e=e.trim().toLowerCase();let t=o.exec(e);if(!t)return exports.log(e.padEnd(10," "),null),null;let r=t.groups,a=parseInt(r.hr,10),n=parseInt(r.min||"0",10),m=r.ampm;"a"===m?12===a&&(a=0):m&&"p"===m&&(12===a&&(a=0),a+=12);let l=new Date;return l.setHours(a),l.setMinutes(n),l.setSeconds(0),l.setMilliseconds(0),l.getTime()});let testParseTime=()=>{let e=[["0","12:00am"],["0:34","12:34a","12:34 a","12:34am","12:34 am","12:34a.m."],["1","1a","1 a","1am","1 am","1A","1 AM"],["5","5a","5:00 am"],["11","11a"," 11a "],["12","12:00pm"],["13","1p","1:00pm","1p.m.","1 p.m.","1P"],["23:59","11:59pm"],["not","a","time","zzz 12:34am zzz","1p.","1pm."]];console.log("testing parseTime");let o=0;for(let t of e){console.log("---------------------");let e=t.map(exports.parseTime);for(let r=0;r<e.length;r++)e[0]!==e[r]&&(console.warn("ERROR: these should be equal but they are not:"),console.warn(t[0],"=>",e[0],new Date(e[0]||0).toLocaleTimeString()),console.warn(t[r],"=>",e[r],new Date(e[r]||0).toLocaleTimeString()),o+=1)}console.log(o,"failed")};exports.timerCmp=((e,o)=>null===e.completedTime!=(null===o.completedTime)?null===e.completedTime?-1:1:null!==e.completedTime&&null!==o.completedTime?e.completedTime-o.completedTime:e.endTime-o.endTime);

},{"./config":"/Users/rabbit/projects/buntimer2020-github/src/config.ts","named-regexp-groups":"/Users/rabbit/projects/buntimer2020-github/node_modules/named-regexp-groups/dist/index.js"}]},{},["/Users/rabbit/projects/buntimer2020-github/src/app.tsx"]);
